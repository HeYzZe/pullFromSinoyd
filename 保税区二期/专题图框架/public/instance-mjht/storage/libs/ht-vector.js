!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e.ht=e.ht||{},e.ht.vector=t())}(this,function(){"use strict";var Q={HOVER:"ht.hover",ACTIVE:"ht.active",PRESSED:"ht.pressed",DISABLED:"ht.disabled",FOCUS:"ht.focus",FONT_SIZE:"ht.fontSize",FONT_FAMILY:"ht.fontFamily",FONT:"ht.font",VALUE:"ht.value",PLACEHOLDER:"ht.placeholder",TEXT_COLOR:"ht.textColor",PADDING:"ht.padding",EDITING:"ht.editing",TEXT_ALIGN:"ht.textAlign",LINE_HEIGHT:"ht.lineHeight",WORD_BREAK:"ht.wordBreak",CHECKED:"ht.checked",LABEL:"ht.label",ICON:"ht.icon",FORM_ITEM_NAME:"ht.name",FORM_ITEM_GROUP:"ht.group",ON_CLICK:"ht.onClick",ON_CHANGE:"ht.onChange",ON_KEYDOWN:"ht.onKeyDown",ON_KEYUP:"ht.onKeyUp",DROP_DOWN:"ht.dropDown",FORMAT:"ht.format",SHOW_TIME:"ht.showTime",DATA_SOURCE:"ht.dataSource",DROP_ICON_WIDTH:"ht.dropIconWidth",DROP_ICON_HEIGHT:"ht.dropIconHeight",DROP_ROW_HEIGHT:"ht.dropRowHeight",DROP_WIDTH:"ht.dropWidth",DROP_BACKGROUND:"ht.dropBackground",DROP_HOVER_BACKGROUND:"ht.dropHoverBackground",DROP_LABEL_FONT:"ht.dropLabelFont",DROP_LABEL_COLOR:"ht.dropLabelColor",DROP_ACTIVE_LABEL_COLOR:"ht.dropActiveLabelColor",DROP_ACTIVE_BACKGOUND:"ht.dropActiveBackground",DROP_MAX_HEIGHT:"ht.dropMaxHeight",INPUT_TYPE:"ht.inputType",MAX_LENGTH:"ht.maxLength"},M="bottom",r="multiple",i="single",D="radio",w="checkbox",l=(function(){function h(e){this.value=e}function e(n){var r,i;function l(e,t){try{var o=n[e](t),a=o.value;a instanceof h?Promise.resolve(a.value).then(function(e){l("next",e)},function(e){l("throw",e)}):u(o.done?"return":"normal",o.value)}catch(e){u("throw",e)}}function u(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}(r=r.next)?l(r.key,r.arg):i=null}this._invoke=function(a,n){return new Promise(function(e,t){var o={key:a,arg:n,resolve:e,reject:t,next:null};i?i=i.next=o:(r=i=o,l(a,n))})},"function"!=typeof n.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(e){return this._invoke("next",e)},e.prototype.throw=function(e){return this._invoke("throw",e)},e.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),o=function(){function a(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}}(),E=function e(t,o,a){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,o);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,o,a)}if("value"in n)return n.value;var i=n.get;return void 0!==i?i.call(a):void 0},u=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},ee=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var o=[],a=!0,n=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){n=!0,r=e}finally{try{!a&&l.return&&l.return()}finally{if(n)throw r}}return o}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},e=ht.Default,G=e.drawText,F=e.drawStretchImage,U=e.getImage,j=[2,8],te={placeholderColor:"#737373",fontSize:12,fontFamily:"arial,  sans-serif",emptyColor:"#ffffff",hoverDarker:5,activeDarker:11},t=ht.Default,Z=t.drawText,$=t.drawStretchImage,q=t.getImage,K=ht.Default.drawText,s=/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/,d=/^[rR][gG][Bb][\(]((2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){2}((2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?))\)$/,c=/^[rR][gG][Bb][Aa][\(]((2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){3}(0\.\d{1,22}|1|0)?[\)]{1}$/,a=function(){function n(e,t,o,a){l(this,n),this.r=null,this.g=null,this.b=null,this.a=null,e&&this.setColor(e,t,o,a)}return o(n,[{key:"setColor",value:function(e,t,o,a){if(e&&!t)if(e=e.replace(/\s+/g,""),s.test(e))4===e.length?(this.r=parseInt(e[1]+e[1],16),this.g=parseInt(e[2]+e[3],16),this.b=parseInt(e[3]+e[3],16)):7===e.length&&(this.r=parseInt(e.substring(1,3),16),this.g=parseInt(e.substring(3,5),16),this.b=parseInt(e.substring(5,7),16));else if(d.test(e)){var n=(e=e.replace(/[rRgGbB\(\)\s]*/g,"")).split(",");this.r=parseInt(n[0]),this.g=parseInt(n[1]),this.b=parseInt(n[2])}else if(c.test(e)){var r=(e=e.replace(/[rRgGbBaA\(\)\s]*/g,"")).split(",");this.r=parseInt(r[0]),this.g=parseInt(r[1]),this.b=parseInt(r[2]),this.a=parseFloat(r[3])}}},{key:"toString",value:function(){return 1!==this.a&&null!==this.a?this.getRGBA():this.getWebColor()}},{key:"getRGB",value:function(){var e=this.r,t=this.g,o=this.b;return null!==e&&null!==t&&null!==o?"rgb("+e+", "+t+", "+o+")":null}},{key:"getRGBA",value:function(){var e=this.r,t=this.g,o=this.b,a=this.a;return null!==e&&null!==t&&null!==o?"rgba("+e+", "+t+", "+o+", "+(null===a?1:a.toFixed(2))+")":null}},{key:"getWebColor",value:function(){var e=this.r,t=this.g,o=this.b;return null!==e&&null!==t&&null!==o?"#"+e.toString(16)+t.toString(16)+o.toString(16):null}}]),n}(),n=ht.Default,z=n.drawText,Y=n.drawStretchImage,X=n.getImage,J="#ffffff",oe="#cccccc",ae=new a,g=ht.Default,ne=g.drawText,re=g.drawStretchImage,ie=g.getImage,le=function(e,t){return e<=1?t*e:e},ue=void 0,he=void 0,se=void 0,de=void 0,ce=function(e,t){return t?e/ue*he+se:de-e/ue*he},f=function(){function e(){l(this,e)}return o(e,[{key:"onDown",value:function(e,t,o,a,n,r){}},{key:"onUp",value:function(e,t,o,a,n,r){}},{key:"onMove",value:function(e,t,o,a,n,r){}},{key:"onEnter",value:function(e,t,o,a,n,r){}},{key:"onHover",value:function(e,t,o,a,n,r){}},{key:"onLeave",value:function(e,t,o,a,n,r){}},{key:"onBeginDrag",value:function(e,t,o,a,n,r){}},{key:"onDrag",value:function(e,t,o,a,n,r){}},{key:"onEndDrag",value:function(e,t,o,a,n,r){}}]),e}(),p=function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,f),o(t,[{key:"onEnter",value:function(e,t,o,a,n,r){t.a(Q.DISABLED)?o.getView().style.cursor="not-allowed":o.getView().style.cursor="text"}},{key:"onLeave",value:function(e,t,o,a,n,r){o.getView().style.cursor="default"}},{key:"onDown",value:function(e,t,o,a,n,r){if(!t.a(Q.DISABLED)){var i=t.getAnchorRect(),l=He(t.a(Q.FONT)),u=be(i,"textarea"),h=t.a(Q.TEXT_COLOR),s=u.style,d=t.a(Q.VALUE),c=t.a(Q.PLACEHOLDER),g=t.a(Q.LINE_HEIGHT),f=t.a(Q.TEXT_ALIGN),p=t.a(Q.WORD_BREAK),v=t.a(Q.MAX_LENGTH),y=t.a(Q.ON_KEYDOWN),D=t.a(Q.ON_KEYUP),_=t.a(Q.ON_CHANGE),b=De(t.a(Q.PADDING)),w=ee(b,4),m=w[0],V=w[1],k=w[2],C=w[3];s.color=h,s.fontFamily=l.fontFamily,s.fontSize=l.fontSize,s.paddingTop=m+"px",s.paddingRight=V+"px",s.paddingBottom=k+"px",s.paddingLeft=2+C+"px",s.textAlign=f,s.resize="none",s.overflow="hidden",s.lineHeight=g+"px",s.wordBreak=p?"break-all":"keep-word",l.fontWeight&&(s.fontWeight=l.fontWeight),we(t,o,u),u.value=d||"",u.placeholder=c||"",v&&u.setAttribute("maxlength",v),document.body.appendChild(u),t.a(Q.EDITING,!0);var E=function(e){we(t,o,u)};setTimeout(function(){u.focus(),o.mp(E),y&&u.addEventListener("keydown",function(e){y(e,t)}),(D||_)&&u.addEventListener("keyup",function(e){D&&y(e,t),_&&D(u.value,t)}),u.addEventListener("blur",function(e){e.preventDefault(),t.a(Q.VALUE,u.value),document.body.removeChild(u),t.a(Q.EDITING,!1),o.ump(E)})},1)}}},{key:"onDrag",value:function(e,t,o,a,n,r){t.a(Q.EDITING)&&me()}}]),t}(),v=function(e){function C(){return l(this,C),h(this,(C.__proto__||Object.getPrototypeOf(C)).call(this))}return u(C,f),o(C,[{key:"onEnter",value:function(e,t,o,a,n,r){t.a(Q.DISABLED)?o.getView().style.cursor="not-allowed":o.getView().style.cursor="text"}},{key:"onLeave",value:function(e,t,o,a,n,r){o.getView().style.cursor="default"}},{key:"onDown",value:function(e,t,o,a,n,r){if(E(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"onDown",this).call(this),!t.a(Q.DISABLED)){var i=t.getAnchorRect(),l=He(t.a(Q.FONT)),u=be(i),h=t.a(Q.TEXT_COLOR)||te.textColor,s=u.style,d=t.a(Q.VALUE),c=t.a(Q.PLACEHOLDER),g=t.a(Q.TEXT_ALIGN),f=t.a(Q.MAX_LENGTH),p=t.a(Q.ON_KEYDOWN),v=t.a(Q.ON_KEYUP),y=t.a(Q.ON_CHANGE),D=De(t.a(Q.PADDING)),_=ee(D,4),b=_[0],w=_[1],m=_[2],V=_[3];s.color=h,s.fontFamily=l.fontFamily,s.fontSize=l.fontSize,s.paddingTop=b+"px",s.paddingRight=w+"px",s.paddingBottom=m+"px",s.paddingLeft=2+V+"px",s.lineHeight=i.height+"px",s.textAlign=g,l.fontWeight&&(s.fontWeight=l.fontWeight),we(t,o,u),u.value=d||"",u.placeholder=c||"",f&&u.setAttribute("maxlength",f),document.body.appendChild(u),t.a(Q.EDITING,!0);var k=function(e){we(t,o,u)};setTimeout(function(){u.focus(),o.mp(k),p&&u.addEventListener("keydown",function(e){p(e,t)}),(v||y)&&u.addEventListener("keyup",function(e){v&&v(e,t),y&&y(u.value,t)}),u.addEventListener("blur",function(e){e.preventDefault(),t.a(Q.VALUE,u.value),document.body.removeChild(u),t.a(Q.EDITING,!1),o.ump(k)})},1)}}},{key:"onDrag",value:function(e,t,o,a,n,r){t.a(Q.EDITING)&&me()}}]),C}(),y=function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,f),o(t,[{key:"onDown",value:function(e,t,o,a,n,r){t.a(Q.DISABLED)||t.a(Q.PRESSED,!0)}},{key:"onEnter",value:function(e,t,o,a,n,r){o&&(t.a(Q.DISABLED)?o.getView().style.cursor="not-allowed":o.getView().style.cursor="pointer"),t.a(Q.DISABLED)||t.a(Q.HOVER,!0)}},{key:"onLeave",value:function(e,t,o,a,n,r){o&&(o.getView().style.cursor="default"),t.a(Q.HOVER,!1)}}]),t}(),_=function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,y),o(t,[{key:"onUp",value:function(e,t,o,a,n,r){t.a(Q.DISABLED)||(t.a(Q.PRESSED,!1),t.a(Q.ON_CLICK)&&0<a.x&&a.x<n&&0<a.y&&a.y<r&&t.a(Q.ON_CLICK)(e,t,o))}}]),t}(),b=function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,y),o(t,[{key:"onUp",value:function(e,t,o,a,n,r){if(!t.a(Q.DISABLED)){t.a(Q.PRESSED,!1);var i=Q.CHECKED,l=Q.FORM_ITEM_GROUP,u=Q.ON_CHANGE,h=Q.VALUE;if(!t.a(i)&&0<a.x&&a.x<n&&0<a.y&&a.y<r){var s=t.a(i);if(o&&o.dm()&&!s&&t.a(l)){var d=t.a(l);o.dm().each(function(e){d===e.a(l)&&e.a(i,!1)})}t.a(i,!0),t.a(u)&&t.a(u)(void 0===t.a(h)||t.a(h),t,o)}}}}]),t}(),m=function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,y),o(t,[{key:"onUp",value:function(e,t,o,a,n,r){if(!t.a(Q.DISABLED)){t.a(Q.PRESSED,!1);var i=Q.CHECKED,l=Q.FORM_ITEM_GROUP,u=Q.ON_CHANGE,h=Q.VALUE;if(0<a.x&&a.x<n&&0<a.y&&a.y<r){var s=t.a(i);if(t.a(i,!s),t.a(u)){var d=t.a(l);if(d){var c=[];o.dm().each(function(e){d===e.a(l)&&e.a(i)&&c.push(e.a(h))}),t.a(u)(c)}else t.a(u)(!s,t,o)}}}}}]),t}(),V=function(){function a(t,e,o){l(this,a),this.data=t,this.graph=e,this.valueType=o,this._documentClickHandler=this.documentClickHandler.bind(this),ht.Default.addMethod(t,{isInstant:function(){return this.s("instant")},setInstant:function(e){t.s("instant",e)}})}return o(a,[{key:"init",value:function(){var e=this.data,t=this.graph,o=t.getZoom(),a=t.tx(),n=t.ty(),r=this.value,i=new this.dropDownClazz,l=i._dropDownView=i.initDropDownView(e,this.getDatas(),r);i.getDropDownView=function(){return l},l.on("d:click",function(e){e.stopPropagation()}),l.on("d:mousedown",function(e){e.stopPropagation()}),l.on("d:mouseup",function(e){e.stopPropagation()}),this._dropDown=i,this._dropDownView=l,this.onInit(i,l);var u=e.getWidth()*o,h=e.getHeight()*o;this.prepareLayoutDropDown(i,l,{left:e.getX()*o+a-u*e.getAnchor().x,top:e.getY()*o+n-h*e.getAnchor().y,width:u,height:h}),ht.Default.appendToScreen(l.getView()),i.addValueChangeListener(this.handleDropDownValueChange,this),i.addDropDownListener(this.handleDropDownChange,this),this.registerCloseEvent(this._documentClickHandler),i.afterOpen(r),l.iv(!0)}},{key:"onInit",value:function(e,t){}},{key:"getDatas",value:function(){return null}},{key:"prepareLayoutDropDown",value:function(e,t,o){var a=e.getWidth(),n=e.getHeight(),r=ht.Default.getWindowInfo(),i=o.left+r.left,l=o.top+o.height+r.top;i+a>r.left+r.width&&(i=r.left+r.width-a),l+n>r.top+r.height&&(l-=o.height+n)<r.top&&(l=r.top),t.setX(Math.max(0,i)),t.setY(l),t.setWidth(a),t.setHeight(n)}},{key:"registerCloseEvent",value:function(e){ht.Default.isTouchable?document.addEventListener("touchstart",e):document.addEventListener("mousedown",e)}},{key:"unregisterCloseEvent",value:function(e){ht.Default.isTouchable?document.removeEventListener("touchstart",e):document.removeEventListener("mousedown",e)}},{key:"_clearDropDown",value:function(){this._dropDown=this._dropDownView=null,this.data.a(Q.EDITING,!1)}},{key:"documentClickHandler",value:function(e){var t=this.data,o=this.graph;if(ht.Default.isLeftButton(e)){var a=this._dropDown;if(this._dropDownView){var n=t.getWidth(),r=t.getHeight(),i=o.tx(),l=o.ty(),u=o.getZoom(),h={x:t.getX()*u+i-n*t.getAnchor().x,y:t.getY()*u+l-r*t.getAnchor().y,width:n,height:r};ht.Default.containsPoint(h,ht.Default.getClientPoint(e))||a.isClickOnDropDownView(e)||this.close()}}}},{key:"close",value:function(){this._dropDown&&(this._dropDown.cancel(),this.data.a(Q.EDITING,!1),delete this._dropDown,delete this._dropDownView)}},{key:"handleDropDownValueChange",value:function(e){this.value=e.value}},{key:"open",value:function(){this.isOpened()||(this.init(),this.data.a(Q.EDITING,!0))}},{key:"isOpened",value:function(){return!!this._dropDown}},{key:"handleDropDownChange",value:function(e){this.data;var t=this,o=t._dropDown,a=t._dropDownView;if(o){if(o.beforeClose(),"stop"===e.kind){var n=o.getDropDownValue();void 0!==n&&(this.value=n)}t._clearDropDown(),ht.Default.removeHTML(a.getView()),o.removeValueChangeListener(t.handleDropDownValueChange,t),this.unregisterCloseEvent(this._documentClickHandler),o.afterClose()}}},{key:"value",get:function(){var e=this.data,t=this.valueType.split("@"),o=ee(t,2),a=o[0],n=o[1];if("a"===a)return e.a(n);if("s"===a)return e.s(n);if("p"===a){var r=ht.Default.getter(n);if(e[r])return e[r]()}return null},set:function(e){var t=this.data,o=this.valueType,a=this.graph,n=o.split("@"),r=ee(n,2),i=r[0],l=r[1],u=t.a(Q.ON_CHANGE),h=this.value;if("a"===i)t.a(l,e);else if("s"===i)t.s(l,e);else if("p"===i){var s=ht.Default.setter(l);t[s]&&t[s](e)}u&&u(h,e,t,a)}}]),a}(),k=function(e){function n(e,t,o){l(this,n);var a=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t,o));return a.dropDownClazz=ht.ui.ColorDropDown,a}return u(n,V),n}(),C=function(e,t,o){var a=e.a(Q.DROP_DOWN);a||(a=new k(e,t,o),e.a(Q.DROP_DOWN,a)),a.open()},O=function(e){function n(e,t,o){l(this,n);var a=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t,o));return a.dropDownClazz=ht.ui.DateTimeDropDown,a}return u(n,V),o(n,[{key:"onInit",value:function(e,t){var o=this.data.a(Q.SHOW_TIME);t.getChildren().get(0).setType(o?"datetime":"date")}}]),n}(),I=function(e,t,o){var a=e.a(Q.DROP_DOWN);a||(e.getFormat=function(){return e.a(Q.FORMAT)},a=new O(e,t,o),e.a(Q.DROP_DOWN,a)),a.open()},x=(function(e){function n(e,t,o){l(this,n);var a=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t,o));return a.dropDownClazz=ht.ui.ListDropDown,a}u(n,V),o(n,[{key:"getDatas",value:function(){return[{id:void 0,label:""},{id:"0",label:"Female"},{id:"1",label:"Male"}]}}])}(),function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,y),o(t,[{key:"onUp",value:function(e,t,o,a,n,r){t.a(Q.DISABLED)||(t.a(Q.PRESSED,!1),0<a.x&&a.x<n&&0<a.y&&a.y<r&&C(t,o,"a@ht.value"))}}]),t}()),P=function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,y),o(t,[{key:"onUp",value:function(e,t,o,a,n,r){t.a(Q.DISABLED)||(t.a(Q.PRESSED,!1),0<a.x&&a.x<n&&0<a.y&&a.y<r&&I(t,o,"a@ht.value"))}}]),t}(),T=function(e){function t(e){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u(t,e),o(t,[{key:"handle_mousedown",value:function(e){this.handle_touchstart(e)}},{key:"handle_touchstart",value:function(e){e.stopPropagation();var t=this.gv,o=t.getDataAt(e);o&&t.sm().ss(o)}},{key:"handle_mousemove",value:function(e){e.stopPropagation();var t=this.gv,o=t._hoverData,a=t.getDataAt(e);a!==o&&(t._hoverData=a&&t.sm().contains(a)?null:a,t.redraw())}},{key:"handle_mouseleave",value:function(e){e.stopPropagation();var t=this.gv;t._hoverData&&(t._hoverData=null,t.redraw())}},{key:"handle_mouseup",value:function(e){this.handle_touchend(e)}},{key:"handle_touchend",value:function(e){e.stopPropagation()}}]),t}(ht.graph.Interactor),R={dark:{name:"dark"},light:{hoverDarker:5,activeDarker:11,baseColor:"#3399ff",baseColor2:"#737373",hoverBackground:"#eeeeee",emptyColor:"#ffffff",fontSize:12,fontFamily:"arial, sans-serif",font:"12px arial sans-serif",disabledColor:"#ebebeb",disabledBackground:"#fafafa",inputTextColor:"#111111",placeholderColor:"#737373"}},L=R.light,A={map:R,use:function(e){R.hasOwnProperty(e)&&(L=R[e])},add:function(e,t,o){o&&!R.hasOwnProperty(e)||(o="light");var a=this.copy(o);for(var n in t)a.hasOwnProperty(n)&&(a[n]=t[n]);L=R[e]=a},copy:function(e){if(R.hasOwnProperty(e))return ht.Default.clone(R[e])}},S=function(e){function a(e){l(this,a);var t=h(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));t.setInteractors([new ht.graph.ScrollBarInteractor(t),new T(t),new ht.graph.DefaultInteractor(t),new ht.graph.TouchInteractor(t,{editable:!1})]),t.addBottomPainter(t.drawBottomPainter.bind(t)),t._nodes=[];var o=t.getView().style;return o.transition="all 0.2s",o.transitionOrigin="0 0",t}return u(a,e),o(a,[{key:"adjustTranslateX",value:function(){return 0}},{key:"isMovable",value:function(){return!1}},{key:"adjustZoom",value:function(){return 1}},{key:"adjustTranslateY",value:function(e){this.getContentRect();var t=this.getHeight()-this.dm().size()*this._rowHeight;return 0<=e||0<=t?0:t<e?e:t}},{key:"handleScroll",value:function(e){var t=ve?-e.detail:e.wheelDelta/40;(ve||e.wheelDelta!==e.wheelDeltaX)&&this.translate(0,t)}},{key:"onPropertyChanged",value:function(e){E(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"onPropertyChanged",this).call(this,e);var t=e.property;"dataModel"!==t&&"fileSize"!==t||this.doLayoutLater()}},{key:"doLayoutLater",value:function(){this._doLayoutLater||(this._doLayoutLater=!0,ht.Default.callLater(this.doLayout,this))}},{key:"onValidated",value:function(){this._lastWidth!==this.getWidth()&&this.doLayoutLater()}},{key:"isVisible",value:function(e){return!0}},{key:"doLayout",value:function(){var t=this;this._doLayoutLater=!1;this._lastWidth=this.getWidth();var o=this._iconHeight,a=this._iconWidth,n=this._rowHeight,r=this._nodes=[];this.dm().getDatas().each(function(e){t.isVisible(e)&&r.push(e)}),this._lastHeight=this.getHeight();var i=8+.5*a,l=.5*n;r.forEach(function(e,t){e.setSize(a,o),e.p(i,l),l+=n})}},{key:"drawBottomPainter",value:function(t){var o=this,a=this._rowHeight,n=this.getWidth(),r=this._hoverData;this.dm().toDatas(this.isVisible,this).each(function(e){o.isSelected(e)?(t.beginPath(),t.rect(0,e.p().y-a/2,n,a),t.fillStyle=o.getActiveColor()||L.baseColor,t.fill()):e===r&&(t.beginPath(),t.rect(0,e.p().y-a/2,n,a),t.fillStyle=o.getHoverBackground()||L.hoverBackground,t.fill())})}},{key:"getDataAt",value:function(e){var t=Math.floor(this.lp(e).y/this._rowHeight);return this._nodes[t]}},{key:"handleSelectionChange",value:function(e){E(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"handleSelectionChange",this).call(this,e),this.redraw()}},{key:"getSelectWidth",value:function(){return 0}}]),a}(ht.graph.GraphView);Ie(S,{ms_ac:["rowHeight","iconWidth","iconHeight","activeColor","hoverBackground"],_rowHeight:26,_iconWidth:20,_iconHeight:20});var H=function(e){function n(e,t){l(this,n);var o=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));o.setSelectionMode(i),o._master=e,o._masterGraph=t,o._transition=!1,o._documentClickHandler=o.documentClickHandler.bind(o),o._previousValue=null,o.dm().setAutoAdjustIndex(!1);var a=o.getView().style;return a.height=0,a.boxShadow="rgba(0, 0, 0, 0.3) 0px 8px 22px",Ve(a,"transition","all 0.3s esse-in"),o.getView().addEventListener("click",function(e){o.handleSelectData(e)}),o.sm().ms(function(e){o.dm().each(function(e){e instanceof ht.Text&&e.s("text.color",o.getLabelColor(e))})}),o.mp(function(e){"background"===e.property&&(a.background=e.newValue)}),o._initStyleByMaster(),o}return u(n,S),o(n,[{key:"_initStyleByMaster",value:function(){var e=this._master;this.setIconHeight(e.a(Q.DROP_ICON_WIDTH)),this.setIconWidth(e.a(Q.DROP_ICON_HEIGHT)),this.setRowHeight(e.a(Q.DROP_ROW_HEIGHT)),this.setDropWidth(e.a(Q.DROP_WIDTH)),this.setBackground(e.a(Q.DROP_BACKGROUND)),this.setHoverBackground(e.a(Q.DROP_HOVER_BACKGROUND)),this.setActiveColor(e.a(Q.DROP_ACTIVE_BACKGOUND)),this.setDropLabelColor(e.a(Q.DROP_LABEL_COLOR)),this.setDropActiveLabelColor(e.a(Q.DROP_ACTIVE_LABEL_COLOR)),this.setMaxHeight(e.a(Q.DROP_MAX_HEIGHT))}},{key:"handleSelectData",value:function(e){var t=this._master,o=t.a(Q.ON_CHANGE);t.a(Q.VALUE,this.getValue()),t.a(Q.LABEL,this.__getLabel()),t.a(Q.ICON,this.sm().ld().a("icon")),o&&o(this._previousValue,this.getValue(),t,this._masterGraph),this.close()}},{key:"setSelectionMode",value:function(e){r!==e&&i!==e||this.sm().setSelectionMode(e)}},{key:"getNodeValue",value:function(e){return e.a("value")||e.s("label")||e.s("text")}},{key:"getNodeLabel",value:function(e){return e.s("label")||e.s("text")||e.a("value")}},{key:"setData",value:function(e){var o=this,a=this.dm();e&&e.length&&(e.forEach(function(e){var t;e.icon?((t=new ht.Node).setImage(e.icon),t.s({"image.stretch":"uniform",label:e.label,"label.position":20,"label.offset.x":4})):(t=new ht.Text).s({text:e.label,"text.color":o.getLabelColor(t)}),t.a(e),a.add(t)}),this.setDropHeight(Math.min(this.getMaxHeight(),e.length*this.getRowHeight())))}},{key:"getValue",value:function(){var t=this,e=this.sm(),o=e.getSelection(),a=e.getSelectionMode();if(i===a)return 0===o.size()?null:this.getNodeValue(o.get(0));if(r===a){var n=[];return o.each(function(e){n.push(t.getNodeValue(e))}),n}return null}},{key:"__getLabel",value:function(){var t=this,e=this.sm(),o=e.getSelection(),a=e.getSelectionMode();if(i===a)return 0===o.size()?null:this.getNodeLabel(o.get(0));if(r===a){var n=[];return o.each(function(e){n.push(t.getNodeLabel(e))}),n}return null}},{key:"toggle",value:function(){this._transition||(this._opened?this.close():this.open())}},{key:"__scrollToIndex",value:function(e){this.dm().getDatas(),this.sm();var t=this.getMaxHeight(),o=this.getRowHeight();t<e*o?this.ty(t-(e+1)*o):this.ty(0)}},{key:"open",value:function(){var o=this,e=this._master,t=(this._masterGraph,this.getView().style),a=this.getDropWidth(),n=this.getDropHeight(),r=e.a(Q.VALUE);this.sm().cs(),r?"string"==typeof r?this.dm().each(function(e,t){e.a("value")===r&&(o.sm().ss(e),o.__scrollToIndex(t))}):r.length&&r.forEach(function(t){o.dm().each(function(e){e.a("value")===t&&o.sm().as(e)})}):this.ty(0),this._previousValue=r,e.a(Q.EDITING,!0),this.layoutByMaster(),this.setWidth(a),this.setHeight(n),Ve(t,"transform","scaleY(0)"),document.body.appendChild(this.getView()),this._transition=!0,this.registerCloseEvent(this._documentClickHandler),ht.Default.callLater(function(){Ve(t,"transform","scaleY(1)"),setTimeout(function(){o.redraw(),o.setOpened(!0),o._transition=!1},300)})}},{key:"layoutByMaster",value:function(){var e=xe(this._master,this._masterGraph),t=ht.Default.getWindowInfo(),o=this.getView().style,a=this.getDropWidth(),n=this.getDropHeight(),r=Math.max(0,e.x),i=e.y+e.height,l="50% 0";i+n>t.height&&i-e.height>n&&(i=i-n-e.height,l="50% 100%"),r+a>t.width&&(r=t.width-a),o.left=r+"px",o.top=i+"px",Ve(o,"transformOrigin",l)}},{key:"onOpen",value:function(){}},{key:"close",value:function(){var e=this;if(!this._transition){var t=this.getView(),o=t.style;this._master.a(Q.EDITING,!1),this._transition=!0,this.unRegisterCloseEvent(this._documentClickHandler),Ve(o,"transform","scaleY(0)"),setTimeout(function(){document.body.removeChild(t),e._transition=!1,e.setOpened(!1)},301)}}},{key:"registerCloseEvent",value:function(e){ht.Default.isTouchable?document.addEventListener("touchstart",e):document.addEventListener("mousedown",e)}},{key:"unRegisterCloseEvent",value:function(e){ht.Default.isTouchable?document.removeEventListener("touchstart",e):document.removeEventListener("mousedown",e)}},{key:"documentClickHandler",value:function(e){var t=xe(this._master,this._masterGraph);ht.Default.containsPoint(t,ht.Default.getClientPoint(e))||this.close()}},{key:"getLabelColor",value:function(e){return this.sm().co(e)?this.getDropActiveLabelColor():this.getDropLabelColor()}}]),n}();Ie(H,{ms_ac:["background","dropWidth","dropHeight","maxHeight","opened","dropLabelFont","dropLabelColor","dropActiveLabelColor"],_background:L.emptyColor,_dropWidth:200,_dropHeight:100,_maxHeight:400,_opened:!1,_dropLabelColor:L.inputTextColor});var B=function(e){function t(){return l(this,t),h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u(t,y),o(t,[{key:"onUp",value:function(e,t,o,a,n,r){var i,l,u;t.a(Q.DISABLED)||(t.a(Q.PRESSED,!1),0<a.x&&a.x<n&&0<a.y&&a.y<r&&(l=o,(u=(i=t).__dropDown)||((u=window.ddp=new H(i,l)).setData(i.a(Q.DATA_SOURCE)),i.__dropDown=u),u.toggle()))}},{key:"onDrag",value:function(e,t,o,a,n,r){var i=t.__dropDown;i&&i._opened&&i.layoutByMaster()}}]),t}(),N=ht.Default.setImage;N("ht.vector.date",{width:16,height:16,comps:[{type:"roundRect",borderColor:"#ffffff",cornerRadius:1,rect:[1.5,6.54942,12.94,8]},{type:"shape",borderWidth:1,borderColor:"#ffffff",borderCap:"round",closePath:!0,points:[1.5,2.4523,14.44,2.4523,14.44,2.4523,14.44,2.4523,14.44,14.54942,14.44,14.54942,14.44,14.54942,1.5,14.54942,1.5,14.54942,1.5,14.54942,1.5,2.4523,1.5,2.4523,1.5,2.4523,1.5,2.4523],segments:[1,2,3,2,3,2,3,2,3,2]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[4.46,1,4.46,4]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[11.5,1,11.5,4]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[3.52013,9.50677,7.00013,9.50677,9.00013,9.50677,12.50756,9.50677],segments:[1,2,1,2]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[3.52,12.52535,12.50756,12.52535]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[3.52013,6.54942,7.00013,6.54942,9.00013,6.54942,12.50756,6.54942],segments:[1,2,1,2]}]}),N("ht.vector.dropDownIcon",{width:18,height:10,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",points:[1,1,9,9,17,1]}]});var W,ge,fe,pe={comp:{button:function(e,t,o,a,n){var r=o.getValue("text"),i=o.getValue("disabled"),l=o.getValue("font"),u=o.getValue("icon"),h=o.getValue("iconPosition"),s=o.getValue("iconWidth"),d=o.getValue("iconHeight"),c=o.getValue("textColor"),g=o.getValue("disabledTextColor"),f=o.getValue("borderWidth"),p=o.getValue("borderColor"),v=o.getValue("hoverBorderColor"),y=o.getValue("activeBorderColor"),D=o.getValue("disabledBorderColor"),_=o.getValue("background"),b=o.getValue("hoverBackground"),w=o.getValue("activeBackground"),m=o.getValue("disabledBackground"),V=o.getValue("borderRadius"),k=_e(j),C=(ee(k,4),De(V)),E=ee(C,4),O=E[0],I=E[1],x=E[2],P=E[3],T=t.x,R=t.y,L=t.width,A=t.height;if(i?(_=m,p=D,c=g,f||(f=1)):(_=Oe(a,_,b,w,!0),p=Oe(a,p,v,y)),e.save(),e.fillStyle=_,e.beginPath(),ht.Default.drawRoundRect(e,T,R,L,A,O,I,P,x),e.closePath(),e.fill(),f&&p&&(e.strokeStyle=p,e.lineWidth=f,e.stroke()),e.restore(),!u&&r)G(e,r,l,c,T,R,L,A,"center","middle");else if(u&&!r)F(e,U(u),"uniform",T+.5*(L-s),R+.5*(A-d),s,d,a,n);else if(u&&r){var S=ye(l,r),H=void 0,B=void 0;if("top"===h||M===h){var N=R+.5*(A-d-S.height);H={x:T,height:S.height,width:L},B={x:T+.5*(L-s),width:s,height:d},"top"===h?(H.y=N+d,B.y=N):M===h&&(H.y=N,B.y=N+S.height)}else{var W=T+.5*(L-s-S.width);H={width:S.width,y:R,height:A},B={y:.5*(A-d),width:s,height:d},"right"===h?(H.x=W,B.x=W+S.width):(H.x=W+s,B.x=W)}G(e,r,l,c,H.x,H.y,H.width,H.height,"center","middle"),F(e,U(u),"uniform",B.x,B.y,B.width,B.height,a,n)}},input:function(e,t,o,a,n){var r=o.getValue("value"),i=o.getValue("placeholder"),l=o.getValue("disabled"),u=o.getValue("borderWidth"),h=o.getValue("borderColor"),s=o.getValue("disabledBorderColor")||h,d=o.getValue("focusBorderColor")||h,c=o.getValue("borderRadius"),g=o.getValue("padding"),f=o.getValue("background"),p=o.getValue("disabledBackground")||f,v=o.getValue("focusBackground")||f,y=o.getValue("icon"),D=o.getValue("iconWidth"),_=o.getValue("iconHeight"),b=o.getValue("iconAlign"),w=o.getValue("font"),m=o.getValue("textAlign"),V=o.getValue("textColor"),k=o.getValue("disabledTextColor"),C=a&&a.a(Q.EDITING),E=De(g),O=ee(E,4),I=O[0],x=O[1],P=O[2],T=O[3],R=De(c),L=ee(R,4),A=L[0],S=L[1],H=L[2],B=L[3],N=t.x,W=t.y,M=t.width,G=t.height,F=void 0;if(a?l?(F=p,h=s,V=k,u||(u=1)):C?(F=v,h=d):F=f:F=f,e.save(),e.beginPath(),ht.Default.drawRoundRect(e,N,W,M,G,A,S,B,H),e.closePath(),F&&(e.fillStyle=F,e.fill()),(u&&h||C&&u&&d)&&(e.strokeStyle=C?d:h,e.lineWidth=u,e.stroke()),e.restore(),!C){var U=r||i||"",j=Math.max(0,M-T-x),z=Math.max(0,G-I-P),K=N+T,Y=W+I;r||!a||a.a(Q.DISABLED)||(V=te.placeholderColor),e.save(),e.beginPath(),e.rect(K,Y,j,z),e.clip(),Z(e,U,w,V,K,Y,j,z,m,"middle"),e.restore()}if(y){var X=void 0;X="left"===b?N:"center"===b?N+.5*(M-D):N+M-D,$(e,q(y),"uniform",X,.5*(G-_),D,_,a,n)}},textarea:function(t,e,o,a,n){var r=o.getValue("value"),i=o.getValue("placeholder"),l=o.getValue("disabled"),u=o.getValue("borderWidth"),h=o.getValue("borderColor"),s=o.getValue("disabledBorderColor"),d=o.getValue("focusBorderColor"),c=o.getValue("borderRadius"),g=o.getValue("padding"),f=o.getValue("background"),p=o.getValue("disabledBackground")||f,v=o.getValue("focusBackground")||f,y=o.getValue("textAlign"),D=o.getValue("textColor"),_=o.getValue("disabledTextColor"),b=o.getValue("lineHeight"),w=o.getValue("font"),m=o.getValue("wordBreak"),V=a&&a.a(Q.EDITING),k=De(g),C=ee(k,4),E=C[0],O=C[1],I=C[2],x=C[3],P=De(c),T=ee(P,4),R=T[0],L=T[1],A=T[2],S=T[3],H=e.x,B=e.y,N=e.width,W=e.height,M=void 0;if(a?l?(M=p,h=s,D=_,u||(u=1)):V?(M=v,h=d):M=f:M=f,t.save(),t.beginPath(),ht.Default.drawRoundRect(t,H,B,N,W,R,L,S,A),t.closePath(),M&&(t.fillStyle=M,t.fill()),(u&&h||V&&u&&d)&&(t.strokeStyle=V?d:h,t.lineWidth=u,t.stroke()),t.restore(),!V){var G=r||i||"",F=Math.max(0,N-x-O),U=Math.max(0,W-E-I);r||(D=te.placeholderColor),t.save(),t.beginPath(),t.rect(H+x,B+E,F,U),t.clip();var j=Ce(G,w,F,m),z=B+E;j.forEach(function(e){B+W<z||(K(t,e,w,D,H+x,z,F,b,y,"middle"),z+=b)}),t.restore()}},radio:function(e,t,o,a,n){var r=o.getValue("disabled"),i=o.getValue("checked"),l=o.getValue("normalColor"),u=o.getValue("background"),h=o.getValue("activeColor"),s=o.getValue("disabledColor"),d=o.getValue("disabledBackground"),c=i?h:l,g=t.x,f=t.y,p=t.width,v=t.height,y=Math.min(p,v);a&&(r?(c=s,u=d):a.a(Q.PRESSED)?i?c=ht.Default.darker(c,te.activeDarker):u=ht.Default.darker(u,te.activeDarker):a.a(Q.HOVER)&&(i?c=ht.Default.darker(c,te.hoverDarker):u=ht.Default.darker(u,te.hoverDarker))),e.save(),u&&(e.beginPath(),e.fillStyle=u,e.arc(g+.5*p,f+.5*v,.5*y,0,2*Math.PI),e.fill()),e.beginPath(),e.strokeStyle=c,e.lineWidth=1.5,e.arc(g+.5*p,f+.5*v,.5*y,0,2*Math.PI),e.stroke(),i&&(e.beginPath(),e.fillStyle=c,e.arc(g+.5*p,f+.5*v,.25*y,0,2*Math.PI),e.fill()),e.restore(),a&&!a.a(Q.INPUT_TYPE)&&a.a(Q.INPUT_TYPE,D)},checkbox:function(e,t,o,a,n){var r=o.getValue("checked"),i=o.getValue("disabled"),l=o.getValue("borderColor"),u=o.getValue("activeBorderColor"),h=o.getValue("disabledBorderColor"),s=o.getValue("background"),d=o.getValue("activeBackground"),c=o.getValue("disabledBackground"),g=o.getValue("borderRadius"),f=o.getValue("iconColor"),p=o.getValue("disabledIconColor"),v=t.x,y=t.y,D=t.width,_=t.height,b=Math.min(D,_);s=r?d:s,i?(l=h,f=p,s=c):s=Oe(a,s,null,null,!0),r&&!i&&(l=u),_<D?v+=.5*(D-_):D<_&&(y+=.5*(_-D)),e.save(),e.beginPath(),ht.Default.drawRoundRect(e,v,y,b,b,g),e.closePath(),s&&(e.fillStyle=s,e.fill()),e.strokeStyle=l,e.lineWidth=1,e.stroke(),r&&(e.beginPath(),e.moveTo(v+.125*b,y+.5*b),e.lineTo(v+b*(3/8),y+.75*b),e.lineTo(v+.8125*b,y+.25*b),e.lineWidth=Math.max(1,b/16),e.lineCap="round",e.strokeStyle=f,e.stroke()),e.restore(),a&&!a.a(Q.INPUT_TYPE)&&a.a(Q.INPUT_TYPE,w)},colorPicker:function(e,t,o,a,n){var r=o.getValue("disabled"),i=o.getValue("borderWidth"),l=o.getValue("borderColor"),u=o.getValue("disabledBorderColor"),h=o.getValue("focusBorderColor"),s=o.getValue("borderRadius"),d=o.getValue("textColor"),c=o.getValue("value"),g=o.getValue("font"),f=o.getValue("fullMode"),p=o.getValue("showDropDownIcon"),v=o.getValue("dropDownIcon"),y=o.getValue("dropDownIconColor"),D=o.getValue("dropDownIconWidth"),_=o.getValue("dropDownIconHeight"),b=De(s),w=ee(b,4),m=w[0],V=w[1],k=w[2],C=w[3],E=t.x,O=t.y,I=t.width,x=t.height,P=E+I+5,T=O+x+5,R=!1,L=void 0;if(r?l=d=u:a&&a.a(Q.EDITING)&&h&&(l=h),e.save(),f){e.beginPath(),ht.Default.drawRoundRect(e,E,O,I,x,m,V,C,k),e.closePath(),e.clip();for(var A=O,S=0;A<T;A+=5,S++){R=S%2!=0;for(var H=E;H<P;H+=5)e.fillStyle=R?oe:J,e.fillRect(H,A,5,5),R=!R}}else{P=(L={x:E+4,y:O+4,width:1.66*(x-8),height:x-8}).x+L.width,T=L.y+L.height,e.beginPath(),e.rect(L.x,L.y,L.width,L.height),e.closePath(),e.clip();for(var B=L.y,N=0;B<T;B+=5,N++){R=N%2!=0;for(var W=L.x;W<P;W+=5)e.fillStyle=R?oe:J,e.fillRect(W,B,5,5),R=!R}}e.restore(),e.save(),e.beginPath(),ht.Default.drawRoundRect(e,E,O,I,x,m,V,C,k),e.closePath(),c&&f?(e.fillStyle=c,e.fill()):c&&!f&&(e.fillStyle=c,e.fillRect(L.x,L.y,L.width,L.height),ae.setColor(c),z(e,ae,g,d,L.x+L.width+4,O,I-L.width-8,x,"left","middle")),i&&(e.lineWidth=i,e.strokeStyle=l,e.stroke()),p&&Y(e,X(v||"ht.vector.dropDownIcon"),"uniform",E+I-8-D,O+.5*(x-_),D,_,a,n,y),e.restore()},comboBox:function(e,t,o,a,n){var r=o.getValue("value"),i=o.getValue("placeholder"),l=o.getValue("disabled"),u=o.getValue("borderWidth"),h=o.getValue("borderColor"),s=o.getValue("disabledBorderColor"),d=o.getValue("focusBorderColor"),c=o.getValue("borderRadius"),g=o.getValue("padding"),f=o.getValue("background"),p=o.getValue("disabledBackground"),v=o.getValue("focusBackground")||f,y=o.getValue("icon"),D=o.getValue("iconWidth"),_=o.getValue("iconHeight"),b=o.getValue("iconAlign"),w=o.getValue("font"),m=o.getValue("textAlign"),V=o.getValue("textColor"),k=o.getValue("disabledTextColor"),C=o.getValue("dropDownIcon"),E=o.getValue("dropDownIconColor"),O=o.getValue("dropDownIconWidth"),I=o.getValue("dropDownIconHeight"),x=a&&a.a(Q.EDITING),P=De(g),T=ee(P,4),R=T[0],L=T[1],A=T[2],S=T[3],H=De(c),B=ee(H,4),N=B[0],W=B[1],M=B[2],G=B[3],F=t.x,U=t.y,j=t.width,z=t.height,K=void 0;a?l?(K=p,h=s,V=k,u||(u=1)):x?(K=v,h=d):K=f:K=f,e.save(),e.beginPath(),ht.Default.drawRoundRect(e,F,U,j,z,N,W,G,M),e.closePath(),K&&(e.fillStyle=K,e.fill()),(u&&h||x&&u&&d)&&(e.strokeStyle=x?d:h,e.lineWidth=u,e.stroke()),e.restore();var Y=r||i||"",X=Math.max(0,j-S-L),Z=Math.max(0,z-R-A),$=F+S,q=U+R;if(r||!a||a.a(Q.DISABLED)||(V=te.placeholderColor),e.save(),e.beginPath(),e.rect($,q,X,Z),e.clip(),ne(e,Y,w,V,y?$+D:$,q,X,Z,m,"middle"),e.restore(),y){var J=void 0;J="left"===b?$:"center"===b?F+.5*(j-D):F+j-D-L,re(e,ie(y),"uniform",J,.5*(z-_),D,_,a,n)}re(e,ie(C||"ht.vector.dropDownIcon"),"uniform",F+j-8-O,U+.5*(z-I),O,I,a,n,E)},gauge:function(e,t,o,a,n){var r=o.getValue("pointerRadius"),i=o.getValue("pointerColor"),l=o.getValue("value"),u=o.getValue("max"),h=o.getValue("min"),s=o.getValue("clockwise"),d=o.getValue("showTick"),c=o.getValue("tickEvery"),g=o.getValue("tickColor"),f=o.getValue("tickWidth"),p=(o.getValue("tickRadius"),o.getValue("bigTickEvery")),v=o.getValue("bigTickColor"),y=o.getValue("bigTickWidth"),D=(o.getValue("bigTickRadius"),o.getValue("showLabel")),_=o.getValue("labelEvery"),b=o.getValue("labelColor"),w=o.getValue("labelFont"),m=o.getValue("labelRadius"),V=o.getValue("showShadow"),k=o.getValue("shadowBlur"),C=o.getValue("shadowColor"),E=o.getValue("shadowOffsetX"),O=o.getValue("shadowOffsetY");se=o.getValue("startAngle"),de=o.getValue("endAngle"),ue=Math.abs(u-h),he=Math.abs(de-se);var I=t.x,x=t.y,P=t.width,T=t.height,R=Math.min(P,T)/2,L=ce(l,s);if(e.save(),V&&(e.shadowColor=C,e.shadowBlur=k,e.shadowOffsetX=E,e.shadowOffsetY=O),e.translate(I+.5*P,x+.5*T),d){if(p){e.beginPath(),e.strokeStyle=v,e.lineWidth=y;for(var A=h;A<=u;A+=p){var S=ce(A,s),H=R*Math.cos(S),B=R*Math.sin(S);e.moveTo(.84*H+I,.84*B+x),e.lineTo(H+I,B+x)}e.stroke()}if(c){e.beginPath(),e.strokeStyle=g,e.lineWidth=f;for(var N=h;N<=u;N+=c){var W=ce(N,s),M=R*Math.cos(W),G=R*Math.sin(W);e.moveTo(.9*M+I,.9*G+x),e.lineTo(M+I,G+x)}e.stroke()}}if(D){m=le(m,R),e.font=w,e.fillStyle=b,e.textAlign="center",e.textBaseline="middle";for(var F=h;F<=u;F+=_){var U=ce(F,s),j=m*Math.cos(U),z=m*Math.sin(U);e.fillText(F,j,z)}}var K=.05*(r=le(r,R));e.rotate(L),e.beginPath(),e.moveTo(-1.5*K,0),e.lineTo(0,-K),e.lineTo(r,0),e.lineTo(0,K),e.closePath(),e.fillStyle=i,e.fill(),e.restore()}},buttonInteractor:new _,inputInteractor:new v,textAreaInteractor:new p,radioInteractor:new b,checkboxInteractor:new m,colorPickerInteractor:new x,dateTimePickerInteractor:new P,comboBoxInteractor:new B,Color:a,ListView:S,ListDropDown:H},ve=/firefox/.test(window.navigator.userAgent.toLowerCase()),ye=(W={},ge=document?ht.Default.createCanvas().getContext("2d"):NULL,function(e,t){ge.font=e||labelFont;var o=W[ge.font];return o||(o=2*ge.measureText("e").width,W[ge.font]=o),{width:ge.measureText(t).width+2,height:o}}),De=function(e,t){if(!e)return _e([],t);var o,a=(o=e,o?("string"!=typeof o&&(o+=""),o.replace(/^\s+|\s+$/g,"")):"").split(/\s+/g),n=[];return a.forEach(function(e){isNaN(e)||n.push(parseInt(e))}),_e(n)},_e=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return e&&0!==e.length?3===e.length?[e[0],e[1],e[2],e[1]]:2===e.length?[e[0],e[1],e[0],e[1]]:1===e.length?[e[0],e[0],e[0],e[0]]:[e[0],e[1],e[2],e[3]]:[t,t,t,t]},be=function(e,t){t&&"textarea"===t||(t="input");var o=document.createElement(t),a=o.style;return a.display="block",a.boxSizing="border-box",a.position="absolute",a.width=e.width+"px",a.height=e.height+"px",a.top=e.y+"px",a.left=e.x+"px",a.outline="none",a.zIndex=1e4,a.borderWidth=0,a.backgroundColor="rgba(0, 0, 0, 0)",o},we=function(e,t,o){var a=t.getView(),n=new ht.Math.Matrix2d,r=a.getBoundingClientRect(),i=e.getAnchorRect(),l=o.style;n.appendTranslate(r.left,r.top),n.appendTranslate(t.tx(),t.ty()),n.appendScale(t.getZoom(),t.getZoom());var u=t.getDataUI(e);u&&u.interactiveInfo&&u.interactiveInfo.bodyInfo&&n.append(u.interactiveInfo.bodyInfo.matrix);var h="matrix("+n.a.toFixed(5)+", "+n.b.toFixed(5)+", "+n.c.toFixed(5)+",\n    "+n.d.toFixed(5)+", "+n.tx.toFixed(5)+", "+n.ty.toFixed(5)+")";Ve(l,"transform",h);var s=(-i.x).toFixed(5)+"px "+(-i.y).toFixed(5)+"px";Ve(l,"transformOrigin",s)},me=((fe=document.createElement("input")).setAttribute("style","width: 0;height: 0;"),function(){document.body.appendChild(fe),setTimeout(function(){fe.focus(),document.body.removeChild(fe)})}),Ve=function(e,t,o){var a=t[0].toUpperCase+t.substring(1,t.length);e["webkit"+a]=o,e["moz"+a]=o,e["ms"+a]=o,e["o"+a]=o,e[t]=o},ke=function(e,t,o){for(var a=[],n=0,r=1,i=e.length;r<=i;r++){var l=e.substring(n,r);ye(o,l).width>t&&(r-1===n?(a.push(e.substring(n,r)),n=r):(a.push(e.substring(n,r-1)),n=r-1))}return n!==r-1&&a.push(e.substring(n,r)),a},Ce=function(e,t,o,a){for(var n=[],r=e.split("\n"),i=0,l=r.length;i<l;i++){var u=r[i];if(""===u&&(u=" "),a)Array.prototype.push.apply(n,ke(u,o,t));else{for(var h,s,d="",c=void 0,g=void 0,f=void 0,p="",v=0;v<u.length;v++){u.charAt(v).match(/[a-z|A-Z]/g)?d+="1":d+="2"}d=(d=d.replace(/21/g,"2_1")).replace(/12/g,"1_2");for(var y=0;y<d.length;y++){d.charAt(y).match(/\_/g)&&(u=Ee(u,y+1,"|"))}h=u.split("|"),s=d.split("_");for(var D=0,_=h.length;D<_;D++)c=p+h[D],g=ye(t,c),"1"===s[D][0]?g.width>o?p?(n.push(p),p="",D--):(f=ke(h[D],o,t),Array.prototype.push.apply(n,f.slice(0,f.length-1)),p=f[f.length-1]):g.width===o?(n.push(c),p=""):p=c:g.width>o?(f=ke(c,o,t),Array.prototype.push.apply(n,f.slice(0,f.length-1)),p=f[f.length-1]):p=c;p&&n.push(p)}}return n},Ee=function(e,t,o){return e=e.substring(0,t-1)+o+e.substring(t-1,e.length)},Oe=function(e,t,o,a,n){if(!e)return t;if(e.a(Q.PRESSED)){if(a)return a;if(n)return t=t||te.emptyColor,ht.Default.darker(t,te.activeDarker)}else if(e.a(Q.HOVER)){if(o)return o;if(n)return t=t||te.emptyColor,ht.Default.darker(t,te.hoverDarker)}return t};function Ie(e,t){var o=e.prototype,a=ht.Default.getMSMap();for(var n in t)a[n]&&a.hasOwnProperty(n)?a[n](o,t):o[n]=t[n]}function xe(e,t){var o=t.getView().getBoundingClientRect(),a=t.getZoom(),n=t.tx(),r=t.ty(),i=e.getRect();return i.height*=a,i.width*=a,i.x=o.left+n+i.x*a,i.y=o.top+r+i.y*a,i}function Pe(e){var t=e.a(Q.VALUE);return void 0===t?"":t}var Te,Re,Le=(Te=null,Re=function(e,t,o){"binaryString"===o?e.readAsBinaryString(t):"ArrayBuffer"===o?e.readAsArrayBuffer(t):"dataUrl"===o?e.readAsDataURL(t):e.readAsText(t)},function(i){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},l=e.multiple,u=e.readType,h=e.filter,t=e.accept;Te||((Te=document.createElement("input")).setAttribute("type","file"),Te.setAttribute("id","hiddenFile"),Te.style.width=0,Te.style.height=0,Te.addEventListener("change",function(e){document.body.removeChild(Te),Te=null;for(var t=e.target.files,o={files:[]},a=0;a<t.length;a++)h?h(t[a])&&o.files.push(t[a]):o.files.push(t[a]);if(u&&0!==o.files.length)if(l){var n=0;o.files.forEach(function(t){var e=new FileReader;e.onload=function(e){t.readResult=e.target.result,++n===o.files.length&&i(o)},Re(e,t,u)})}else{var r=new FileReader;r.onload=function(e){t[0].readResult=e.target.result,i(o)},Re(r,t[0],u)}else i(o)}),document.body.appendChild(Te)),Te.multiple=!!l,Te.accept=t||"",Te.click()}),Ae=/^\d+px$/,Se=/^([0-9]{3}|bold|normal|bolder|lighter)$/,He=function(e){if(e){var t=e.split(/\s/g);if(Ae.test(t[0]))return{fontSize:t[0],fontFamily:t.slice(1,t.length).join("")};if(Se.test(t[0])&&Ae.test(t[1]))return{fontWeight:t[0],fontSize:t[1],fontFamily:t.slice(2,t.length).join("")}}return{fontSize:te.fontSize+"px",fontFamily:te.fontFamily}};return pe.theme=A,pe.openColorDropDown=C,pe.openDateTimeDropDown=I,pe.getFormData=function(e,t){var i={},l=t?t.getChildren():e.dm().getDatas();return l.each(function(e){var t=e.a(Q.FORM_ITEM_NAME),o=e.a(Q.FORM_ITEM_GROUP);if(t)i[t]=Pe(e);else if(o&&!i[Q.FORM_ITEM_GROUP])if(e.a(Q.INPUT_TYPE)===D)for(var a=0;a<l.length;a++){var n=l.get(a);if(o===n.a(Q.FORM_ITEM_GROUP)&&n.a(Q.CHECKED)){i[o]=Pe(n);break}}else if(e.a(Q.INPUT_TYPE)===w){var r=[];l.each(function(e){o===e.a(Q.FORM_ITEM_GROUP)&&e.a(Q.CHECKED)&&r.push(Pe(e))}),i[o]=r}}),i},pe.selectFile=Le,pe});
