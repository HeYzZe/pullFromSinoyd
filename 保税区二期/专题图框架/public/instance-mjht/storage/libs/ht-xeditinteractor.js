!function(E,g,f){"use strict";var M="ht",Z=E[M],G=Z.Default,c=Z.graph,T=G.getInternal(),_=T.ui(),Y=_.NodeUI.prototype,l=_.ShapeUI.prototype,s=c.GraphView,I=s.prototype,k=_.EdgeUI.prototype,W=Z.Node,t=Z.Shape,P=Z.Edge,N=Z.Group,i=G.isTouchable,r=G.preventDefault,R=E.setTimeout,F=G.grow,H=G.isDragging,S=G.getDistance,d=null,x=Z.List,V="undefined"!=typeof Float32Array?Float32Array:Array,z=Math,L=z.PI,h="Crossing",X="No Crossing",n=L/2,D=2*L,K=z.atan2,B=z.sqrt,q=z.pow,b=z.sin,a=z.cos,U=z.min,v=z.max,A=z.abs,y=z.ceil,J=z.round,o=G.unionPoint,O=G.unionRect,m=G.containsPoint,u=G.clone,Q="rgb(52, 152, 219)",$="red",e={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},j={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var m=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],k=0;k<m.length;k++){var J=m[k];J=0===k%2?J/400*j.width:J/100*j.height,m[k]=J}return j.width>120&&(m[4]=j.width-26,m[6]=j.width-40,m[10]=j.width-40,m[12]=j.width-26,m[18]=33),m}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},w={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:Q,rotation:.61},{type:"circle",rect:[200,120,70,70],background:Q,rotation:.61},{type:"circle",rect:[200,220,70,70],background:Q,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:Q},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:Q}]},p={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:$,rotation:.61}]},C={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:Q},{type:"circle",rect:[0,210,90,90],background:Q},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:Q}]},gl={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:$},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:$}]},Kc={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:Q}]},Xd={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:$}]},kg={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Rl={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Dj=function(d){var E=d.touches[0];return E?E:d.changedTouches[0]},dc=function(G,F,x,Z){return K(Z-F,x-G)},Co=function(R,w){return{x:R.x*w,y:R.y*w}},xf=function(M,d){M.each(function(Q){return M.isSelected(Q)?d(Q):void 0})},Xo=function(O,p){O.reverseEach(function(i){return O.isSelected(i)?p(i):void 0})},Nc=function(E,h,_){var b,r,Q,k,v,o=this,j=h,p=o.gv;if(E instanceof t){Q=E.getSegments();var f=p.getDataUI(E);v=f._55O.$15l,Q&&Q.size()||(Q=bl(v)),E.isClosePath()&&Q.indexOf(5)<0&&(Q=new x(Q._as),Q.add(5)),b=ri(E,f,j),r=v[b]}else{var y=p.getDataUI(E);v=Io(y,E.s("edge.points")),Q=E.s("edge.segments"),Q&&Q.size()||(Q=bl(v)),v=v._as,b=ri(E,y,j),r=v[b]}if(Q&&(k=Q.get(j)),2===k||1===k||5===k){var X=v[b+1];5===k&&(X=v[0]);var d=Jl(r,_,X);return d}return _},Up=function(t,b,i,P){var d=b/2,E=i/2,g=cp(t,-d,-E,P),e=cp(t,d,-E,P),H=cp(t,-d,E,P),q=cp(t,d,E,P),F=cp(t,0,-E,P),v=cp(t,d,0,P),U=cp(t,0,E,P),A=cp(t,-d,0,P);return[g,e,H,q,F,v,U,A]},Jl=function(x,y,A){var p={x:y.x-x.x,y:y.y-x.y},v={x:A.x-x.x,y:A.y-x.y},r=B(q(A.x-x.x,2)+q(A.y-x.y,2)),E={x:v.x/r,y:v.y/r},h=p.x*E.x+p.y*E.y,M={x:E.x*h,y:E.y*h};return{x:x.x+M.x,y:x.y+M.y}},cp=function(g,J,r,$){var G=a($)*J-b($)*r,d=b($)*J+a($)*r;return g?{x:g.x+G,y:g.y+d}:{x:G,y:d}},fk=function(P,O){return O>2*P?P:O/2},kk=function(D,I,$,n){var V=S(D,I);return $=n?U($,V):fk($,V),V?$/=V:$=0,{x:D.x+(I.x-D.x)*$,y:D.y+(I.y-D.y)*$}},rr=function(N,F){var d,X,e=N.gv,L=N._data,t=L._40I,_=L._41I,S=L.s("edge.offset"),n=L.s("edge.source.position"),R=L.s("edge.target.position"),m=L.s("edge.source.offset.x"),U=L.s("edge.source.offset.y"),H=L.s("edge.target.offset.x"),$=L.s("edge.target.offset.y"),J=L.s("edge.source.anchor.x"),f=L.s("edge.source.anchor.y"),w=L.s("edge.target.anchor.x"),G=L.s("edge.target.anchor.y");if(F?(d=T.getEdgeAgentPosition(e,t,n,m,U,J,f),X=T.getEdgeAgentPosition(e,_,R,H,$,w,G)):(d=T.getEdgeAgentPosition(e,t,n,0,0,J,f),X=T.getEdgeAgentPosition(e,_,R,0,0,w,G)),"points"===L.s("edge.type")&&S&&!L.s("edge.center")&&d){var E=L.s("edge.points")||new x,O=E.size(),q=kk(d,O?E.get(0):X,S,O),I=kk(X,O?E.get(O-1):d,S,O);d=q,X=I}return[d,X]},Io=function(r,v,P){var s=r._78o,V=r._data,D=V.s("edge.type"),T=[s.sourcePoint,s.targetPoint];return"points"===D?P&&(T=rr(r)):T=s.center?D?P?rr(r):rr(r,!0):P?rr(r):[s.c1,s.c2]:P?rr(r):rr(r,!0),v=new x(v?v._as:d),v.add(T[0],0),v.add(T[1]),v},eq=function(Q){return Q=new x(Q._as),Q.removeAt(0),Q.removeAt(Q.size()-1),Q},bl=function(g){g._as||(g=new x(g));var u=new x;u.add(1);for(var E=1;E<g.size();E++)u.add(2);return u},Nd=function(q,K){return{x:(q.x+K.x)/2,y:(q.y+K.y)/2}},gn=function(r,s){return{x:r.x+1*(s.x-r.x)/4,y:r.y+1*(s.y-r.y)/4}},iq=function(j,V){return{x:j.x+3*(V.x-j.x)/4,y:j.y+3*(V.y-j.y)/4}},Vn=function(r,e,E,n){var z=e.x+e.width/2,g=e.y+e.height/2,X=B(z*z+g*g),C=K(g,z)+E;return{x:n.x+X*a(C),y:n.y+X*b(C)}},cb=I.validateImpl,hs=I.isRectEditable,bg=I.isPointEditable,sq=I._42,tl=l._79o,Bc=k._79o,Qq=l._48O,Zl=l._47O,hi=Y._48O,zd=Y._80o,Yo=l._80o,Ne=Y.getSelectWidth,dm=Y._47O,Sc=k._47O,$p=I.isEditable,Jn=["northwest","north","northeast","east","southeast","south","southwest","west"],Ln=function(n,V,L,r,z,Y,m,H,Q,q){var k=n.x,A=n.y,T=n.width,u=n.height,N={x:k+T/2,y:A+u/2};r=r||0,V=cp(N,V.x-N.x,V.y-N.y,-r),m&&!H&&(V.x+=Q,V.y+=q);var f=.01;if("northwest"===L?(V.x+z>k+T-f&&(V.x=k+T-z-f),V.y+z>A+u-f&&(V.y=A+u-z-f),n=o(V,{x:k+T,y:A+u})):"north"===L?(V.y+z>A+u-f&&(V.y=A+u-z-f),n=o({x:k,y:V.y},{x:k+T,y:A+u})):"northeast"===L?(V.x<k+z+f&&(V.x=k+z+f),V.y+z>A+u-f&&(V.y=A+u-z-f),n=o({x:k,y:V.y},{x:V.x,y:A+u})):"west"===L?(V.x+z>k+T-f&&(V.x=k+T-z-f),n=o({x:V.x,y:A},{x:k+T,y:A+u})):"east"===L?(V.x<k+z+f&&(V.x=k+z+f),n=o({x:k,y:A},{x:V.x,y:A+u})):"southwest"===L?(V.x+z>k+T-f&&(V.x=k+T-z-f),V.y<A+z+f&&(V.y=A+z+f),n=o({x:V.x,y:A},{x:k+T,y:V.y})):"south"===L?(V.y<A+z+f&&(V.y=A+z+f),n=o({x:k,y:A},{x:k+T,y:V.y})):"southeast"===L&&(V.x<k+z+f&&(V.x=k+z+f),V.y<A+z+f&&(V.y=A+z+f),n=o({x:k,y:A},V)),"keepRatio"===Y&&(!m&&H||m&&!H)&&("northeast"===L||"southeast"===L||"northwest"===L||"southwest"===L)){var F=n.width,B=n.height,h=F/T,$=B/u,G=U(h,$);n.width=T*G,n.height=u*G,"northeast"===L?n.y=A+(u-n.height):"northwest"===L?(n.y=A+(u-n.height),n.x=k+(T-n.width)):"southwest"===L&&(n.x=k+(T-n.width))}n.x-=N.x,n.y-=N.y;var a=Vn(d,n,r,N);return n.x=a.x-n.width/2,n.y=a.y-n.height/2,n},Gp=function(y,r,W,t){var $=y.getRotation(),L=r,z=L.x,x=L.y,N=L.width,Y=L.height,D={x:z+L.width/2,y:x+L.height/2};t=cp(D,t.x-D.x,t.y-D.y,-$),"northwest"===W?L=o(t,{x:z+N,y:x+Y}):"north"===W?L=o({x:z,y:t.y},{x:z+N,y:x+Y}):"northeast"===W?L=o({x:z,y:t.y},{x:t.x,y:x+Y}):"west"===W?L=o({x:t.x,y:x},{x:z+N,y:x+Y}):"east"===W?L=o({x:z,y:x},{x:t.x,y:x+Y}):"southwest"===W?L=o({x:t.x,y:x},{x:z+N,y:t.y}):"south"===W?L=o({x:z,y:x},{x:z+N,y:t.y}):"southeast"===W&&(L=o({x:z,y:x},t)),y.setRect(L),L.x-=D.x,L.y-=D.y;var j=Vn(y,L,$,D);y.p(j.x,j.y)},pk=function(L,e,E,Z,A,w,x,$){var u=d;w?(u=cp(d,A.x-e.x,A.y-e.y,-E),u.x-=x.x,u.y-=x.y):u=cp(d,A.x-e.x,A.y-e.y,0);var N={x:e.x+u.x,y:e.y+u.y};$&&(N=$(N.x,N.y)),N.e=L.getPoints().get(Z).e,L.setPoint(Z,N);var B=L.getWidth(),C=L.getHeight(),_=L.p().x-B/2,j=L.p().y-C/2;_-=e.x,j-=e.y;var o=Vn(L,{x:_,y:j,width:B,height:C},E,e);L.p(o.x,o.y)},ri=function(i,J,W){var D,Y;if(i instanceof t?(D=i.getPoints(),Y=i.getSegments()):i instanceof P&&"points"===i.s("edge.type")&&(D=i.s("edge.points"),Y=i.s("edge.segments"),D=Io(J,D)),Y&&Y.size()||(Y=bl(D)),i instanceof t&&i.isClosePath()&&Y.indexOf(5)<0&&(Y=new x(Y._as),Y.add(5)),Y)for(var I=-1,f=0;f<Y.size();f++){if(f===W)return I;var d=Y.get(f);1===d?I+=1:2===d?I+=1:3===d?I+=2:4===d&&(I+=3)}},kq=function(l,s,w){var T,f;if(l instanceof t?(T=l.getPoints(),f=l.getSegments()):l instanceof P&&"points"===l.s("edge.type")&&(T=l.s("edge.points"),f=l.s("edge.segments"),T=Io(s,T)),f&&f.size()||(f=bl(T)),f)for(var S=-1,A=0;A<f.size();A++){var D=f.get(A);if(1===D?S+=1:2===D?S+=1:3===D?S+=2:4===D&&(S+=3),S===w)return A}},si=function(h,a){var i=[h[0]-a[0],h[1]-a[1],h[2]-a[2]];return i},Tj=function(){var i=new V(16);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},mg=function(P,_){var c=P[0],V=P[1],x=P[2];return P[0]=_[0]*c+_[4]*V+_[8]*x+_[12],P[1]=_[1]*c+_[5]*V+_[9]*x+_[13],P[2]=_[2]*c+_[6]*V+_[10]*x+_[14],P},_o=function(D,P){if(P){var e=b(P),W=a(P),u=D[0],I=D[1],A=D[2],i=D[3],Q=D[8],E=D[9],k=D[10],q=D[11];D[0]=u*W-Q*e,D[1]=I*W-E*e,D[2]=A*W-k*e,D[3]=i*W-q*e,D[8]=u*e+Q*W,D[9]=I*e+E*W,D[10]=A*e+k*W,D[11]=i*e+q*W}},ek=function(X,O){for(var p=X.s("grid.row.count"),T=X.s("grid.column.count"),y=0;p>y;y++)for(var d=0;T>d;d++){var g=X.getCellRect(y,d);if(m(g,O))return{rowIndex:y,columnIndex:d,rect:g,grid:X}}return null},tj=function(O,T,M,X,a,q){var F={},I=M-O,w=X-T,Q=z.sqrt(I*I+w*w),D=I/Q,k=w/Q,c=(-O+a)*D+(-T+q)*k;return 0>=c?(F.x=O,F.y=T):c>=Q?(F.x=M,F.y=X):(F.x=O+c*D,F.y=T+c*k),I=a-F.x,w=q-F.y,F.z=z.sqrt(I*I+w*w),F},wf=function(A,D){var V,T,J,k,e,G,l,n,c=A.getPoints(),h=A.getSegments(),E=A.p(),$=A.getRotation();if(!h||!(h.indexOf(3)>0||h.indexOf(4)>0)){for(n=0;n<=c.size()-1;n++)if(n===c.size()-1?(e=c.get(0),k=c.get(n)):(k=c.get(n),e=c.get(n+1)),k=cp(E,k.x-E.x,k.y-E.y,$),e=cp(E,e.x-E.x,e.y-E.y,$),G=tj(k.x,k.y,e.x,e.y,D.x,D.y),l=G.z,l<(A.s("shape.border.width")||10)){T=k,J=e,V=n;break}if(V!=d){var r=tj(T.x,T.y,J.x,J.y,D.x,D.y),N=S(T,r);return{attachIndex:V,attachOffset:N}}}},Wp=function(t){for(var y=t._data,k=y.p(),s=y.getRotation(),i=y.getPoints(),q=d,K=[],w=0;w<i.size();w++)q=i.get(w),K.push(cp(k,q.x-k.x,q.y-k.y,s));t._55O.$15l=K};G.setImage("xeditinteractor_parentIcon",w),G.setImage("xeditinteractor_hostIcon",p),G.setImage("xeditinteractor_edgeIcon",C),G.setImage("xeditinteractor_removeIcon",gl),G.setImage("xeditinteractor_sourceIcon",Kc),G.setImage("xeditinteractor_targetIcon",Xd),G.setImage("xeditinteractor_elevationIcon",kg),G.setImage("xeditinteractor_tallIcon",Rl),I._editPointSize=i?24:9,I._edgeHelpers=["parent","remove","source","target"],I._leftTopHelpers=["parent"],I._rightTopHelpers=["host"],I._leftBottomHelpers=["edge"],I._rightBottomHelpers=["remove"],Jn=Jn.concat(Jn).concat(Jn),k._79o=function(){var t=this,Q=t.gv,B=Q.getZoom(),e=Q._editInteractor,V=Bc.call(t);if(!V)return null;var q=rr(t,!0),j=q[0],w=q[1],x={x:V.x,y:V.y,width:V.width,height:V.height},K=o(j,w);if(e instanceof c.XEditInteractor){x=O(x,K);var L=t._55O,b=Q.getEditPointSize()/B+2,W=0;L&&L._43O&&(W+=b/2,F(x,W))}return x},k._47O=function(n){var z=this,f=z.gv,e=f._editInteractor;e instanceof c.XEditInteractor||Sc.call(z,n)},k.rectIntersects=function($){var B=this,l=B._data,Z=B.gv,K=Z.getZoom(),n=B._55O,j=Z._editInteractor;if(j instanceof c.XEditInteractor&&Z.isEditable(l)&&n&&n._43O&&"points"===l.s("edge.type")){var A=l.s("edge.points"),y=l.s("edge.segments");A=Io(B,A),y&&y.size()||(y=bl(A)),A=A._as;var s=!1,C=i?5:1,I=$.x+C,V=$.y+C,t={x:I,y:V};if(j._edge===l&&j._hoverSegmentIndex>=0){var e=Z._editInteractor._hoverSegmentIndex,P=y.get(e),M=ri(l,B,e),Y=d;if(M!=d&&M>=0){var Q=A[M],D=Z.getSegmentHoverWidth()/K;if(2===P||1===P){var g=A[M+1];Y=Uh(new tk(Q.x,Q.y),new tk(g.x,g.y),new tk(t.x-D,t.y-D),new tk(t.x+2*D,t.y+2*D)),Y.$62l===h&&(s=!0)}else if(3===P){var f=A[M+1],g=A[M+2];Y=Ng(new tk(Q.x,Q.y),new tk(f.x,f.y),new tk(g.x,g.y),new tk(t.x-D,t.y-D),new tk(t.x+2*D,t.y+2*D)),Y.$62l===h&&(s=!0)}else if(4===P){var O=A[M+1],S=A[M+2];g=A[M+3],Y=Db(new tk(Q.x,Q.y),new tk(O.x,O.y),new tk(S.x,S.y),new tk(g.x,g.y),new tk(t.x-D,t.y-D),new tk(t.x+2*D,t.y+2*D)),Y.$62l===h&&(s=!0)}}}if(s)return!0}return d},l._47O=function(b){var n=this,G=n.gv,m=G._editInteractor;m instanceof c.XEditInteractor||Zl.call(n,b)},l.rectIntersects=function(o){var Q=this,l=Q._data,X=Q.gv,f=X.getZoom(),y=Q._55O,U=X._editInteractor;if(U instanceof c.XEditInteractor&&X.isEditable(l)&&y&&y._43O){var j=y.$15l,J=!1,F=i?5:1,O=o.x+F,W=o.y+F,M={x:O,y:W};if(j&&j.length===l.getPoints().size()||(Wp(Q),j=y.$15l),U._shape===l&&U._hoverSegmentIndex>=0){var N=l.getSegments();N&&N.size()||(N=bl(j));var K=X._editInteractor._hoverSegmentIndex,x=N.get(K),_=ri(l,Q,K),w=d;if(_!=d&&_>=0){var p=j[_],B=X.getSegmentHoverWidth()/f;if(2===x||1===x){var a=j[_+1];w=Uh(new tk(p.x,p.y),new tk(a.x,a.y),new tk(M.x-B,M.y-B),new tk(M.x+2*B,M.y+2*B)),w.$62l===h&&(J=!0)}else if(3===x){var L=j[_+1],a=j[_+2];w=Ng(new tk(p.x,p.y),new tk(L.x,L.y),new tk(a.x,a.y),new tk(M.x-B,M.y-B),new tk(M.x+2*B,M.y+2*B)),w.$62l===h&&(J=!0)}else if(4===x){var b=j[_+1],e=j[_+2];a=j[_+3],w=Db(new tk(p.x,p.y),new tk(b.x,b.y),new tk(e.x,e.y),new tk(a.x,a.y),new tk(M.x-B,M.y-B),new tk(M.x+2*B,M.y+2*B)),w.$62l===h&&(J=!0)}}}if(J)return!0}return d},l._48O=function(){var u=this,r=u.gv,n=r._editInteractor;n instanceof c.XEditInteractor?(Y._48O.call(u),u._55O._43O&&Wp(u)):Qq.call(u)},l._79o=function(){var t=this,n=t.gv,R=n.getZoom(),y=n._editInteractor,A=tl.call(t);if(A){var Z={x:A.x,y:A.y,width:A.width,height:A.height};if(y instanceof c.XEditInteractor){var U=t._55O,X=n.getEditPointSize()/R+2,d=0;U&&U._43O&&(d+=X/2,F(Z,d))}return Z}},Y._47O=function(x){var Q=this,H=Q.gv,u=H._editInteractor;if(u instanceof c.XEditInteractor);else{var I=Q._55O;I&&I._98o&&dm.call(Q,x)}},Y.getSelectWidth=function(){var E=this,r=E.gv,n=r._editInteractor,H=E._data;return r.isEditable(H)&&n instanceof c.XEditInteractor?0:Ne.call(E)},Y._80o=function(X){var a=this,B=a.gv._editInteractor;if(zd.call(a,X),B&&B._debug){X.save(),X.beginPath(),X.lineWidth=1,X.strokeStyle="green";var _=a._79o();_&&(X.rect(_.x,_.y,_.width,_.height),X.stroke()),X.restore()}},l._80o=function(M){var W=this,D=W.gv._editInteractor;if(Yo.call(W,M),D&&D._debug){M.save(),M.beginPath(),M.lineWidth=1,M.strokeStyle="green";var U=W._79o();M.rect(U.x,U.y,U.width,U.height),M.stroke(),M.restore()}},Y._48O=function(){var Q=this,U=Q.gv,e=Q._data,J=U._editInteractor,a=Q._55O,E=e.p(),i=e.getRotation();if(J instanceof c.XEditInteractor){if(a._42O){var I=Up(E,e.getWidth(),e.getHeight(),i),N=I[0],s=I[1],l=I[2],d=I[3],n=I[4],Y=I[5],u=I[6],$=I[7];a.$45l=[N,n,s,Y,d,u,l,$]}}else hi.call(Q)},I.getResizeMode=function(){return this.$25l||"normal"},I.setResizeMode=function(k){var R=this.$25l;this.$25l=k,this.fp("resizeMode",R,k)},I.getSnapAngle=function(){return this.$26l||Math.PI/36},I.setSnapAngle=function(I){var y=this.$26l;this.$26l=I,this.fp("snapAngle",y,I)},I.getSnapSpacing=function(){return this.$27l},I.setSnapSpacing=function(D){var o=this.$27l;this.$27l=D,this.fp("snapSpacing",o,D)},I.getPointSnapSpacing=function(){return this._pointSnapSpacing},I.setPointSnapSpacing=function(n){var L=this._pointSnapSpacing;this._pointSnapSpacing=n,this.fp("pointSnapSpacing",L,n)},I.setHelperEditableFunc=function(E){var L=this._helperEditableFunc;this._helperEditableFunc=E,this.fp("helperEditableFunc",L,E)},I.getHelperEditableFunc=function(){return this._helperEditableFunc},I.setLeftTopHelpers=function(G){var r=this._leftTopHelpers;this._leftTopHelpers=G,this.fp("leftTopHelpers",r,G)},I.getLeftTopHelpers=function(){return this._leftTopHelpers},I.setLeftTopHelpersAlign=function(F){var O=this._leftTopHelpersAlign;this._leftTopHelpersAlign=F,this.fp("leftTopHelpersAlign",O,F)},I.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},I.setRightTopHelpers=function(y){var w=this._rightTopHelpers;this._rightTopHelpers=y,this.fp("rightTopHelpers",w,y)},I.getRightTopHelpers=function(){return this._rightTopHelpers},I.setRightTopHelpersAlign=function(O){var M=this._rightTopHelpersAlign;this._rightTopHelpersAlign=O,this.fp("rightTopHelpersAlign",M,O)},I.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},I.setLeftBottomHelpers=function(R){var q=this._leftBottomHelpers;this._leftBottomHelpers=R,this.fp("leftBottomHelpers",q,R)},I.getLeftBottomHelpers=function(){return this._leftBottomHelpers},I.setLeftBottomHelpersAlign=function($){var w=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=$,this.fp("leftBottomHelpersAlign",w,$)},I.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},I.setRightBottomHelpers=function(S){var o=this._rightBottomHelpers;this._rightBottomHelpers=S,this.fp("rightBottomHelpers",o,S)},I.getRightBottomHelpers=function(){return this._rightBottomHelpers},I.setRightBottomHelpersAlign=function(J){var y=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=J,this.fp("rightBottomHelpersAlign",y,J)},I.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},I.setEdgeHelpers=function(c){var v=this._edgeHelpers;this._edgeHelpers=c,this.fp("edgeHelpers",v,c)},I.getEdgeHelpers=function(){return this._edgeHelpers},I.isHelperEditable=function(c,v){return c instanceof P&&("host"===v||"edge"===v||"elevation"===v||"tall"===v)?!1:c instanceof W&&("source"===v||"target"===v)?!1:"pointElevation"===v?this._helperEditableFunc?this._helperEditableFunc(c,v):!1:this._helperEditableFunc?this._helperEditableFunc(c,v):!0},I.getEditHelperSize=function(){return this._editHelperSize||(i?28:16)},I.setEditHelperSize=function(f){var K=this._editHelperSize;this._editHelperSize=f,this.fp("editHelperSize",K,f)},I.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},I.setEditRectBorderColor=function(k){var q=this.$28l;this.$28l=k,this.fp("editRectBorderColor",q,k)},I.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},I.setNodeBorderColor=function(x){var w=this.$29l;this.$29l=x,this.fp("nodeBorderColor",w,x)},I.getEditRectBorderStyle=function(){return this.$30l||"dashed"},I.setEditRectBorderStyle=function(A){var d=this.$30l;this.$30l=A,this.fp("editRectBorderStyle",d,A)},I.getControlPointBackground=function(){return this.$31l||"#ff0"},I.setControlPointBackground=function(h){var K=this.$31l;this.$31l=h,this.fp("controlPointBackground",K,h)},I.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},I.setControlPointBorderColor=function(a){var q=this.$32l;this.$32l=a,this.fp("controlPointBorderColor",q,a)},I.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},I.setJoinPointBackground=function(n){var i=this.$33l;this.$33l=n,this.fp("joinPointBackground",i,n)},I.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},I.setJoinPointBorderColor=function(Y){var f=this.$34l;this.$34l=Y,this.fp("joinPointBorderColor",f,Y)},I.getDirectionLineColor=function(){return this.$35l||"#888"},I.setDirectionLineColor=function(X){var D=this.$35l;this.$35l=X,this.fp("directionLineColor",D,X)},I.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},I.setSegmentHoverColor=function(N){var K=this.$36l;this.$36l=N,this.fp("segmentHoverColor",K,N)},I.getSegmentHoverWidth=function(){return this.$22l||(i?16:8)},I.setSegmentHoverWidth=function(C){var v=this.$22l;this.$22l=C,this.fp("segmentHoverWidth",v,C)},I.getSnapPointBorderColor=function(){return this.$38l||"#f00"},I.setSnapPointBorderColor=function(X){var O=this.$38l;this.$38l=X,this.fp("snapPointBorderColor",O,X)},I.getEditRectPadding=function(){return this.$39l!=d?this.$39l:6},I.setEditRectPadding=function(p){var J=this.$39l;this.$39l=p,this.fp("editRectPading",J,p)},I.isRectEditable=function(n){var g=this,A=g._editInteractor;return A instanceof c.XEditInteractor?g._rectEditableFunc?g._rectEditableFunc(n):!0:hs.call(g,n)},I.isPointEditable=function(d){var e=this,S=e._editInteractor;return S instanceof c.XEditInteractor?e._pointEditableFunc?e._pointEditableFunc(d):!0:bg.call(e,d)},I.validateImpl=function(){var W=this,w=W.$14l,B=W._editInteractor;if(w){var n=W.getWidth(),R=W.getHeight();(n!==w.clientWidth||R!==w.clientHeight)&&(B&&(B._68I=1),T.setCanvas(w,n,R),W._32I=1)}cb.call(this)},I.isEditable=function(Y){var L=$p.call(this,Y),f=this._editInteractor;if(f instanceof c.XEditInteractor&&Y instanceof P){if(!Y.s("2d.editable"))return!1;var i=this.getEditableFunc();L=i?i(Y):!0}return L},I._42=function(r,x){var e=this,u=e._editInteractor;sq.call(e,r,x),u instanceof c.XEditInteractor&&u._68I&&u._42()},I.isSnapPoint=function(){return!0};var $o=function(G){arguments.length>0&&this.$58l(G)},po=$o.prototype;po.$58l=function(Q){this.$62l=Q,this.points=new Array},po.$56l=function(K){this.points.push(K)},po.$57l=function(X){this.points=this.points.concat(X)};var tk=function(d,x){arguments.length>0&&this.$58l(d,x)},Fm=tk.prototype;Fm.$58l=function(p,E){this.x=p,this.y=E},Fm.add=function(c){return new tk(this.x+c.x,this.y+c.y)},Fm.addEquals=function(h){return this.x+=h.x,this.y+=h.y,this},Fm.$55l=function(H){return new tk(this.x*H,this.y*H)},Fm.eq=function(r){return this.x==r.x&&this.y==r.y},Fm.lt=function(t){return this.x<t.x&&this.y<t.y},Fm.lte=function(K){return this.x<=K.x&&this.y<=K.y},Fm.gt=function(m){return this.x>m.x&&this.y>m.y},Fm.gte=function(q){return this.x>=q.x&&this.y>=q.y},Fm.lerp=function(M,n){return new tk(this.x+(M.x-this.x)*n,this.y+(M.y-this.y)*n)},Fm.distanceFrom=function(S){var O=this.x-S.x,T=this.y-S.y;return B(O*O+T*T)},Fm.min=function(C){return new tk(U(this.x,C.x),U(this.y,C.y))},Fm.max=function(F){return new tk(v(this.x,F.x),v(this.y,F.y))},Fm.toString=function(){return this.x+","+this.y};var ic=function(){this.$58l(arguments)},Bs=ic.prototype;ic.TO=1e-6,ic.AC=6,Bs.$58l=function(R){this.co=new Array;for(var H=R.length-1;H>=0;H--)this.co.push(R[H])},Bs.$55l=function(E){for(var S=new ic,v=0;v<=this.$50l()+E.$50l();v++)S.co.push(0);for(var v=0;v<=this.$50l();v++)for(var M=0;M<=E.$50l();M++)S.co[v+M]+=this.co[v]*E.co[M];return S},Bs.$59l=function(){for(var d=this.$50l();d>=0&&A(this.co[d])<=ic.TO;d--)this.co.pop()},Bs.$50l=function(){return this.co.length-1},Bs.$51l=function(){var O;switch(this.$59l(),this.$50l()){case 0:O=new Array;break;case 1:O=this.$52l();break;case 2:O=this.$53l();break;case 3:O=this.$54l();break;case 4:O=this.$63l();break;default:O=new Array}return O},Bs.$52l=function(){var p=new Array,M=this.co[1];return 0!=M&&p.push(-this.co[0]/M),p},Bs.$53l=function(){var n=new Array;if(2==this.$50l()){var C=this.co[2],Z=this.co[1]/C,e=this.co[0]/C,r=Z*Z-4*e;if(r>0){var y=B(r);n.push(.5*(-Z+y)),n.push(.5*(-Z-y))}else 0==r&&n.push(.5*-Z)}return n},Bs.$63l=function(){var g=new Array;if(4==this.$50l()){var X=this.co[4],Y=this.co[3]/X,M=this.co[2]/X,E=this.co[1]/X,F=this.co[0]/X,u=new ic(1,-M,Y*E-4*F,-Y*Y*F+4*M*F-E*E).$54l(),q=u[0],V=Y*Y/4-M+q;if(A(V)<=ic.TO&&(V=0),V>0){var i=B(V),n=3*Y*Y/4-i*i-2*M,d=(4*Y*M-8*E-Y*Y*Y)/(4*i),T=n+d,r=n-d;if(A(T)<=ic.TO&&(T=0),A(r)<=ic.TO&&(r=0),T>=0){var l=B(T);g.push(-Y/4+(i+l)/2),g.push(-Y/4+(i-l)/2)}if(r>=0){var l=B(r);g.push(-Y/4+(l-i)/2),g.push(-Y/4-(l+i)/2)}}else if(0>V);else{var d=q*q-4*F;if(d>=-ic.TO){if(0>d&&(d=0),d=2*B(d),n=3*Y*Y/4-2*M,n+d>=ic.TO){var a=B(n+d);g.push(-Y/4+a/2),g.push(-Y/4-a/2)}if(n-d>=ic.TO){var a=B(n-d);g.push(-Y/4+a/2),g.push(-Y/4-a/2)}}}}return g},Bs.$54l=function(){var H=new Array;if(3==this.$50l()){var C=this.co[3],E=this.co[2]/C,$=this.co[1]/C,j=this.co[0]/C,t=(3*$-E*E)/3,u=(2*E*E*E-9*$*E+27*j)/27,D=E/3,N=u*u/4+t*t*t/27,h=u/2;if(A(N)<=ic.TO&&(N=0),N>0){var y,v,P=B(N);y=-h+P,v=y>=0?q(y,1/3):-q(-y,1/3),y=-h-P,y>=0?v+=q(y,1/3):v-=q(-y,1/3),H.push(v-D)}else if(0>N){var T=B(-t/3),F=K(B(-N),-h)/3,I=a(F),d=b(F),x=B(3);H.push(2*T*I-D),H.push(-T*(I+x*d)-D),H.push(-T*(I-x*d)-D)}else{var y;y=h>=0?-q(h,1/3):q(-h,1/3),H.push(2*y-D),H.push(-y-D)}}return H};var uc=function($,s){arguments.length>0&&this.$58l($,s)},Zp=uc.prototype;Zp.$58l=function(P,u){this.x=P,this.y=u},Zp.length=function(){return B(this.x*this.x+this.y*this.y)},Zp.$60l=function(v){return this.x*v.x+this.y*v.y};var Rm=function(j,G,i,W){var p,s=(W.x-i.x)*(j.y-i.y)-(W.y-i.y)*(j.x-i.x),O=(G.x-j.x)*(j.y-i.y)-(G.y-j.y)*(j.x-i.x),d=(W.y-i.y)*(G.x-j.x)-(W.x-i.x)*(G.y-j.y);if(0!=d){var H=s/d,z=O/d;H>=0&&1>=H&&z>=0&&1>=z?(p=new $o(h),p.points.push(new tk(j.x+H*(G.x-j.x),j.y+H*(G.y-j.y)))):p=new $o(X)}else p=0==s||0==O?new $o("C"):new $o("P");return p},gq=function(G,s,u,l,K){var z,r,E,i,T,J,m,O=l.min(K),w=l.max(K),Z=new $o(X);z=s.$55l(-2),E=G.add(z.add(u)),z=G.$55l(-2),r=s.$55l(2),i=z.add(r),T=new tk(G.x,G.y),m=new uc(l.y-K.y,K.x-l.x),J=l.x*K.y-K.x*l.y;for(var n=new ic(m.$60l(E),m.$60l(i),m.$60l(T)+J).$51l(),W=0;W<n.length;W++){var x=n[W];if(x>=0&&1>=x){var _=G.lerp(s,x),j=s.lerp(u,x),S=_.lerp(j,x);l.x==K.x?O.y<=S.y&&S.y<=w.y&&(Z.$62l=h,Z.$56l(S)):l.y==K.y?O.x<=S.x&&S.x<=w.x&&(Z.$62l=h,Z.$56l(S)):S.gte(O)&&S.lte(w)&&(Z.$62l=h,Z.$56l(S))}}return Z},Ng=function(I,j,g,m,Q){var _=m.min(Q),F=m.max(Q),M=new tk(F.x,_.y),E=new tk(_.x,F.y),t=gq(I,j,g,_,M),R=gq(I,j,g,M,F),x=gq(I,j,g,F,E),i=gq(I,j,g,E,_),p=new $o(X);return p.$57l(t.points),p.$57l(R.points),p.$57l(x.points),p.$57l(i.points),p.points.length>0&&(p.$62l=h),p},Id=function(l,F,p,r,B,H){var e,Q,J,n,y,K,I,o,O,d,A=B.min(H),M=B.max(H),T=new $o(X);e=l.$55l(-1),Q=F.$55l(3),J=p.$55l(-3),n=e.add(Q.add(J.add(r))),y=new uc(n.x,n.y),e=l.$55l(3),Q=F.$55l(-6),J=p.$55l(3),n=e.add(Q.add(J)),K=new uc(n.x,n.y),e=l.$55l(-3),Q=F.$55l(3),J=e.add(Q),I=new uc(J.x,J.y),o=new uc(l.x,l.y),d=new uc(B.y-H.y,H.x-B.x),O=B.x*H.y-H.x*B.y;for(var t=new ic(d.$60l(y),d.$60l(K),d.$60l(I),d.$60l(o)+O).$51l(),i=0;i<t.length;i++){var C=t[i];if(C>=0&&1>=C){var Y=l.lerp(F,C),N=F.lerp(p,C),L=p.lerp(r,C),W=Y.lerp(N,C),z=N.lerp(L,C),R=W.lerp(z,C);B.x==H.x?A.y<=R.y&&R.y<=M.y&&(T.$62l=h,T.$56l(R)):B.y==H.y?A.x<=R.x&&R.x<=M.x&&(T.$62l=h,T.$56l(R)):R.gte(A)&&R.lte(M)&&(T.$62l=h,T.$56l(R))}}return T},Db=function(s,U,w,R,t,o){var G=t.min(o),H=t.max(o),J=new tk(H.x,G.y),W=new tk(G.x,H.y),l=Id(s,U,w,R,G,J),v=Id(s,U,w,R,J,H),F=Id(s,U,w,R,H,W),Q=Id(s,U,w,R,W,G),z=new $o(X);return z.$57l(l.points),z.$57l(v.points),z.$57l(F.points),z.$57l(Q.points),z.points.length>0&&(z.$62l=h),z},Uh=function(p,e,Z,z){var w=Z.min(z),C=Z.max(z),D=new tk(C.x,w.y),Q=new tk(w.x,C.y),G=Rm(w,D,p,e),q=Rm(D,C,p,e),Y=Rm(C,Q,p,e),A=Rm(Q,w,p,e),v=new $o(X);return v.$57l(G.points),v.$57l(q.points),v.$57l(Y.points),v.$57l(A.points),v.points.length>0&&(v.$62l=h),v},km=c.XEditInteractor=function($){var Y=this,f=Y._view=document.createElement("canvas");f.className="editCanvas",f.style.position="absolute",km.superClass.constructor.call(Y,$)};G.def(km,c.Interactor,{ms_edit:1,setUp:function(){var F=this,z=F.gv,l=z.getView(),Q=F._view;km.superClass.setUp.call(F),z.setEditInteractor(F),z.$14l=Q,z._79O?l.insertBefore(Q,z._79O):l.appendChild(Q);var e=F.$49l=F.$11l.bind(F);z.dm().md(e),z.sm().ms(e),z.mp(e)},tearDown:function(){var B=this,U=B.gv,R=U.getView(),i=B.$49l;km.superClass.tearDown.call(B),U.setEditInteractor(d),U.$14l=d,R.removeChild(B._view),U.dm().umd(i),U.sm().ums(i),U.ump(i)},clear:function(){var t=this,u=t.gv;delete t._hoverSegmentIndex,delete t._edge,delete t._shape,delete u._editing,delete t.$10l,delete t.$13l,delete t.$9l,delete t._removePointIndex,delete t._lp,t.$12l="",delete t.$40l,delete t.$67l,delete t.$72l,delete t.$73l,delete t.$75l,delete t.$1l,delete t.$3l,delete t.$2l,delete t.$92l,delete t.$93l,delete t.$94l,t.clearDragging()},handle_keydown:function(u){this.$48l!==u.shiftKey&&(this.$48l=u.shiftKey,this.handle_mousemove(u,f,!0))},handle_keyup:function(w){this.$48l!==w.shiftKey&&(this.$48l=w.shiftKey,this.handle_mousemove(w,f,!0))},handle_touchstart:function(x){this.handle_mousemove(x),this.handle_mousedown(x)},handle_mousedown:function(o){r(o);var d=this,i=d.$13l,w=d.gv,v=w.dm(),n=w.sm(),y=w.getZoom(),Z=w.lp(o),N=G.isDoubleClick(o),h=G.isLeftButton(o),S=d.$7l,K=d._shape,g=d._hoverSegmentIndex,H=d._edge,U=d.$87l,F=d.$88l,j=function(){d._68I||U===d.$87l&&F===d.$88l||d.$43l()};if(7!==d.$67l&&(delete d.$87l,delete d.$88l),h&&(K||H)&&g>=0&&N&&(K&&n.contains(K)||H&&n.contains(H))){var O=Nc.call(d,K||H,g,Z);return d.addShapePoint(K||H,g,O),R(function(){d.handle_mousemove(o)},40),void 0}if(h&&(K||H)&&d._removePointIndex>=0&&N)return d.removeShapePoint(),d.$5l=1,R(function(){d.handle_mousemove(o)},40),void 0;if(!h||!w._editing)return j(),void 0;if(K&&i>=0){var Q=K.getPoints().get(i),I=K.p(),f=cp(I,Q.x-I.x,Q.y-I.y,-S+K.getRotation());p=cp(I,Z.x-I.x,Z.y-I.y,-S),d.$24l={x:p.x-f.x,y:p.y-f.y},d.startDragging(o),v.beginTransaction(),d.fi({kind:"beginEditPoint",event:o,data:K,index:i}),d.$88l=i,d.$87l=K}else if(d.$10l){var b=w.sm().getSelection(),D=d.$6l,X=d.$1l={},P=d.$3l={},M=d.$16l[e[d.$10l]],C={x:D.x,y:D.y},c={x:D.x+D.width/2,y:D.y+D.height/2};d.$24l={x:Z.x-M.x/y,y:Z.y-M.y/y},d.$2l=u(d.$8l),d.$4l=u(D),b.each(function(y){if(y instanceof W){var G=y.p(),o=y.getWidth(),j=y.getHeight(),g=cp(c,G.x-c.x,G.y-c.y,-S);X[y.getId()]={x:G.x-o/2,y:G.y-j/2,width:o,height:j},P[y.getId()]={x:(g.x-C.x)/D.width,y:(g.y-C.y)/D.height}}}),d.startDragging(o),v.beginTransaction(),d.fi({kind:"beginEditRect",event:o,direction:d.$10l})}else if(H&&i>=0){var L=Io(w.getDataUI(H),H.s("edge.points")),Q=L.get(i);d.$24l={x:Z.x-Q.x,y:Z.y-Q.y},d.startDragging(o),v.beginTransaction(),d.fi({kind:"beginEditPoint",event:o,data:H,index:i}),d.$88l=i,d.$87l=H}else if(d.$40l){var D=d.$6l,c={x:D.x+D.width/2,y:D.y+D.height/2},l=u(d.$23l);l.x/=y,l.y/=y;var x=cp(c,l.x-c.x,l.y-c.y,-S),p=cp(c,Z.x-c.x,Z.y-c.y,-S);d.$24l={x:p.x-x.x,y:p.y-x.y},d.startDragging(o),v.beginTransaction(),d.fi({kind:"beginEditRotation",event:o,data:d._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(d.$67l)>=0){var m=d.$67l;(7===m||8===m||9===m)&&v.beginTransaction(),d.startDragging(o)}else if(d.$71l&&N&&d.$79l(d.$71l,Z)){var $=n.toSelection();v.beginTransaction(),$.each(function(f){v.remove(f)}),v.endTransaction()}j()},$11l:function(){var Q=this,s=Q.gv;s._editing&&(Q.$13l==d||Q._shape==d&&Q._edge==d)&&(Q.$73l==d||1!==Q.$67l&&5!==Q.$67l&&6!==Q.$67l)||(Q.$5l=1),Q._68I=1},$46l:function(q){var N=this,z=N.gv,g=z.lp(q),T=[];return Xo(z,function(d){var I=z.getDataUI(d);if(I){var W=I._79o();m(W,g)&&T.push(d)}}),T},$47l:function(y){var w=this,p=w.$13l,U=w.gv.dm();w.$10l?(w.fi({kind:"endEditRect",event:y,direction:w.$10l}),U.endTransaction()):w._shape&&p>=0?(w.fi({kind:"endEditPoint",event:y,data:w._shape,index:p}),U.endTransaction()):w._edge&&p>=0?(w.fi({kind:"endEditPoint",event:y,data:w._edge,index:p}),U.endTransaction()):w.$23l&&w.$40l&&(w.fi({kind:"endEditRotation",event:y}),U.endTransaction())},handleWindowTouchEnd:function(e){this.handleWindowMouseUp(e)},handleWindowMouseUp:function(v){var Q=this,m=Q.gv,J=m.dm(),u=Q._shape,G=Q._edge,T=Q.$13l,c=Q.$40l,t=Q.$9l,n=Q.$10l,M=Q.$67l;if((u||G)&&T>=0&&t>=0){var $,S;if(u){var O=u.p(),r=u.getRotation();$=u.getPoints(),S=$.get(t),pk(u,O,r,T,S,!1)}else if($=Io(m.getDataUI(G),G.s("edge.points"),!0),S=$.get(t),0===T){var z=$.get(0);G.s("edge.source.offset.x",S.x-z.x),G.s("edge.source.offset.y",S.y-z.y)}else if(T===$.size()-1){var s=$.get($.size()-1);G.s("edge.target.offset.x",S.x-s.x),G.s("edge.target.offset.y",S.y-s.y)}else"points"===G.s("edge.type")&&($.set(T,S),G.s("edge.points",eq($)))}Q.$47l(v);var A=Q.$73l;1===M?(J.beginTransaction(),A?m.sm().each(function(C){if(C.setHost&&m.isHelperEditable(C,"host")){C.setHost(A);
var g=Q.$75l,L=Q.$74l;g&&(C.s("attach.row.index",g.rowIndex),C.s("attach.column.index",g.columnIndex)),L&&(C.s("attach.index",L.attachIndex),C.s("attach.offset",L.attachOffset),C.s("attach.offset.relative",!1),C.s("attach.offset.opposite",!1))}}):m.sm().each(function(F){F.setHost&&m.isHelperEditable(F,"host")&&(F.setHost(d),F.s("attach.row.index",f),F.s("attach.column.index",f),F.s("attach.index",f),F.s("attach.offset",f),F.s("attach.offset.relative",!1),F.s("attach.offset.opposite",!1))}),J.endTransaction()):2===M?(J.beginTransaction(),A?m.sm().each(function(k){k.setParent&&m.isHelperEditable(k,"parent")&&k.setParent(A)}):m.sm().each(function(P){P.setParent&&m.isHelperEditable(P,"parent")&&P.setParent(d)}),J.endTransaction()):3===M?A&&(J.beginTransaction(),m.sm().each(function(O){if(m.isHelperEditable(O,"edge")&&O instanceof W&&A instanceof W){var a=new Z.Edge;J.add(a),a.setSource(O),a.setTarget(A),Q.onEdgeCreated&&Q.onEdgeCreated(v,a)}}),J.endTransaction()):5===M||6===M?A&&(J.beginTransaction(),m.sm().each(function(s){s instanceof P&&A instanceof W&&(5===M&&m.isHelperEditable(s,"source")?s.setSource(A):6===M&&m.isHelperEditable(s,"source")&&s.setTarget(A))}),J.endTransaction()):(7===M||8===M||9===M)&&J.endTransaction(),(n||c)&&Q.$43l(!0),i?(Q.clear(),delete Q.$64l,Q._68I||Q.$43l()):(Q.handle_mousemove(v,!0),M&&!Q._68I&&Q.$43l())},handleWindowTouchMove:function(_){this.handleWindowMouseMove(_)},handleWindowMouseMove:function(v){this._78I(v)},handle_mousemove:function(c,T,y){if(!this._pause){if(!y){var N=i?Dj(c):c;this.$61l={clientX:N.clientX,clientY:N.clientY}}if(T===!0||!H()){var s=this,Z=s.gv,D=!1,I=d;s.clear(),Z.sm().size()>0&&(I=Z.lp(y?s.$61l:c),D=s._79I(c,I)),D&&(Z._editing=1),s.$12l!==s.$65l&&(s.$65l=s.$12l,s.setCursor(s.$12l)),s.$40l!==s.$64l&&(s.$64l=s.$40l,s._68I||s.$43l()),s._hoverSegmentIndex!==s.$66l&&(s.$66l=s._hoverSegmentIndex,s._68I||s.$43l())}}},_78I:function(Q){this.autoScroll(Q);var N=this,M=N.gv,z=M.lp(Q),i=M.getZoom(),V=N.$13l;if((N._shape||N._edge)&&V>=0){var l,c,I,s=N._shape,X=N._edge,_=N.$24l,j=M.getPointSnapSpacing(),T=function(P,p){return j==d||isNaN(j)?{x:P,y:p}:{x:J(P/j)*j,y:J(p/j)*j}};if(s){l=s.getPoints();var o=s.p(),$=s.getRotation(),f=0;c=cp(o,z.x-o.x,z.y-o.y,-$),pk(s,o,$,V,z,!0,_,T),N.fi({kind:"betweenEditPoint",event:Q,data:s,index:V})}else if(X){l=Io(M.getDataUI(X),X.s("edge.points"),!0),z.x-=_.x,z.y-=_.y,c=z;var e,F,m=X.s("edge.offset"),q=l.size(),y=q>2;if(0===V){var Y=l.get(0);m&&(Y=kk(Y,l.get(1),-m,y),z=kk(z,l.get(1),-m,y)),e=z.x-Y.x,F=z.y-Y.y,I=T(e,F),X.s("edge.source.offset.x",I.x),X.s("edge.source.offset.y",I.y)}else if(V===q-1){var C=l.get(q-1);m&&(C=kk(C,l.get(q-2),-m,y),z=kk(z,l.get(q-2),-m,y)),e=z.x-C.x,F=z.y-C.y,I=T(e,F),X.s("edge.target.offset.x",I.x),X.s("edge.target.offset.y",I.y)}else"points"===X.s("edge.type")&&(I=T(z.x,z.y),I.e=l.get(V).e,l.set(V,I),X.s("edge.points",eq(l)));N.fi({kind:"betweenEditPoint",event:Q,data:X,index:V})}if(delete N.$9l,M.isSnapPoint(s)||M.isSnapPoint(X))for(f=0;f<l.size();f++)if(f!==V){var k=l.get(f);if(S(k,c)<M.getEditPointSize()/i){N.$9l=f;break}}}else if(N.$10l){var _=N.$24l;z.x-=_.x,z.y-=_.y;var w=M.sm().getSelection(),b=N.$1l,H=N.$7l,x=N.$10l,Z=N.$4l,U=N.$2l,u=M.getEditRectPadding()/i,O=2*u,v=M.getSnapSpacing(),p=v!=d&&!isNaN(v),h=Ln(U,z,x,H,2*u,M.getResizeMode(),p,!0),a=N.$6l;if(p){var E=h.width-O,r=h.height-O,g=J(E/v)*v,vd=J(r/v)*v,rq=g-E,wm=vd-r;("west"===x||"northwest"===x||"southwest"===x)&&(rq=-rq),("north"===x||"northwest"===x||"northeast"===x)&&(wm=-wm),h=Ln(U,z,x,H,2*u,M.getResizeMode(),p,!1,rq,wm)}N.$8l=h,a.x=h.x+u,a.y=h.y+u,a.width=h.width-O,a.height=h.height-O;var ak=h.x+h.width/2,fp=h.y+h.height/2,Lo=a.x,ro=a.y,_e=a.width/Z.width,Db=a.height/Z.height;w.each(function(t){if(t instanceof W&&M.isEditable(t)&&M.isRectEditable(t)){var E=b[t.getId()],B=N.$3l[t.getId()],P={x:E.x+E.width/2,y:E.y+E.height/2},l=0,Q=0,J=x,p=180*A(H-t.getRotation())/L;"northeast"===x?p>=315||45>p?(l=E.width*_e+E.x,Q=E.height*(1-Db)+E.y,J="northeast"):p>=45&&135>p?(l=E.width*(1-Db)+E.x,Q=E.height*(1-_e)+E.y,J="northwest"):p>=135&&225>p?(l=E.width*(1-_e)+E.x,Q=E.height*Db+E.y,J="southwest"):(l=E.width*Db+E.x,Q=E.height*_e+E.y,J="southeast"):"north"===x?p>=315||45>p?(Q=E.height*(1-Db)+E.y,J="north"):p>=45&&135>p?(l=E.width*(1-Db)+E.x,J="west"):p>=135&&225>p?(Q=E.height*Db+E.y,J="south"):(l=E.width*Db+E.x,J="east"):"northwest"===x?p>=315||45>p?(l=E.width*(1-_e)+E.x,Q=E.height*(1-Db)+E.y,J="northwest"):p>=45&&135>p?(l=E.width*(1-Db)+E.x,Q=E.height*_e+E.y,J="southwest"):p>=135&&225>p?(l=E.width*_e+E.x,Q=E.height*Db+E.y,J="southeast"):(l=E.width*Db+E.x,Q=E.height*(1-_e)+E.y,J="northeast"):"west"===x?p>=315||45>p?(l=E.width*(1-_e)+E.x,J="west"):p>=45&&135>p?(Q=E.height*_e+E.y,J="south"):p>=135&&225>p?(l=E.width*_e+E.x,J="east"):(Q=E.height*(1-_e)+E.y,J="north"):"southwest"===x?p>=315||45>p?(l=E.width*(1-_e)+E.x,Q=E.height*Db+E.y,J="southwest"):p>=45&&135>p?(l=E.width*Db+E.x,Q=E.height*_e+E.y,J="southeast"):p>=135&&225>p?(l=E.width*_e+E.x,Q=E.height*(1-Db)+E.y,J="northeast"):(l=E.width*(1-Db)+E.x,Q=E.height*(1-_e)+E.y,J="northwest"):"east"===x?p>=315||45>p?(l=E.width*_e+E.x,J="east"):p>=45&&135>p?(Q=E.height*(1-_e)+E.y,J="north"):p>=135&&225>p?(l=E.width*(1-_e)+E.x,J="west"):(Q=E.height*_e+E.y,J="south"):"south"===x?p>=315||45>p?(Q=E.height*Db+E.y,J="south"):p>=45&&135>p?(l=E.width*Db+E.x,J="east"):p>=135&&225>p?(Q=E.height*(1-Db)+E.y,J="north"):(l=E.width*(1-Db)+E.x,J="west"):"southeast"===x&&(p>=315||45>p?(l=E.width*_e+E.x,Q=E.height*Db+E.y,J="southeast"):p>=45&&135>p?(l=E.width*Db+E.x,Q=E.height*(1-_e)+E.y,J="northeast"):p>=135&&225>p?(l=E.width*(1-_e)+E.x,Q=E.height*(1-Db)+E.y,J="northwest"):(l=E.width*(1-Db)+E.x,Q=E.height*_e+E.y,J="southwest"));var Y=cp(P,l-P.x,Q-P.y,t.getRotation());Gp(t,E,J,{x:Y.x,y:Y.y});var X=Lo+a.width*B.x,K=ro+a.height*B.y,D={x:X,y:K};D=cp({x:ak,y:fp},D.x-ak,D.y-fp,H),t.p(D.x,D.y)}}),N.fi({kind:"betweenEditRect",event:Q,direction:x})}else if(N.$23l&&N.$40l){var nd=N.$8l,Re=nd.width,Ue=nd.height,o={x:nd.x+Re/2,y:nd.y+Ue/2},_=N.$24l,le=N.$23l,Xr=le.x/i-o.x,Im=le.y/i-o.y,wr=B(Xr*Xr+Im*Im),Ag=Math.asin(_.x/wr),zs=M.sm().getSelection(),zq=n+K(z.y-o.y,z.x-o.x)-Ag,ve=M.getSnapAngle(),zq=J(zq/ve)*ve;0>zq&&(zq+=D);var Yn=zq-N.$7l,Iq=[o.x,0,o.y];zs.each(function(n){if(M.isEditable(n)&&M.isRotationEditable(n)&&M.isVisible(n)){var h=si(n.p3(),Iq),G=Tj();_o(G,-Yn),n.setRotation(n.getRotation()+Yn),mg(h,G),n.p3(Iq[0]+h[0],Iq[1]+h[1],Iq[2]+h[2])}}),N.$7l=zq,N.fi({kind:"betweenEditRotation",event:Q})}else if([1,2,3,5,6].indexOf(N.$67l)>=0)N.$72l=Q,N.$78l||(N.$78l=1,R(function(){G.isDragging()&&N.$43l(),delete N.$78l},12));else if(7===N.$67l){if(N.$87l instanceof t){var s=N.$87l,Mf=N.$88l,bg=G.clone(s.getPoints().get(Mf)),Od=z.y-bg.y;bg.e||(bg.e=0),N.$92l||(N.$92l=bg.e),bg.e=N.$92l-Od,s.setPoint(Mf,bg)}else if(N.$87l instanceof P){var X=N.$87l,Mf=N.$88l,l=Io(M.getDataUI(X),X.s("edge.points")),bg=l.get(Mf),Od=z.y-bg.y;bg.e||(bg.e=0),N.$92l||(N.$92l=bg.e),bg.e=N.$92l-Od,l.set(Mf,bg),X.s("edge.points",eq(l))}}else if(8===N.$67l){var zs=M.sm().getSelection(),Zr=N.$93l;Zr||(Zr=N.$93l={}),zs.each(function(I){if(I.p3){var a=I.p3(),T=Zr[I.getId()];T==d&&(T=Zr[I.getId()]=a[1]),I.p3([a[0],T-(z.y-N.$90l.y/i),a[2]])}})}else if(9===N.$67l){var zs=M.sm().getSelection(),kh=N.$94l;kh||(kh=N.$94l={}),zs.each(function(W){if(W.s3){var $=W.s3(),E=kh[W.getId()];E==d&&(E=kh[W.getId()]=$[1]);var Z=E-(z.y-N.$91l.y/i);0>Z&&(Z=.01),W.s3([$[0],Z,$[2]])}})}},$79l:function(o,S){var t=this,D=t.gv,v=D.getZoom(),M=D.getEditHelperSize(),_=o.x/v,Y=o.y/v,R=M/v,e=R/2;return m({x:_-e,y:Y-e,width:R,height:R},S)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(U,k){for(var F=this,A=F.gv,n=A.getZoom(),r=A.getEditPointSize(),y=r/n,G=y/2,C=F.$46l(U),w=0;w<C.length;w++){var X,u,L=C[w],Q=A.getDataUI(L);if(Q&&Q._55O){var R=Q._55O;if(R._43O&&L instanceof P){if(X=L.s("edge.points"),X=Io(Q,X),u=L.s("edge.segments"),u&&u.size()||(u=bl(X)),F.$42l(L,k,X._as,u,"edge"))return!0;if("points"===L.s("edge.type"))return F.$41l(L,k,X._as,u,"edge"),void 0}if(R._43O&&L instanceof t&&R.$15l&&R.$15l.length===L.getPoints().size()){if(X=R.$15l,u=L.getSegments(),u&&u.size()||(u=bl(X)),F.$42l(L,k,X,u,"shape"))return!0;if(F.$41l(L,k,X,u,"shape"))return}}}if(F.$16l){var X,h=F.$16l,H=h[3].x-h[7].x,J=h[3].y-h[7].y,$=B(H*H+J*J),z=h[1].x-h[5].x,W=h[1].y-h[5].y,Z=B(z*z+W*W),Y={x:k.x*n,y:k.y*n};if(F._80I(Y,0,h[0],"northwest",$,Z)||F._80I(Y,1,h[1],"north",$,Z)||F._80I(Y,2,h[2],"northeast",$,Z)||F._80I(Y,7,h[7],"west",$,Z)||F._80I(Y,3,h[3],"east",$,Z)||F._80I(Y,6,h[6],"southwest",$,Z)||F._80I(Y,5,h[5],"south",$,Z)||F._80I(Y,4,h[4],"southeast",$,Z))return!0}if(F.$23l){var c=F.$23l,p=c.x/n,K=c.y/n;if(m({x:p-G,y:K-G,width:y,height:y},k))return F.$40l=1,F.$12l=F.getHelperCursor("rotation")||"crosshair",!0}return F.$68l&&F.$79l(F.$68l,k)?(F.$67l=1,F.$12l=F.getHelperCursor("host")||"crosshair",!0):F.$69l&&F.$79l(F.$69l,k)?(F.$67l=2,F.$12l=F.getHelperCursor("parent")||"crosshair",!0):F.$70l&&F.$79l(F.$70l,k)?(F.$67l=3,F.$12l=F.getHelperCursor("edge")||"crosshair",!0):F.$71l&&F.$79l(F.$71l,k)?(F.$67l=4,F.$12l=F.getHelperCursor("remove")||"crosshair",!0):F.$82l&&F.$79l(F.$82l,k)?(F.$67l=5,F.$12l=F.getHelperCursor("source")||"crosshair",!0):F.$83l&&F.$79l(F.$83l,k)?(F.$67l=6,F.$12l=F.getHelperCursor("target")||"crosshair",!0):F._pointElevationHelperPoint&&F.$79l(F._pointElevationHelperPoint,k)?(F.$67l=7,F.$12l=F.getHelperCursor("pointElevation")||"crosshair",!0):F.$90l&&F.$79l(F.$90l,k)?(F.$67l=8,F.$12l=F.getHelperCursor("elevation")||"crosshair",!0):F.$91l&&F.$79l(F.$91l,k)?(F.$67l=9,F.$12l=F.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(R,e,n,g,l,I){var P=this,c=P.gv,J=c.getEditPointSize(),T=J/2,Q=c.sm(),H=c.isDirectionEditable;if(H&&1===Q.size()){var r=Q.ld();if(H=H.bind(c),r instanceof W){if(!H(r,g))return!1;if("east"===g){if(H(r,"northeast")&&H(r,"southeast")&&2*J>=I)return!1}else if("west"===g){if(H(r,"northwest")&&H(r,"southwest")&&2*J>=I)return!1}else if("north"===g){if(H(r,"northwest")&&H(r,"northeast")&&2*J>=l)return!1}else if("south"===g&&H(r,"southwest")&&H(r,"southeast")&&2*J>=l)return!1}}else{if(2*J>=l&&("north"===g||"south"===g))return!1;if(2*J>=I&&("east"===g||"west"===g))return!1}if(m({x:n.x-T,y:n.y-T,width:J,height:J},R)){if(P.$10l!==g){var Y=180*P.$7l/L,O="";Y>=337.5||22.5>Y?O="north":Y>=22.5&&67.5>Y?O="northeast":Y>=67.5&&112.5>Y?O="east":Y>=112.5&&157.5>Y?O="southeast":Y>=157.5&&202.5>Y?O="south":Y>=202.5&&247.5>Y?O="southwest":Y>=247.5&&292.5>Y?O="west":Y>=292.5&&337.5>Y&&(O="northwest");var p=Jn.indexOf(O),O=Jn[e-(1-p)+8];switch(O){case"northwest":P.$12l="nwse-resize";break;case"northeast":P.$12l="nesw-resize";break;case"southwest":P.$12l="nesw-resize";break;case"southeast":P.$12l="nwse-resize";break;case"north":P.$12l="ns-resize";break;case"east":P.$12l="ew-resize";break;case"south":P.$12l="ns-resize";break;case"west":P.$12l="ew-resize"}P.$10l=g}return!0}return!1},$42l:function(p,Q,S,q,D){var k,R=this,e=R.gv,H=e.getEditPointSize(),u=H/e.getZoom(),C=-1,B={x:Q.x,y:Q.y,width:0,height:0},i=function(l){"shape"===D?R._shape=p:R._edge=p,R._removePointIndex=l},K=function(T){"shape"===D?R._shape=p:R._edge=p,R.$13l=T,R.$12l="crosshair"};for(F(B,u/2),C=S.length-1,k=q.size()-1;k>=0;k--){var s=q.get(k);if(1===s||2===s)C-=1;else if(3===s){var L=S[C-1];if(m(B,L))return K(C-1),!0;C-=2}else if(4===s){var V=S[C-1],T=S[C-2];if(m(B,V))return K(C-1),!0;if(m(B,T))return K(C-2),!0;C-=3}}for(C=S.length-1,k=q.size()-1;k>=0;k--){var s=q.get(k),A=S[C];if(m(B,A))return i(C),K(C),!0;1===s||2===s?C-=1:3===s?C-=2:4===s&&(C-=3)}return!1},$41l:function(H,W,Z,j,B){var u=this,r=u.gv,Y=-1,g=0,y={x:W.x,y:W.y,width:0,height:0},U=function(r,G){u._hoverSegmentIndex=G,u._lp=W,"shape"===B?u._shape=H:u._edge=H};for(F(y,r.getSegmentHoverWidth()/2/r.getZoom()),H instanceof t&&H.isClosePath()&&j.indexOf(5)<0&&(j=new x(j._as),j.add(5));g<j.size();g++){var f=j.get(g);if(1===f){var k=Z[Y],A=Z[Y+1];if(k){var V=Uh(new tk(k.x,k.y),new tk(A.x,A.y),new tk(y.x,y.y),new tk(y.x+y.width,y.y+y.height));if(V.$62l===h&&V.points.length>0)return U(V,g),!0}Y+=1}else if(2===f){var k=Z[Y],A=Z[Y+1],V=Uh(new tk(k.x,k.y),new tk(A.x,A.y),new tk(y.x,y.y),new tk(y.x+y.width,y.y+y.height));if(V.$62l===h&&V.points.length>0)return U(V,g),!0;Y+=1}else if(3===f){var k=Z[Y],c=Z[Y+1],L=Z[Y+2],V=Ng(new tk(k.x,k.y),new tk(c.x,c.y),new tk(L.x,L.y),new tk(y.x,y.y),new tk(y.x+y.width,y.y+y.height));if(V.$62l===h)return U(V,g),!0;Y+=2}else if(4===f){var k=Z[Y],E=Z[Y+1],C=Z[Y+2],L=Z[Y+3],V=Db(new tk(k.x,k.y),new tk(E.x,E.y),new tk(C.x,C.y),new tk(L.x,L.y),new tk(y.x,y.y),new tk(y.x+y.width,y.y+y.height));if(V.$62l===h)return U(V,g),!0;Y+=3}else if(5===f){var k=Z[Y],A=Z[0];if(k){var V=Uh(new tk(k.x,k.y),new tk(A.x,A.y),new tk(y.x,y.y),new tk(y.x+y.width,y.y+y.height));if(V.$62l===h&&V.points.length>0)return U(V,g),!0}}}return!1},addShapePoint:function(J,r,K){var l=this,z=l.gv,j=z.dm();if(j.beginTransaction(),0===arguments.length&&(J=l._shape||l._edge,r=l._hoverSegmentIndex,K=l._lp),J instanceof t||J instanceof P){var s=ri(J,z.getDataUI(J),r);if(!isNaN(r)&&K&&!isNaN(s)){var Q=K;if(J instanceof t){var o=J.p(),w=J.getRotation(),M=J.toSegments();M&&M.size()||(M=bl(J.getPoints())),J.isClosePath()&&M.indexOf(5)<0&&(M=new x(M._as),M.add(5));var V=M.get(r),e="addPoint",b="removePointAt";if(2===V||1===V){var c={x:Q.x,y:Q.y};M.add(V,r),c=cp(o,c.x-o.x,c.y-o.y,-w),J[e](c,s+1)}else if(3===V){var G=J.getPoints(),a=G.get(s),Y=G.get(s+2),c={x:Q.x,y:Q.y};c=cp(o,c.x-o.x,c.y-o.y,-w);var R=Nd(a,c),I=Nd(c,Y);M.removeAt(r),M.add(3,r),M.add(3,r),J.setPoint(s+1,c),J[e](I,s+2),J[e](R,s+1)}else if(4===V){var G=J.getPoints(),a=G.get(s),Y=G.get(s+3),c={x:Q.x,y:Q.y};c=cp(o,c.x-o.x,c.y-o.y,-w);var R=gn(a,c),I=iq(a,c),y=gn(c,Y),C=iq(c,Y);M.removeAt(r),M.add(4,r),M.add(4,r),J[b](s+1),J[b](s+1),J[e](c,s+1),J[e](C,s+2),J[e](y,s+2),J[e](I,s+1),J[e](R,s+1)}else if(5===V){var c={x:Q.x,y:Q.y};M.add(2,r),c=cp(o,c.x-o.x,c.y-o.y,-w),J[e](c,s+1)}J.isClosePath()&&M.remove(5),J.setSegments(M);var h=J.getWidth(),W=J.getHeight(),A=J.p().x-h/2,Z=J.p().y-W/2;A-=o.x,Z-=o.y;var B=Vn(J,{x:A,y:Z,width:h,height:W},w,o);J.p(B.x,B.y)}else if(J instanceof P){if("points"!==J.s("edge.type"))return j.endTransaction(),void 0;var G=J.s("edge.points");M=J.s("edge.segments"),G=Io(z.getDataUI(J),G),M&&M.size()||(M=bl(G)),M=new x(M._as.slice(0)),G=new x(G._as.slice(0));var V=M.get(r);if(2===V||1===V){var c={x:Q.x,y:Q.y};M.add(V,r),G.add(c,s+1)}else if(3===V){var a=G.get(s),Y=G.get(s+2),c={x:Q.x,y:Q.y},R=Nd(a,c),I=Nd(c,Y);M.removeAt(r),M.add(3,r),M.add(3,r),G.set(s+1,c),G.add(I,s+2),G.add(R,s+1)}else if(4===V){var a=G.get(s),Y=G.get(s+3),c={x:Q.x,y:Q.y},R=gn(a,c),I=iq(a,c),y=gn(c,Y),C=iq(c,Y);M.removeAt(r),M.add(4,r),M.add(4,r),G.removeAt(s+1),G.removeAt(s+1),G.add(c,s+1),G.add(C,s+2),G.add(y,s+2),G.add(I,s+1),G.add(R,s+1)}J.s("edge.points",eq(G)),J.s("edge.segments",M)}}}j.endTransaction()},removeShapePoint:function(h,Z){var B=this,$="removeAt",o=B.gv,u=o.dm();if(u.beginTransaction(),0===arguments.length&&(h=B._shape||B._edge,Z=B._removePointIndex),Z>=0&&(h instanceof t||h instanceof P)){var D=kq(h,B.gv.getDataUI(h),Z),T=Z;if(h instanceof t){var j=h.p(),X=h.toSegments();X&&X.size()||(X=bl(h.getPoints()));var d=X.get(D),i="removePointAt";if(1===d&&0===T)if(h.getPoints().size()>1){var q=X.get(D+1);X[$](D+1),3===q?h[i](T+1):4===q&&(h[i](T+2),h[i](T+1)),h[i](T)}else h.dm().remove(h);else 2===d||1===d?(X[$](D),h[i](T)):3===d?(X[$](D),h[i](T),h[i](T-1)):4===d&&(X[$](D),h[i](T),h[i](T-1),h[i](T-2));h.setSegments(X);var r=h.getWidth(),J=h.getHeight(),f=h.p().x-r/2,g=h.p().y-J/2;f-=j.x,g-=j.y;var S=Vn(h,{x:f,y:g,width:r,height:J},h.getRotation(),j);h.p(S.x,S.y)}else if(h instanceof P){if("points"!==h.s("edge.type"))return u.endTransaction(),void 0;var l=h.s("edge.points");if(X=h.s("edge.segments"),l&&(l=Io(B.gv.getDataUI(h),l),X&&X.size()||(X=bl(l))),0===Z||Z===l.size()-1)return u.endTransaction(),void 0;X=new x(X._as.slice(0)),l=new x(l._as.slice(0));var d=X.get(D);2===d||1===d?(X[$](D),l[$](T)):3===d?(X[$](D),l[$](T),l[$](T-1)):4===d&&(X[$](D),l[$](T),l[$](T-1),l[$](T-2)),h.s("edge.segments",X),h.s("edge.points",eq(l))}}u.endTransaction()},changeShapeSegment:function(b,W,c){var $=this,B=$.gv,r=B.dm();if(r.beginTransaction(),1!==arguments.length||isNaN(b)||(c=b,b=$._shape||$._edge,W=$._hoverSegmentIndex),b instanceof t||b instanceof P){var M=ri(b,$.gv.getDataUI(b),W);if(!isNaN(W)&&!isNaN(M))if(b instanceof t){var w=b.p(),U=b.toSegments();U&&U.size()||(U=bl(b.getPoints()));var a=U.get(W),C=b.toPoints();if(1===c||2===c)1===a||2===a?U.set(W,c):3===a?(U.set(W,c),C.removeAt(M+1)):4===a&&(U.set(W,c),C.removeAt(M+1),C.removeAt(M+1));else if(3===c){var n=function(){var q=C.get(M),Y=C.get(M+1),Q=Nd(q,Y);U.set(W,3),C.add(Q,M+1)};2===a||1===a?n():4===a&&(C.removeAt(M+1),C.removeAt(M+1),n())}else if(4===c){var J=function(){var y=C.get(M),u=C.get(M+1),j=gn(y,u),m=iq(y,u);U.set(W,4),C.add(j,M+1),C.add(m,M+2)};2===a||1===a?J():3===a&&(C.removeAt(M+1),J())}b.setSegments(U),b.setPoints(C);var z=b.getWidth(),u=b.getHeight(),f=b.p().x-z/2,A=b.p().y-u/2;f-=w.x,A-=w.y;var N=new Vn(b,{x:f,y:A,width:z,height:u},b.getRotation(),w);b.p(N.x,N.y)}else if(b instanceof P){if("points"!==b.s("edge.type"))return r.endTransaction(),void 0;var C=b.s("edge.points");U=b.s("edge.segments"),C&&(C=Io($.gv.getDataUI(b),C),U&&U.size()||(U=bl(C))),U=new x(U._as.slice(0)),C=new x(C._as.slice(0));var a=U.get(W);if(1===c||2===c)1===a||2===a?U.set(W,c):3===a?(U.set(W,c),C.removeAt(M+1)):4===a&&(U.set(W,c),C.removeAt(M+1),C.removeAt(M+1));else if(3===c){var n=function(){var w=C.get(M),E=C.get(M+1),G=Nd(w,E);U.set(W,3),C.add(G,M+1)};2===a||1===a?n():4===a&&(C.removeAt(M+1),C.removeAt(M+1),n())}else if(4===c){var J=function(){var V=C.get(M),X=C.get(M+1),c=gn(V,X),I=iq(V,X);U.set(W,4),C.add(c,M+1),C.add(I,M+2)};2===a||1===a?J():3===a&&(C.removeAt(M+1),J())}b.s("edge.points",eq(C)),b.s("edge.segments",U)}}r.endTransaction()},getDefaultSegments:function(g){var Y=this.gv,b=Y.getDataUI(g);if(g instanceof P){var x=g.s("edge.points");return x=Io(b,x),bl(x)}if(g instanceof t){var x=g.getPoints(),T=g.getSegments();return T&&T.size()>0?T:bl(x)}},$43l:function(e){var c=this;e&&(c.$5l=1),c._68I=1,c._42()},_42:function(){var v=this;if(v._68I){delete v._68I;var c=v.gv,A=v.$5l,l=c.getZoom(),g=c.getEditPointSize(),w=g/2,U=new x,K=v._view,f=v._edge,M=v._shape,L=K.getContext("2d"),z=c.tx(),r=c.ty(),i=d,I=c.getEditPointBackground(),H=c.getControlPointBackground(),s=c.getControlPointBorderColor(),_=c.getEditPointBorderColor(),n=c.getEditRectBorderColor(),X=c.getDirectionLineColor(),h=c.getSegmentHoverColor(),q=c.getSnapPointBorderColor(),k=c.getJoinPointBackground(),V=c.getJoinPointBorderColor(),m=c.getSegmentHoverWidth(),R=[5,5],C=c.getEditRectBorderStyle();xf(c,function(B){c.isSelected(B)&&c.isVisible(B)&&U.add(B)}),L.clearRect(0,0,y(K.width),y(K.height)),L.save(),T.translateAndScale(L,z,r,1);var p=d,a={x:0,y:0,width:0,height:0},e=0,E=0,S=0,b=0,J=0,Y=0,Nm=0,Dd=0,dr=0,Wk=0,jn=[];if(A?(delete v.$6l,delete v.$8l,delete v.$7l,delete v.$16l,delete v.$23l):(p=v.$6l,i=v.$7l),delete v.$68l,delete v.$69l,delete v.$71l,delete v.$70l,delete v.$82l,delete v.$83l,delete v._pointElevationHelperPoint,delete v.$90l,delete v.$91l,delete v.$75l,delete v.$74l,U.each(function(h){var $=c.getDataUI(h);if($){var D=$._55O;if(c.isEditable(h))D._56O&&h instanceof W&&E++,jn.push(h),D._42O&&h instanceof W&&e++,c.isHelperEditable(h,"host")&&b++,c.isHelperEditable(h,"parent")&&S++,c.isHelperEditable(h,"remove")&&J++,c.isHelperEditable(h,"edge")&&Y++,c.isHelperEditable(h,"source")&&Nm++,c.isHelperEditable(h,"target")&&Dd++,c.isHelperEditable(h,"elevation")&&dr++,c.isHelperEditable(h,"tall")&&Wk++;else if(h instanceof N&&h.isExpanded()){var F=!0,P=c.getEditableFunc();P&&(F=P(h)),F&&(c.isHelperEditable(h,"host")&&b++,c.isHelperEditable(h,"parent")&&S++,c.isHelperEditable(h,"remove")&&J++,c.isHelperEditable(h,"edge")&&Y++,c.isHelperEditable(h,"source")&&Nm++,c.isHelperEditable(h,"target")&&Dd++,c.isHelperEditable(h,"elevation")&&dr++,c.isHelperEditable(h,"tall")&&Wk++,jn.push(h))}}}),L.beginPath(),L.lineWidth=1,L.strokeStyle=c.getNodeBorderColor(),jn.forEach(function(K){var Q=c.getDataUI(K),I=Q._55O;if(A)if(i==d&&(i=K instanceof P?0:K instanceof N&&K.isExpanded()?0:K.getRotation(),v.$7l=i),p==d){var X,C,Y;if(K instanceof N&&K.isExpanded()||K instanceof P){var U=c.getDataUIBounds(K);C=U.width,Y=U.height,X={x:U.x+C/2,y:U.y+Y/2}}else X=K.p(),C=K.getWidth(),Y=K.getHeight();p={x:X.x,y:X.y,width:0,height:0},a.x=X.x-C/2,a.y=X.y-Y/2,a.width=C,a.height=Y,p=O(p,a)}else{var X,C,Y,$,M=p.x+p.width/2,r=p.y+p.height/2,_={x:M,y:r};if(K instanceof N&&K.isExpanded()||K instanceof P){$=0;var U=c.getDataUIBounds(K);C=U.width,Y=U.height,X={x:U.x+C/2,y:U.y+Y/2}}else X=K.p(),C=K.getWidth(),Y=K.getHeight(),$=K.getRotation();var s={x:X.x-C/2,y:X.y-Y/2,width:C,height:Y},f={x:s.x,y:s.y},j={x:s.x+s.width,y:s.y},J={x:s.x,y:s.y+s.height},T={x:s.x+s.width,y:s.y+s.height},f=cp(X,f.x-X.x,f.y-X.y,$),J=cp(X,J.x-X.x,J.y-X.y,$),T=cp(X,T.x-X.x,T.y-X.y,$),j=cp(X,j.x-X.x,j.y-X.y,$),n=-i,V=cp(_,f.x-_.x,f.y-_.y,n),t=cp(_,j.x-_.x,j.y-_.y,n),S=cp(_,J.x-_.x,J.y-_.y,n),Z=cp(_,T.x-_.x,T.y-_.y,n),B=o([V,t,S,Z]);p=O(p,B),p.x-=M,p.y-=r;var z=Vn(d,p,i,_);p.x=z.x-p.width/2,p.y=z.y-p.height/2}if(e>1&&c.isEditable(K)&&c.isRectEditable(K)&&K instanceof W){var y=K.getRect(),m=I.$45l,q=Co(m[0],l),k=Co(m[2],l),x=Co(m[4],l),h=Co(m[6],l);K.getRotation()?(L.moveTo(q.x,q.y),L.lineTo(k.x,k.y),L.lineTo(x.x,x.y),L.lineTo(h.x,h.y),L.lineTo(q.x,q.y)):L.rect(y.x*l,y.y*l,y.width*l,y.height*l)}}),L.stroke(),p){v.$6l=u(p),F(p,c.getEditRectPadding()/l);var Wo={x:p.x+p.width/2,y:p.y+p.height/2},yh=Up(Wo,p.width,p.height,i),nc=yh[0],hq=yh[1],up=yh[2],Bg=yh[3],qh=yh[4],Sm=yh[5],hf=yh[6],Eh=yh[7];if(nc=Co(yh[0],l),hq=Co(yh[1],l),up=Co(yh[2],l),Bg=Co(yh[3],l),qh=Co(yh[4],l),Sm=Co(yh[5],l),hf=Co(yh[6],l),Eh=Co(yh[7],l),v.$8l=p,e>0&&(v.$16l=[nc,qh,hq,Sm,Bg,hf,up,Eh],L.beginPath(),L.lineWidth=1,L.strokeStyle=n,"dashed"===C&&L.setLineDash&&L.setLineDash(R),L.moveTo(nc.x,nc.y),L.lineTo(hq.x,hq.y),L.lineTo(Bg.x,Bg.y),L.lineTo(up.x,up.y),L.lineTo(nc.x,nc.y),L.stroke(),"dashed"===C&&L.setLineDash&&L.setLineDash([])),L.beginPath(),L.lineWidth=1,L.fillStyle=I,L.strokeStyle=_,e>0){var Kb=Sm.x-Eh.x,xb=Sm.y-Eh.y,lr=B(Kb*Kb+xb*xb),se=qh.x-hf.x,rq=qh.y-hf.y,yp=B(se*se+rq*rq),xm=2*g;if(c.isDirectionEditable&&1===jn.length){var _d=jn[0],Cp=c.getDataUI(_d),Cf=Cp._55O,mi=c.isDirectionEditable.bind(c);if(Cf._42O){var kq,bh,sp,Dq;mi(_d,"northwest")&&(kq=!0,L.rect(nc.x-w,nc.y-w,g,g)),mi(_d,"northeast")&&(bh=!0,L.rect(hq.x-w,hq.y-w,g,g)),mi(_d,"southwest")&&(sp=!0,L.rect(up.x-w,up.y-w,g,g)),mi(_d,"southeast")&&(Dq=!0,L.rect(Bg.x-w,Bg.y-w,g,g)),mi(_d,"north")&&(kq&&bh?lr>xm&&L.rect(qh.x-w,qh.y-w,g,g):L.rect(qh.x-w,qh.y-w,g,g)),mi(_d,"south")&&(Dq&&sp?lr>xm&&L.rect(hf.x-w,hf.y-w,g,g):L.rect(hf.x-w,hf.y-w,g,g)),mi(_d,"west")&&(sp&&kq?yp>xm&&L.rect(Eh.x-w,Eh.y-w,g,g):L.rect(Eh.x-w,Eh.y-w,g,g)),mi(_d,"east")&&(Dq&&bh?yp>xm&&L.rect(Sm.x-w,Sm.y-w,g,g):L.rect(Sm.x-w,Sm.y-w,g,g))}}else lr>xm&&(L.rect(qh.x-w,qh.y-w,g,g),L.rect(hf.x-w,hf.y-w,g,g)),yp>xm&&(L.rect(Sm.x-w,Sm.y-w,g,g),L.rect(Eh.x-w,Eh.y-w,g,g)),L.rect(nc.x-w,nc.y-w,g,g),L.rect(hq.x-w,hq.y-w,g,g),L.rect(up.x-w,up.y-w,g,g),L.rect(Bg.x-w,Bg.y-w,g,g)}if(E>0){var Ql=v.$23l=cp(qh,0,2*-g,i);L.moveTo(Ql.x+w,Ql.y),L.arc(Ql.x,Ql.y,w,0,D,!1)}L.fill(),L.stroke(),v.$40l&&v.$44l(L,p,i);var Ck,pb,Rr=c.getLeftTopHelpers(),vn=c.getRightTopHelpers(),xc=c.getLeftBottomHelpers(),ed=c.getRightBottomHelpers(),cc=c.getEdgeHelpers(),Tp=c.getEditHelperSize(),hk=Tp/2,Jg=function(G,n,a,H){"leftTop"===n?(Ck=p.x*l-Tp-w-("h"===H?a*(Tp+w):0)-1,pb=p.y*l-Tp-w-("v"===H?a*(Tp+w):0)-1):"rightTop"===n?(Ck=(p.x+p.width)*l+w+("h"===H?a*(Tp+w):0)+1,pb=p.y*l-Tp-w-("v"===H?a*(Tp+w):0)-1):"leftBottom"===n?(Ck=p.x*l-Tp-w-("h"===H?a*(Tp+w):0)-1,pb=(p.y+p.height)*l+w+("v"===H?a*(Tp+w):0)+1):"rightBottom"===n&&(Ck=(p.x+p.width)*l+w+("h"===H?a*(Tp+w):0)+1,pb=(p.y+p.height)*l+w+("v"===H?a*(Tp+w):0)+1);var h=Ck+hk,X=pb+hk,k=(p.x+p.width/2)*l,T=(p.y+p.height/2)*l,N=cp({x:k,y:T},h-k,X-T,i);if("host"===G){if(b>0)return v.$77l(L,i,N),!0}else if("edge"===G){if(Y>0)return v.$80l(L,i,N),!0}else if("remove"===G){if(J>0)return jn&&1===jn.length&&jn[0]instanceof P?v.$81l(L,i,{x:k+Tp/2+5,y:T}):v.$81l(L,i,N),!0}else if("parent"===G){if(S>0)return jn&&1===jn.length&&jn[0]instanceof P?v.$76l(L,i,{x:k-Tp/2-5,y:T}):v.$76l(L,i,N),!0}else if("elevation"===G){if(dr>0)return v.$85l(L,i,N),!0}else if("tall"===G){if(Wk>0)return v.$86l(L,i,N),!0}else if("source"===G||"target"===G){var e=jn[0],f=c.getDataUI(e),j=rr(f,!0),R=j[0],M=j[1];if(Nm&&"source"===G)return v.$84l(L,p,R,!0,e.isLooped(),n,a,H),!0;if(Dd&&"target"===G)return v.$84l(L,p,M,!1,e.isLooped(),n,a,H),!0}};if(Rr&&Rr.length>0){var wm=0;Rr.forEach(function(r){Jg(r,"leftTop",wm,c.getLeftTopHelpersAlign()||"h")&&wm++})}if(vn&&vn.length>0){var wm=0;vn.forEach(function(k){Jg(k,"rightTop",wm,c.getRightTopHelpersAlign()||"h")&&wm++})}if(xc&&xc.length>0){var wm=0;xc.forEach(function(v){Jg(v,"leftBottom",wm,c.getLeftBottomHelpersAlign()||"h")&&wm++})}if(ed&&ed.length>0){var wm=0;ed.forEach(function(k){Jg(k,"rightBottom",wm,c.getRightBottomHelpersAlign()||"h")&&wm++})}if(cc&&cc.length>0&&((Nm||Dd)&&jn&&1===jn.length&&jn[0]instanceof P?!0:!1)){var wm=0;cc.forEach(function(j){Jg(j,"edge",wm,"h")&&wm++})}if(v.$72l){var _r,Tc=v.$67l,sl=v.$68l,Yr=v.$69l,No=(v.$71l,v.$70l),hn=v.$82l,rk=v.$83l;if(1===Tc?_r=sl:2===Tc?_r=Yr:3===Tc?_r=No:5===Tc?_r=hn:6===Tc&&(_r=rk),_r){var Gi=c.lp(v.$72l),ob=c.getDataAt(v.$72l);if(ob&&ob instanceof W){var Rq,Jj,Sf;if(v.$73l=ob,1===Tc)if(ob instanceof Z.Grid)Rq=v.$75l=ek(ob,Gi);else if(ob instanceof Z.Shape){Sf=v.$74l=wf(ob,Gi);var ws=ob.getPoints();if(Sf){var to=Sf.attachIndex,sj=ri(ob,c.getDataUI(ob),to)+1,Fc=sj+1>=ws.size()?0:sj+1,tj=ws.get(sj),xq=ws.get(Fc),Nn=ob.p(),xo=ob.getRotation();tj=cp(Nn,tj.x-Nn.x,tj.y-Nn.y,xo),xq=cp(Nn,xq.x-Nn.x,xq.y-Nn.y,xo),L.beginPath(),L.strokeStyle=h,L.lineWidth=m,L.moveTo(tj.x*l,tj.y*l),L.lineTo(xq.x*l,xq.y*l),L.stroke()}}Rq?Jj=Rq.rect:(Jj=G.clone(c.getDataUIBounds(ob)),G.grow(Jj,2)),L.beginPath(),L.rect(Jj.x*l,Jj.y*l,Jj.width*l,Jj.height*l),L.strokeStyle=1===Tc||4===Tc||6===Tc?$:Q,L.lineWidth=2,L.setLineDash&&L.setLineDash([8,8]),L.stroke()}else delete v.$73l;Gi.x=Gi.x*l,Gi.y=Gi.y*l;var Mn=dc(_r.x,_r.y,Gi.x,Gi.y),Eb=cp(_r,Gi.x-_r.x,Gi.y-_r.y,-Mn),Wg=Eb.x-_r.x;L.translate(_r.x,_r.y),L.rotate(Mn),j.width=Wg,j.height=40;var _k=Q;(1===Tc||4===Tc||6===Tc)&&(_k=$),j.comps[0].gradientColor=_k,G.drawImage(L,j,0,-20,Wg,40)}}}if(U.each(function(I){var T=c.getDataUI(I);if(T){var S,p,U=T._55O,g=T._78o;if(U&&U._43O&&I instanceof t?(S=U.$15l,p=I.getSegments(),p&&p.size()||(p=bl(S)),I.isClosePath()&&p.indexOf(5)<0&&(p=new x(p._as),p.add(5))):U&&g&&U._43O&&(S=I.s("edge.points"),p=I.s("edge.segments"),S=Io(T,S),p&&p.size()||(p=bl(S)),S&&(S=S._as)),S&&p){var R=0,W=p.size(),J=v._hoverSegmentIndex;S=S.slice(0);for(var r=0;r<S.length;r++)S[r]=Co(S[r],l);L.beginPath(),L.strokeStyle=X,L.lineWidth=1,R=0;for(var r=0;W>r;r++){var a=p.get(r);if(1===a||2===a)R++;else if(3===a){var Z=S[R-1],N=S[R],Y=S[R+1];L.moveTo(Z.x,Z.y),L.lineTo(N.x,N.y),L.lineTo(Y.x,Y.y),R+=2}else if(4===a){var Z=S[R-1],A=S[R],b=S[R+1],Y=S[R+2];L.moveTo(Z.x,Z.y),L.lineTo(A.x,A.y),L.moveTo(b.x,b.y),L.lineTo(Y.x,Y.y),R+=3}}if(L.stroke(),M===I||f===I&&"points"===f.s("edge.type")){L.beginPath(),R=0,L.strokeStyle=h,L.lineWidth=m;for(var r=0;W>r;r++){var a=p.get(r);if(1===a||2===a){if(J===r){var Z=S[R-1],Y=S[R];L.moveTo(Z.x,Z.y),L.lineTo(Y.x,Y.y);break}R++}else if(3===a){if(J===r){var Z=S[R-1],N=S[R],Y=S[R+1];L.moveTo(Z.x,Z.y),L.quadraticCurveTo(N.x,N.y,Y.x,Y.y);break}R+=2}else if(4===a){if(J===r){var Z=S[R-1],A=S[R],b=S[R+1],Y=S[R+2];L.moveTo(Z.x,Z.y),L.bezierCurveTo(A.x,A.y,b.x,b.y,Y.x,Y.y);break}R+=3}else if(5===a&&J===r){var Z=S[R-1],Y=S[0];L.moveTo(Z.x,Z.y),L.lineTo(Y.x,Y.y);break}}L.stroke()}L.beginPath(),R=0,L.strokeStyle=V,L.lineWidth=1,L.fillStyle=k;for(var r=0;W>r;r++){var a=p.get(r);if(1===a||2===a){var Y=S[R];L.moveTo(Y.x+w,Y.y),L.arc(Y.x,Y.y,w,0,D,!0),R++}else if(3===a){var Y=S[R+1];L.moveTo(Y.x+w,Y.y),L.arc(Y.x,Y.y,w,0,D,!0),R+=2}else if(4===a){var Y=S[R+2];L.moveTo(Y.x+w,Y.y),L.arc(Y.x,Y.y,w,0,D,!0),R+=3}}L.fill(),L.stroke(),L.beginPath(),R=0,L.strokeStyle=s,L.lineWidth=1,L.fillStyle=H;for(var r=0;W>r;r++){var a=p.get(r);if(1===a||2===a)R++;else if(3===a){var N=S[R];L.moveTo(N.x+w,N.y),L.arc(N.x,N.y,w,0,D,!0),R+=2}else if(4===a){var A=S[R],b=S[R+1];L.moveTo(A.x+w,A.y),L.arc(A.x,A.y,w,0,D,!0),L.moveTo(b.x+w,b.y),L.arc(b.x,b.y,w,0,D,!0),R+=3}}if(L.fill(),L.stroke(),L.beginPath(),R=0,L.strokeStyle=q,L.lineWidth=2,(M===I||f===I)&&v.$9l!=d){var Y=S[v.$9l];L.moveTo(Y.x+w,Y.y),L.arc(Y.x,Y.y,w,0,D,!0),L.stroke()}}}}),v.$87l&&c.sm().contains(v.$87l)){var Mm,Qr=v.$87l,ug=v.$88l,Tp=c.getEditHelperSize(),hk=Tp/2;if(c.isHelperEditable(Qr,"pointElevation"))if(Qr instanceof t){var Vg=Qr.getPosition();Mm=G.clone(Qr.getPoints().get(ug)),Mm=cp({x:Vg.x,y:Vg.y},Mm.x-Vg.x,Mm.y-Vg.y,Qr.getRotation()),Mm.x*=l,Mm.y*=l,L.translate(Mm.x,Mm.y),G.drawImage(L,G.getImage("xeditinteractor_elevationIcon"),hk,-hk,Tp,Tp),L.translate(-Mm.x,-Mm.y),v._pointElevationHelperPoint={x:Mm.x+Tp,y:Mm.y}}else if(Qr instanceof P){var Tj=Io(c.getDataUI(Qr),Qr.s("edge.points")),Mm=G.clone(Tj.get(ug));Mm.x*=l,Mm.y*=l,L.translate(Mm.x,Mm.y),G.drawImage(L,G.getImage("xeditinteractor_elevationIcon"),hk,-hk,Tp,Tp),L.translate(-Mm.x,-Mm.y),v._pointElevationHelperPoint={x:Mm.x+Tp,y:Mm.y}}}L.restore(),v.$5l=0}},$89l:function(g,s,z,i){g.save();var l=this,x=l.gv,Q=x.getEditHelperSize(),N=Q/2;g.beginPath(),g.translate(z.x,z.y),g.rotate(s),G.drawImage(g,i,-N,-N,Q,Q),g.restore()},$85l:function(y,u,c){var M=this;M.$90l=c,M.$89l(y,u,c,G.getImage("xeditinteractor_elevationIcon"))},$86l:function(p,J,d){var j=this;j.$91l=d,j.$89l(p,J,d,G.getImage("xeditinteractor_tallIcon"))},$77l:function(s,l,Q){var N=this;N.$68l=Q,N.$89l(s,l,Q,G.getImage("xeditinteractor_hostIcon"))},$80l:function($,W,k){var j=this;j.$70l=k,j.$89l($,W,k,G.getImage("xeditinteractor_edgeIcon"))},$81l:function(K,E,N){var h=this;h.$71l=N,h.$89l(K,E,N,G.getImage("xeditinteractor_removeIcon"))},$76l:function(S,x,i){var g=this;g.$69l=i,g.$89l(S,x,i,G.getImage("xeditinteractor_parentIcon"))},$84l:function(I,m,b,x,M){var j,f=this,S=f.gv,Q=S.getZoom(),Z=S.getEditHelperSize(),t=Z/2;b.x*=Q,b.y*=Q,M&&(x?b.x-=t+5:b.x+=t+5),b.y-=Z-2,x?(f.$82l=b,j=G.getImage("xeditinteractor_sourceIcon")):(f.$83l=b,j=G.getImage("xeditinteractor_targetIcon")),I.beginPath(),I.translate(b.x,b.y),G.drawImage(I,j,-t,-t,Z,Z),I.translate(-b.x,-b.y)},$44l:function(S,l,x){S.save();var m=this.gv.getZoom(),t=B(q(l.width,2)+q(l.height,2))/2*m+10,v=t,H=v+8,j=v+18,P=x,M=l.x+l.width/2,k=l.y+l.height/2;S.translate(M*m,k*m),S.beginPath(),S.strokeStyle="rgb(150, 150, 150)";for(var U=0,r=0,R=0,K=0,y=0,W=0;360>W;W++)U=W*L/180,0===W%5&&(r=a(U)*v,R=b(U)*v,K=a(U)*H,y=b(U)*H,S.moveTo(r,R),S.lineTo(K,y)),0===W%45&&(r=a(U)*v,R=b(U)*v,K=a(U)*j,y=b(U)*j,S.moveTo(r,R),S.lineTo(K,y));S.stroke(),S.beginPath(),S.rotate(-n),S.beginPath(),S.fillStyle="rgba(255, 0, 0, 0.1)",S.strokeStyle="rgb(157, 157, 157)",S.moveTo(0,0),S.arc(0,0,j,0,x,!1),S.fill(),S.beginPath(),S.moveTo(0+j,0),S.arc(0,0,j,0,x,!1),S.stroke(),S.rotate(n),S.font="bold 12px Verdana, Arial";var N=20*b(P),V=20*a(P),o=J(180*P/L)+"°";S.textAlign="center",S.textBaseline="middle",S.beginPath();var Z=S.measureText("365.°").width;S.fillStyle="white",S.rect(N-Z/2,-V-10,Z,20),S.fill(),S.beginPath(),S.fillStyle="rgb(79,79,79)",S.fillText(o,N,-V),S.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);