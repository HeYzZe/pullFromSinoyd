(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16595cc5","chunk-540aa64a"],{"4d3f":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-card",[o("template",{slot:"header"},[o("el-form",{attrs:{model:e.queryForm,inline:""}},[o("el-form-item",{attrs:{label:"企业名称："}},[o("el-input",{staticStyle:{width:"180px"},attrs:{clearable:"",placeholder:"企业名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onQueryList()}},model:{value:e.queryForm.psName,callback:function(t){e.$set(e.queryForm,"psName",t)},expression:"queryForm.psName"}})],1),o("el-form-item",{attrs:{label:"核定年份：",prop:"approvedYear"}},[o("el-date-picker",{staticStyle:{width:"100px"},attrs:{type:"year",format:"yyyy","value-format":"yyyy",clearable:!1,editable:!1},model:{value:e.queryForm.approvedYear,callback:function(t){e.$set(e.queryForm,"approvedYear",t)},expression:"queryForm.approvedYear"}})],1),o("el-form-item",{attrs:{label:"因子："}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.floading,expression:"floading"}],staticStyle:{width:"200px"},attrs:{multiple:"","collapse-tags":"",filterable:"",clearable:""},model:{value:e.queryForm.factorCodeList,callback:function(t){e.$set(e.queryForm,"factorCodeList",t)},expression:"queryForm.factorCodeList"}},e._l(e.select.factorList,(function(e){return o("el-option",{key:e.factorCode,attrs:{label:e.factorName,value:e.factorCode}})})),1)],1),o("el-form-item",{attrs:{label:"站点："}},[o("select-port",{directives:[{name:"loading",rawName:"v-loading",value:e.ploading,expression:"ploading"}],attrs:{width:"180px",filterable:"",options:e.select.portList,field:[{name:"psName",key:"psId"},{name:"portName",key:"id"}]},model:{value:e.queryForm.portIds,callback:function(t){e.$set(e.queryForm,"portIds",t)},expression:"queryForm.portIds"}}),o("el-button",{staticClass:"mar-l-xs",attrs:{type:"primary",icon:"fas fa-map"},on:{click:e.openTransfer}},[e._v("站 点")])],1),o("el-form-item",[o("el-checkbox",{on:{change:e.onChangeCheck},model:{value:e.queryForm.isAll,callback:function(t){e.$set(e.queryForm,"isAll",t)},expression:"queryForm.isAll"}},[e._v("全部站点")])],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",icon:"fas fa-search"},on:{click:e.onQueryList}},[e._v("查 询")])],1)],1)],1),e.isShow?o("div",{staticClass:"mar-l-sm mar-y-xs"},[o("el-button",{attrs:{type:"primary",icon:"fas fa-plus"},on:{click:e.onClickAdd}},[e._v("新 增")]),o("el-button",{attrs:{type:"danger",icon:"fas fa-trash-alt",disabled:!e.selectedIds.length},on:{click:function(t){return e.onDeleteItem()}}},[e._v("删 除\n    ")])],1):e._e(),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"","highlight-current-row":"",height:"calc(100% - 69px)",data:e.itemList},on:{"selection-change":e.onChangeSelected}},[e.isShow?o("el-table-column",{attrs:{align:"center",type:"selection",width:"37"}}):e._e(),o("el-table-column",{attrs:{align:"center",label:"No.",width:"50",type:"index",index:e.index}}),e.isShow?o("el-table-column",{attrs:{label:"操作",align:"center",width:"67"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"primary",icon:"fas fa-pencil-alt"},on:{click:function(o){return e.onClickEdit(t.row)}}},[e._v("编辑")])]}}],null,!1,2843858238)}):e._e(),o("el-table-column",{attrs:{label:"企业名称",prop:"psName","min-width":"140","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"站点名称",prop:"portName","min-width":"140","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"因子名称",prop:"factorName","min-width":"120","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"排放量",prop:"emissions","min-width":"90","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"单位",prop:"unit","min-width":"90","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"核定年份",prop:"approvedYear","min-width":"100","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"备注",prop:"remark","min-width":"180","show-overflow-tooltip":""}})],1),o("paging-query",{attrs:{pager:e.pager},on:{query:e.getItemList}}),o("dialog-form",{ref:"dialog",on:{query:e.getItemList}}),o("Transfer-port",{ref:"port",on:{getQueryData:e.getPortIdsList}})],2)},a=[],i=(o("8e6e"),o("ac6a"),o("456d"),o("6b54"),o("bd86")),l=o("2f62"),s=o("0069"),n=o("73cb"),d=o("c126"),c=o("bc49"),p=o("6c87");function u(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?u(o,!0).forEach((function(t){Object(i["a"])(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):u(o).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var f={name:"SewageApproval",mixins:[n["c"],n["b"]],components:{DialogForm:p["default"],SelectPort:d["a"],TransferPort:c["a"]},data:function(){return{url:"tpeci/pollutantDischargeApproved",isAuto:!1,loading:!1,floading:!1,ploading:!1,isShow:!0,queryForm:{psName:"",portIds:[],isAll:!0,portName:"",factorCodeList:[],approvedYear:""},select:{factorList:[],portList:[]},itemList:[]}},watch:{queryForm:{handler:function(e){0!==e.portIds.length?this.$set(this.queryForm,"isAll",!1):this.$set(this.queryForm,"isAll",!0)},deep:!0}},computed:m({},Object(l["c"])("auth",["userType","orgGuid"])),created:function(){"ent"===this.userType&&(this.isShow=!1,this.$set(this.queryForm,"psId",this.orgGuid)),this.queryForm.approvedYear=(new Date).getFullYear().toString(),this.onQueryList(),this.getPortList(),this.getFactorList()},methods:{onChangeCheck:function(e){e&&(this.queryForm.portIds=[])},openTransfer:function(){this.$refs.port.openDialog(this.queryForm.portIds)},getPortIdsList:function(e){this.queryForm.portIds=e||[],this.queryForm.isAll=0===e.length,this.onQueryList()},onClickAdd:function(){this.$refs.dialog.openDialog()},onClickEdit:function(e){this.$refs.dialog.openDialog(e)},getFactorList:function(){var e=this;this.select.factorList=[],this.floading=!0,this.$http.get("cfg/pageShowItem",{params:{pageShowMainCode:"TPECI_PollutantDischargeProgress",isEnabled:!0,page:1,rows:1e6,sort:"orderNum-"}}).then((function(t){200===t.status&&t.data.success?e.select.factorList=t.data.data||[]:e.$message.warning({message:t.data.msg,duration:3e3,showClose:!0})}),(function(e){var t=e.response;Object(s["a"])(t)})).finally((function(){e.floading=!1}))},getPortList:function(){var e=this;this.select.portList=[],this.ploading=!0,this.$http.get("bas/portInfo/queryAuthority",{params:{page:1,rows:1e6,childPortType:5,portType:1,sort:"psName+,portName"}}).then((function(t){200===t.status&&t.data.success?e.select.portList=t.data.data||[]:e.$message.warning({message:t.data.msg,duration:3e3,showClose:!0})}),(function(e){var t=e.response;Object(s["a"])(t)})).finally((function(){e.ploading=!1}))},getItemList:function(){var e=this;this.loading=!0,this.selectedIndexs=[];var t=this.pager,o=t.page,r=t.rows;this.$http.post("tpeci/pollutantDischargeApproved/find",this.queryForm,{params:{page:o,rows:r,sort:"approvedTime-,psName+,portName"}}).then((function(t){200===t.status&&t.data.success?(e.itemList=t.data.data,e.pager.count=t.data.count):e.$message.warning({message:t.data.msg,duration:3e3,showClose:!0})}),(function(e){var t=e.response;Object(s["a"])(t)})).finally((function(){e.loading=!1}))}}},h=f,g=o("2877"),b=Object(g["a"])(h,r,a,!1,null,"6e5737c7",null);t["default"]=b.exports},"6c87":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("dialog-modal",{ref:"dialog",attrs:{type:"title",size:"mini",maxScrollbar:"",title:(e.isEdit?"编辑":"新增")+"排污核定"},on:{close:e.closeDialog}},[o("el-form",{ref:"form",staticClass:"mar-t-xs pad-x-sm item-space el-box",attrs:{rules:e.rules,"label-width":"100px",model:e.itemModel}},[o("el-form-item",{attrs:{label:"企业名称：",prop:"psId","hint-down":""}},[o("select-table",{attrs:{label:e.itemModel.psName,disable:e.isEdit},on:{change:e.getPSDate},model:{value:e.itemModel.psId,callback:function(t){e.$set(e.itemModel,"psId",t)},expression:"itemModel.psId"}})],1),o("el-form-item",{attrs:{label:"核定年份：",prop:"approvedYear"}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"year","value-format":"yyyy",format:"yyyy",clearable:!1,editable:!1},on:{change:e.getYearDate},model:{value:e.itemModel.approvedYear,callback:function(t){e.$set(e.itemModel,"approvedYear",t)},expression:"itemModel.approvedYear"}})],1),o("el-form-item",{attrs:{label:"站点名称：",prop:"portId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.fploading,expression:"fploading"}],attrs:{filterable:""},on:{change:e.getPortDate},model:{value:e.itemModel.portId,callback:function(t){e.$set(e.itemModel,"portId",t)},expression:"itemModel.portId"}},e._l(e.select.portList,(function(e,t){return o("el-option",{key:t,attrs:{label:e.portName,value:e.id}})})),1)],1),o("el-form-item",{attrs:{label:"因子名称：",prop:"factorId"}},[o("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.fploading,expression:"fploading"}],staticStyle:{width:"100%"},attrs:{filterable:"",clearable:""},on:{change:e.getFactorDate},model:{value:e.itemModel.factorId,callback:function(t){e.$set(e.itemModel,"factorId",t)},expression:"itemModel.factorId"}},e._l(e.select.factorList,(function(e){return o("el-option",{key:e.factorId,attrs:{label:e.factorName,value:e.factorId}})})),1)],1),o("el-form-item",{attrs:{label:"单位：",prop:"unit"}},[o("el-input",{attrs:{disabled:"",clearable:""},model:{value:e.itemModel.unit,callback:function(t){e.$set(e.itemModel,"unit",t)},expression:"itemModel.unit"}})],1),o("el-form-item",{attrs:{prop:"emissions"}},[o("template",{slot:"label"},[e._v("\n        排放量\n        "),o("span",[o("el-tooltip",{attrs:{effect:"dark",content:"提示：许可排放量："+e.permittedEmissions+" "+e.unit+"\n              | 剩余排放量："+("0.00"===e.notPermittedEmissions.toString()?0:e.notPermittedEmissions)+" "+e.unit,placement:"top"}},[o("i",{staticClass:"el-tooltip el-icon-info"})])],1),o("span",[e._v(" ：")])]),o("el-input",{attrs:{clearable:""},model:{value:e.itemModel.emissions,callback:function(t){e.$set(e.itemModel,"emissions",t)},expression:"itemModel.emissions"}})],2),o("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},model:{value:e.itemModel.remark,callback:function(t){e.$set(e.itemModel,"remark",t)},expression:"itemModel.remark"}})],1)],1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",icon:"fas fa-save",loading:e.saveLoading},on:{click:function(t){return e.onSaveCheck(e.saveCallback)}}},[e._v("保 存\n    ")]),o("el-button",{attrs:{icon:"fas fa-times"},on:{click:function(t){return e.$refs.dialog.closeDialog()}}},[e._v("关 闭\n    ")])],1)],1)},a=[],i=(o("7514"),o("6b54"),o("2ef0")),l=o.n(i),s=o("0069"),n=o("73cb"),d=o("9b4e"),c={mixins:[n["d"]],components:{SelectTable:d["a"]},data:function(){return{saveLoading:!1,url:"tpeci/pollutantDischargeApproved",fploading:!1,once:!0,itemModel:{psName:"",psId:"",portId:"",portName:"",factorId:"",factorName:"",factorCode:"",unit:"",emissions:"",approvedTime:"",approvedYear:"",remark:""},select:{portList:[],factorList:[]},notPermittedEmissions:"",permittedEmissions:"",unit:"",rules:{psId:[{required:!0,message:"请选择企业名称",trigger:["blur","change"]}],portId:[{required:!0,message:"请选择站点",trigger:["blur","change"]}],factorId:[{required:!0,message:"请选择因子",trigger:["blur","change"]}],emissions:[{required:!0,message:"请输入排放量",trigger:["blur","change"]},{pattern:/(^[0-9][0-9]*(.[0-9]+)?)$/,message:"请输入数字,且不能为负数"}],approvedYear:[{required:!0,message:"请输入核定年份",trigger:["blur","change"]}]}}},computed:{isEdit:function(){return this.itemModel.id}},watch:{"itemModel.psId":{handler:function(){""===this.itemModel.approvedYear||""===this.itemModel.psId||this.once||(this.getSelectList(),this.itemModel.portId="",this.itemModel.portName="",this.itemModel.factorId="",this.itemModel.factorName="",this.itemModel.factorCode="",this.itemModel.unit="")},deep:!0},"itemModel.approvedYear":{handler:function(){""===this.itemModel.approvedYear||""===this.itemModel.psId||this.once||(this.getSelectList(),this.itemModel.portId="",this.itemModel.portName="",this.itemModel.factorId="",this.itemModel.factorName="",this.itemModel.factorCode="",this.itemModel.unit="")},deep:!0}},methods:{openDialog:function(e){var t=this;this.itemModel.approvedYear=(new Date).getFullYear().toString(),this.getYearDate();var o=e;e&&(o=l.a.cloneDeep(e),this.itemModel.psName=o.psName||"",this.permittedEmissions=e.permittedEmissions||"",this.notPermittedEmissions=e.notPermittedEmissions||"",this.unit=e.unit||"",this.itemModel=this.setEmptyItem(o),this.getSelectList()),this.$refs.dialog.openDialog(),this.$nextTick((function(){t.once=!1,t.$refs.form.clearValidate()}))},getSelectList:function(){var e=this;this.select.factorList=[],this.select.portList=[],this.fploading=!0,this.$http.get("tpeci/pollutantDischargeApproved/factor",{params:{psId:this.itemModel.psId,approvedYear:this.itemModel.approvedYear}}).then((function(t){if(200===t.status&&t.data.success){var o=t.data.data||{};e.select.factorList=o.factorList||[],e.select.portList=o.portList||[]}else e.$message.warning({message:t.data.msg,duration:3e3,showClose:!0})}),(function(e){var t=e.response;Object(s["a"])(t)})).finally((function(){e.fploading=!1}))},getPSDate:function(e){this.itemModel.psName=e},getFactorDate:function(e){var t={};t=this.select.factorList.find((function(t){return t.factorId===e}))||{},this.itemModel.factorName=t.factorName||"",this.itemModel.factorCode=t.factorCode||"",this.itemModel.unit=t.unit||"",this.notPermittedEmissions=t.notPermittedEmissions||"",this.permittedEmissions=t.permittedEmissions||"",this.unit=t.unit||""},getYearDate:function(){this.itemModel.approvedTime=this.$tools.formatDate(new Date,"Y-m-d H:i:s")},getPortDate:function(e){var t={};t=this.select.portList.find((function(t){return t.id===e})),this.itemModel.portName=t.portName||"",this.itemModel.regionCodeId=t.regionCodeId||"",this.itemModel.regionName=t.regionName||""},onSaveCheck:function(e){var t=this;this.$refs.form.validate((function(o){o&&t.onSaveItem(e)}))},saveCallback:function(){this.once=!0,this.$refs.dialog.closeDialog(),this.$emit("query")},closeDialog:function(){this.once=!0,this.select={portList:[],factorList:[]},this.notPermittedEmissions="",this.permittedEmissions="",this.unit="",this.psName="",this.itemModel=this.getEmptyItem()},getEmptyItem:function(){return{psName:"",psId:"",portId:"",portName:"",factorId:"",factorName:"",factorCode:"",unit:"",emissions:"",approvedTime:"",approvedYear:"",remark:""}},setEmptyItem:function(e){var t=(e.approvedYear||"").toString();return{id:e.id||"",psName:e.psName||"",psId:e.psId||"",portId:e.portId||"",factorId:e.factorId||"",factorName:e.factorName||"",factorCode:e.factorCode||"",unit:e.unit||"",emissions:e.emissions||"",approvedTime:e.approvedTime||"",approvedYear:t,remark:e.remark||""}}}},p=c,u=o("2877"),m=Object(u["a"])(p,r,a,!1,null,null,null);t["default"]=m.exports},"9b4e":function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-tooltip",{attrs:{effect:"dark",placement:"top-start",disabled:e.labelModel.length<9,content:e.labelModel}},[o("el-input",{staticClass:"z-pointer",attrs:{readonly:"",size:e.size},model:{value:e.labelModel,callback:function(t){e.labelModel=t},expression:"labelModel"}},[o("el-button",{attrs:{slot:"append",size:e.size},on:{click:function(t){return e.openDialog()}},slot:"append"},[o("i",{staticClass:"fas fa-th-list"})])],1)],1),o("dialog-modal",{ref:"dialog",attrs:{title:e.title,"append-to-body":"",scrollbar:""},on:{close:e.closeDialog}},[o("el-form",{attrs:{inline:"",model:e.queryForm}},[o("el-form-item",{attrs:{label:"企业名称："}},[o("el-input",{attrs:{clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getItemList()}},model:{value:e.queryForm.psName,callback:function(t){e.$set(e.queryForm,"psName",t)},expression:"queryForm.psName"}})],1),o("el-form-item",{attrs:{label:"行政区域："}},[o("select-tree",{staticStyle:{width:"130px"},attrs:{lazy:"",joint:"",rootKey:"0",url:"sys/area",props:{label:"areaName"}},model:{value:e.queryForm.regionCodeId,callback:function(t){e.$set(e.queryForm,"regionCodeId",t)},expression:"queryForm.regionCodeId"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",icon:"fas fa-search"},on:{click:e.getItemList}},[e._v("查 询")])],1)],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{border:"",height:"calc(70vh - 115px)","highlight-current-row":"",data:e.itemList}},[o("el-table-column",{attrs:{align:"center",label:"No.",width:"50",type:"index",index:e.index}}),o("el-table-column",{attrs:{align:"center",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:function(o){return e.onClickCheck(t.row)}}},[e._v("确认")])]}}])}),o("el-table-column",{attrs:{property:"psName",label:"企业名称","min-width":"180","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{property:"psShortName",label:"企业简称","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{property:"regionName",label:"行政区域","show-overflow-tooltip":""}})],1),o("paging-query",{attrs:{pager:e.pager},on:{query:e.getItemList}})],1)],1)},a=[],i=(o("8e6e"),o("ac6a"),o("456d"),o("bd86")),l=o("2f62"),s=o("0069");function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function d(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(o,!0).forEach((function(t){Object(i["a"])(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(o).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var c={name:"SelectTable",model:{prop:"value",event:"selected"},props:{value:String,label:String,url:{type:String,required:!1,default:"bas/psBaseInfo"},size:{type:String,required:!1,default:"mini"},title:{type:String,required:!1,default:"选择企业"}},data:function(){return{loading:!1,valueModel:"",labelModel:"",queryForm:{psName:"",psType:1,industryTypeCodeId:"",regionCodeId:"",attentionDegree:-1,psBaseInfoType:-1,sort:"psName"},itemList:[],pager:{page:1,rows:15,count:0}}},watch:{label:{handler:function(e){this.labelModel=this.value?e:""},deep:!0,immediate:!0}},computed:d({},Object(l["c"])("auth",["userType","orgGuid"])),created:function(){"ent"===this.userType&&this.$set(this.queryForm,"psId",this.orgGuid)},methods:{index:function(e){return(this.pager.page-1)*this.pager.rows+e+1},openDialog:function(){this.getItemList(),this.$refs.dialog.openDialog()},closeDialog:function(){this.$refs.dialog.closeDialog()},getItemList:function(){var e=this;this.loading=!0;var t=this.pager,o=t.page,r=t.rows;this.$http.get(this.url,{params:d({page:o,rows:r},this.queryForm)}).then((function(t){t.data.success?(e.itemList=t.data.data,e.pager.count=t.data.count):e.$message.warning({message:t.data.msg,duration:3e3,showClose:!0})}),(function(e){var t=e.response;Object(s["a"])(t)})).finally((function(){e.loading=!1}))},onClickCheck:function(e){this.$emit("selected",e.psId),this.labelModel=e.psName,this.$emit("change",e.psName),this.closeDialog()}}},p=c,u=o("2877"),m=Object(u["a"])(p,r,a,!1,null,null,null);t["a"]=m.exports},bc49:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("dialog-modal",{ref:"dialog",attrs:{title:"站点选择","append-to-body":""}},[o("div",{staticClass:"mar-l-sm mar-y-xs"},[o("el-form",{attrs:{inline:"",model:e.queryForm}},[o("el-form-item",{attrs:{label:"所属区域："}},[o("area-select",{attrs:{placeholder:"请选择",label:e.queryForm.regionName},on:{setLabel:e.setLabel},model:{value:e.queryForm.regionCodeId,callback:function(t){e.$set(e.queryForm,"regionCodeId",t)},expression:"queryForm.regionCodeId"}})],1),o("el-form-item",{staticStyle:{float:"right"}},[o("el-button",{attrs:{type:"primary",icon:"fas fa-check"},on:{click:e.onClickCheck}},[e._v("确 定")])],1)],1)],1),o("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{height:"400px"},attrs:{filterable:"",titles:["待选","已选"],data:e.portList,props:{key:"id",label:"portName"}},model:{value:e.queryForm.portIds,callback:function(t){e.$set(e.queryForm,"portIds",t)},expression:"queryForm.portIds"}}),o("div",{staticClass:"pad-b-xs"})],1)},a=[],i=o("75fc"),l=o("0069"),s=o("c90e"),n={name:"TransferPort",components:{AreaSelect:s["a"]},props:{psName:{type:String,default:""}},data:function(){return{loading:!1,queryForm:{regionCodeId:"",regionName:"",portIds:[]},portList:[]}},computed:{},created:function(){},watch:{"queryForm.regionCodeId":function(e,t){this.getPortList()}},methods:{getPortList:function(){var e=this;this.loading=!0,this.$http.get("bas/portInfo/queryAuthority",{params:{page:1,rows:1e5,childPortType:5,portType:1,psName:"",portName:"",sort:"psName+,portName",regionCodeId:this.queryForm.regionCodeId}}).then((function(t){t.data.success?e.portList=t.data.data||[]:e.$message({type:"warning",message:t.data.msg,duration:3e3,showClose:!0})}),(function(e){Object(l["a"])(e)})).finally((function(){e.loading=!1}))},openDialog:function(e){this.$set(this.queryForm,"portIds",e),this.$refs.dialog.openDialog(),this.getPortList()},closeDialog:function(){this.$refs.dialog.closeDialog()},onClickCheck:function(){this.$emit("getQueryData",Object(i["a"])(this.queryForm.portIds)),this.closeDialog()},setLabel:function(e){this.queryForm.regionName=e}}},d=n,c=o("2877"),p=Object(c["a"])(d,r,a,!1,null,"674d4c0c",null);t["a"]=p.exports},c126:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-tooltip",{attrs:{effect:"dark",placement:"top-start",disabled:e.labelModel.length<12,content:e.labelModel}},[o("el-select",{ref:"select",style:{width:e.width},attrs:{"popper-class":"mod-select-tree",value:e.labelModel,filterable:e.filterable,disabled:e.disabled,"filter-method":e.filterMethod,clearable:e.filterable},on:{clear:e.clearHandler,blur:e.blurHandler,"visible-change":e.visibleChange}},[o("el-option",{attrs:{value:e.valueModel,label:e.labelModel}},[o("el-tree",{ref:"tree",style:{minWidth:e.treeWidth},attrs:{"empty-text":"无数据","show-checkbox":"","expand-on-click-node":!1,accordion:e.accordion,data:e.treeOptions,props:e.propsMerge,"highlight-current":e.highlightCurrent,"default-expand-all":e.defaultExpandAll,"node-key":e.propsMerge.value,"filter-node-method":e.filterNode,"render-content":e.renderContent},on:{check:e.onClickNode}})],1)],1)],1)},a=[],i=o("75fc"),l=(o("6762"),o("2fdb"),o("7f7f"),o("ac6a"),o("4f7f"),o("5df3"),o("1c4c"),o("2ef0")),s=o.n(l),n={name:"SelectTierTree",model:{prop:"value",event:"selected"},props:{value:Array,clearable:Boolean,disabled:Boolean,filterable:Boolean,accordion:Boolean,width:{type:String,default:"200px"},treeWidth:{type:String,default:"auto"},defaultExpandAll:{type:Boolean,default:!1},defaultValue:{type:Array,default:function(){return[]}},highlightCurrent:{type:Boolean,default:!1},options:{type:Array,default:function(){return[]}},field:{type:Array,required:!0},props:{type:Object,default:function(){return{label:"label",value:"value",children:"children"}}}},data:function(){return{labelModel:"",valueModel:[],treeOptions:[],once:!0}},computed:{propsMerge:function(){var e=Object.assign({value:"value",label:"label",children:"children",disabled:"disabled"},this.props);return e}},watch:{value:{handler:function(e){var t=this;this.$nextTick((function(){if(t.$refs.tree.setCheckedKeys(e),0===e.length)t.labelModel="";else{var o=t.$refs.tree.getCheckedNodes();t.labelModel=Array.from(new Set(t.getLowestLevelIds(o,t.propsMerge.label))).join()}}))},deep:!0},defaultValue:{handler:function(e){this.initHandler(e)},immediate:!0},options:{handler:function(e){var t=this;this.labelModel="",this.treeOptions=[],0!==e.length&&this.$nextTick((function(){t.treeOptions=t.handleParentData(s.a.cloneDeep(e),0)}))},immediate:!0}},methods:{initHandler:function(e){var t=this;this.$nextTick((function(){var o=t.field,r=e.map((function(e){return e[o[o.length-1].key]})),a=e.map((function(e){return e[o[o.length-1].name]}));t.$refs.tree.setCheckedKeys(r),t.labelModel=a.join()}))},handleParentData:function(e,t){for(var o=this,r=this.field,a=e.map((function(e){return e[r[t].key]})),i=[],l=0;l<e.length;l+=1){var s=i.map((function(e){return e[o.propsMerge.value]}));if(!s.includes(a[l])){var n={};this.$set(n,"".concat(this.propsMerge.label),e[l][r[t].name]),this.$set(n,"".concat(this.propsMerge.value),e[l][r[t].key]),i.push(n)}}return t<this.field.length-1&&i.forEach((function(a){if(o.$set(a,"children",[]),e.forEach((function(e){a[o.propsMerge.value]===e[r[t].key]&&a.children.push(e)})),a.children.length){var i=t+1;o.$set(a,"children",o.handleParentData(a.children,i))}})),i},clearHandler:function(){this.labelModel="",this.$emit("selected",[]),this.$refs.tree.setCheckedKeys([]),this.setTreeNodeExpanded(this.$refs.tree)},filterMethod:function(e){return this.$refs.tree.filter(e),!0},blurHandler:function(){},visibleChange:function(e){e||this.$refs.tree.filter("")},filterNode:function(e,t){return!e||t[this.propsMerge.label].includes(e)},onClickNode:function(){var e=this.$refs.tree.getCheckedNodes();this.$emit("selected",Array.from(new Set(this.getLowestLevelIds(e,this.propsMerge.value)))),this.labelModel=Array.from(new Set(this.getLowestLevelIds(e,this.propsMerge.label))).join()},renderContent:function(e,t){var o=t.node;return e("span",{class:"el-tree-node__label ".concat(o.disabled?"is-disabled":"")},[o.label])},getLowestLevelIds:function(e,t){var o=this,r=[];return e.forEach((function(e){e[o.propsMerge.children]?r.push.apply(r,Object(i["a"])(o.getLowestLevelIds(e[o.propsMerge.children],t))):r.push(e[t])})),r},setTreeNodeExpanded:function(e){var t=this;e.$children.forEach((function(e){e.$children.length&&e.node&&(t.$set(e.node,"expanded",!1),t.setTreeNodeExpanded(e))}))}}},d=n,c=o("2877"),p=Object(c["a"])(d,r,a,!1,null,null,null);t["a"]=p.exports},c90e:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-popover",{ref:"popover",attrs:{placement:"bottom-start",trigger:"click"},on:{show:e.onShowMenu,hide:e.onHideMenu}},[o("el-tree",{ref:"tree",staticClass:"mod-select-tree",style:"min-width: "+e.treeWidth+";max-height:300px;overflow:auto",attrs:{"highlight-current":"",lazy:"",load:e.onLoadNodes,data:e.data,props:e.props,"expand-on-click-node":!1,"filter-node-method":e.filterNode,"default-expand-all":!1},on:{"node-click":e.onClickNode,"node-expand":e.onExtendNode}}),o("template",{slot:"reference"},[o("el-tooltip",{attrs:{effect:"dark",placement:"top-start",disabled:e.labelModel.length<9,content:e.labelModel}},[o("el-input",{ref:"input",class:{rotate:e.showStatus,"z-pointer":1},style:"width: "+e.width+"px",attrs:{clearable:"","suffix-icon":"el-icon-arrow-down",placeholder:e.placeholder||""},on:{"!clear":function(t){return e.onShrinkNode(t)}},model:{value:e.labelModel,callback:function(t){e.labelModel=t},expression:"labelModel"}})],1)],1)],2)},a=[],i=(o("ac6a"),o("c5f6"),{name:"SelectTreeLazy",model:{prop:"value",event:"selected"},props:{value:[Number,String],label:String,width:String,placeholder:String,props:{type:Object,required:!1,default:function(){return{parent:"parentId",value:"rowGuid",label:"areaName",children:"children"}}}},watch:{label:function(e){this.labelModel=e},labelModel:function(e){e||(this.valueModel="",this.$emit("setLabel",e)),this.$refs.tree.filter(e)}},data:function(){return{showStatus:!1,treeWidth:"auto",labelModel:"",valueModel:"",data:[]}},created:function(){var e=this;this.labelModel=this.label||"",this.valueModel=this.value||"",this.$nextTick((function(){e.treeWidth="".concat((e.width||e.$refs.input.$refs.input.clientWidth)-24,"px")}))},methods:{onClickNode:function(e){var t=this;this.labelModel=e[this.props.label],this.valueModel=e[this.props.value],this.$refs.popover.showPopper=!1,this.$nextTick((function(){t.$emit("setLabel",t.labelModel)}))},onShowMenu:function(){this.showStatus=!0,this.$refs.tree.filter(!1)},onHideMenu:function(){this.showStatus=!1,this.$emit("selected",this.valueModel)},onExtendNode:function(e,t,o){this.$set(o,"expanded",!o.expanded)},onShrinkNode:function(){var e=this;this.$emit("selected","");var t=this.$refs.tree;this.showStatus=!1,this.$nextTick((function(){e.$refs.popover.showPopper=!1})),t.$children.forEach((function(t){e.$set(t,"expanded",!1)}))},filterNode:function(e,t){return!e||-1!==t[this.props.label].indexOf(e)},onLoadNodes:function(e,t){this.getNodeList(e.data[this.props.value]).then((function(e){return t(e)}))},getNodeList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0";return new Promise((function(o){e.$http.get("sys/area/".concat(t)).then((function(e){o(e.data||[])}),(function(t){e.$hp.resp(t)}))}))}}}),l=i,s=o("2877"),n=Object(s["a"])(l,r,a,!1,null,null,null);t["a"]=n.exports}}]);