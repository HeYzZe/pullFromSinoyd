(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d229df5"],{defd:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fill-h"},[a("el-form",{staticClass:"mar-t-xs mar-l-sm",attrs:{model:t.queryForm,inline:""}},[a("el-form-item",{attrs:{label:"时间："}},[a("el-date-picker",{staticStyle:{width:"135px"},attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",clearable:!1,editable:!1},model:{value:t.queryForm.fromDate,callback:function(e){t.$set(t.queryForm,"fromDate",e)},expression:"queryForm.fromDate"}}),t._v(" ~\n      "),a("el-date-picker",{staticStyle:{width:"135px"},attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",clearable:!1,editable:!1},model:{value:t.queryForm.toDate,callback:function(e){t.$set(t.queryForm,"toDate",e)},expression:"queryForm.toDate"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"160px"},attrs:{multiple:"","collapse-tags":"",clearable:"",placeholder:"请选择报警类型"},model:{value:t.queryForm.alarmTypeIds,callback:function(e){t.$set(t.queryForm,"alarmTypeIds",e)},expression:"queryForm.alarmTypeIds"}},t._l(t.select.alarmTypeList,(function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.alarmTypeName}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"fas fa-search"},on:{click:t.onQueryList}},[t._v("查 询")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"fas fa-download",loading:t.downloading},on:{click:t.onDownload}},[t._v("导 出")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{border:"","highlight-current-row":"",height:"calc(100% - 70px)",data:t.itemList},on:{"selection-change":t.onChangeSelected}},[a("el-table-column",{attrs:{align:"center",label:"No.","min-width":"50",type:"index",index:t.index}}),a("el-table-column",{attrs:{label:"行政区域",prop:"regionName","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"企业名称",prop:"psName","min-width":"140","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"站点名称",prop:"portName","min-width":"130","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"报警类型",prop:"alarmTypeName","min-width":"90","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"报警时间",prop:"alarmTstamp","min-width":"120","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"报警内容",prop:"alarmContent","min-width":"300","show-overflow-tooltip":""}})],1),a("paging-query",{attrs:{pager:t.pager},on:{query:t.getItemList}})],1)},o=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),l=a("2f62"),i=a("0069"),n=a("4161"),m=a("73cb");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(a,!0).forEach((function(e){Object(s["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={name:"OtherAlarm",mixins:[m["c"]],components:{},data:function(){return{isAuto:!1,url:"alarm/alarmRecord",loading:!1,downloading:!1,alarmTypeIdsList:[],queryForm:{fromDate:Object(n["formatDate"])(new Date((new Date).getTime()-1728e5),"Y-m-d"),toDate:Object(n["formatDate"])(new Date,"Y-m-d"),portIds:[],alarmTypeIds:[],isAll:!1,systemTypeCode:"TpeciSystem",dealStatus:""},select:{portList:[],alarmTypeList:[]},itemList:[]}},computed:p({},Object(l["e"])({portInfo:function(t){return t.portInfo}})),watch:{"portInfo.portId":function(t){this.queryForm.portId=t,this.onQueryList()}},methods:{openDialog:function(){this.queryForm.fromDate=Object(n["formatDate"])(new Date((new Date).getTime()-1728e5),"Y-m-d"),this.queryForm.toDate=Object(n["formatDate"])(new Date,"Y-m-d"),this.queryForm.portIds=[this.portInfo.portId],this.getPortList(),this.getAlarmTypeList()},onChangeCheck:function(t){t&&(this.queryForm.portIds=[])},getPortList:function(){var t=this;this.alarmTypeIdsList=[],this.select.portList=[],this.$http.get("bas/portInfo/queryAuthority",{params:{page:1,rows:1e5,childPortType:5,portType:1,sort:"psName-,portName"}}).then((function(e){200===e.status&&e.data.success&&(t.select.portList=e.data.data||[])}),(function(t){var e=t.response;Object(i["a"])(e)}))},getAlarmTypeList:function(){var t=this;this.select.alarmTypeList=[],this.$http.post("alarm/alarmType/code?page=1&rows=1000000",{alarmTypeCodes:["AlarmCouWarn","AlarmCou","AlarmValveClose"]}).then((function(e){200===e.status&&e.data.success&&(t.select.alarmTypeList=e.data.data,t.alarmTypeIdsList=t.select.alarmTypeList.map((function(t){return t.id})),t.getItemList())}),(function(t){var e=t.response;Object(i["a"])(e)}))},getItemList:function(){var t=this;this.loading=!0,this.selectedIds=[],this.itemList=[];var e=this.pager,a=e.page,r=e.rows,o=this.queryForm;0===this.queryForm.alarmTypeIds.length&&(o=p({},this.queryForm,{alarmTypeIds:this.alarmTypeIdsList})),this.$http.post(this.url,p({},o),{params:{page:a,rows:r,sort:"alarmTstamp-,psId+,portId+,alarmLevel+,factorCode+"}}).then((function(e){200===e.status&&e.data.success?(t.itemList=e.data.data||[],t.pager.count=e.data.count):t.$message.warning({message:e.data.msg,duration:3e3,showClose:!0})}),(function(t){var e=t.response;Object(i["a"])(e)})).finally((function(){t.loading=!1}))},onDownload:function(){var t=this;this.downloading=!0,this.$http.post("alarm/alarmRecord/export",p({},this.queryForm,{isExportAlarmOverProof:!1}),{responseType:"blob"}).then((function(t){var e="报警通知".concat((new Date).toLocaleDateString(),".xls"),a=new Blob([t.data],{type:"application/x-xls"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(a,e);else{var r=document.createElement("a");r.href=window.URL.createObjectURL(a),r.download=e,r.click(),window.URL.revokeObjectURL(r.href)}}),(function(t){var e=t.response;Object(i["a"])(e)})).finally((function(){t.downloading=!1}))}}},u=d,y=a("2877"),f=Object(y["a"])(u,r,o,!1,null,"0170374c",null);e["default"]=f.exports}}]);