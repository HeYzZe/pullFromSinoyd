!function(z,U){"use strict";var V="position",t="absolute",a="relative",Z="px",i="left",B="right",I="top",x="bottom",$="display",E="none",X="block",l=ht.Default,R=l.getInternal(),j=Math.floor,r=Math.ceil,v=Math.PI,D=null,u=z.parseInt,L=function(A){return A.getContext("2d")},A=function(){return document},W=function(G){return A().createElement(G)},T=function(){return W("canvas")},m=function(R,j,F){R.style.setProperty(j,F,D)},c=function(v,T,n){l.def(ht.widget[v],T,n)},p=function(z,F){z.appendChild(F)},S=function(u,s){u.removeChild(s)},N=function(i,Z,k,W){i.addEventListener(Z,k,!!W)},o=function(B,Q,r,Z){B.removeEventListener(Q,r,!!Z)};ht.widget.RulerFrame=function(N){var x=this,o=x._view=R.createView(null,x),k=x.$1k=T(),r=x.$2k=T(),I=x.$3k=T(),u=x.$4k=T();x._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},x._topRulerConfig={visible:!0},x._rightRulerConfig={visible:!1},x._bottomRulerConfig={visible:!1},x._leftRulerConfig={visible:!0},p(o,k),p(o,I),p(o,r),p(o,u),m(o,V,a),m(o,"box-sizing","border-box"),m(o,"-moz-box-sizing","border-box"),m(k,V,t),m(r,V,t),m(I,V,t),m(u,V,t),x.$14k=function(){x.$13k=1,x.iv()},x.$15k=function(l){if(x._topRulerConfig.guideVisible||x._rightRulerConfig.guideVisible||x._bottomRulerConfig.guideVisible||x._leftRulerConfig.guideVisible||x._defaultRulerConfig.guideVisible||(x._topRulerConfig.guideTipVisible||x._rightRulerConfig.guideTipVisible||x._bottomRulerConfig.guideTipVisible||x._leftRulerConfig.guideTipVisible||x._defaultRulerConfig.guideTipVisible)&&x._component){var M=o.getBoundingClientRect();x.$16k={x:l.clientX-M.left,y:l.clientY-M.top},x.$5k()}},x.setComponent(N)},c("RulerFrame",U,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(D){var C=this,z=C._component,f=C.getView();if(f){if(C._component=D,C.fp("component",z,D),z){var L=C.getComponentView(z);S(f,L),o(f,"mousemove",C.$15k),C.removeComponentPropertyChangeListener(z,C.$14k)}if(D){var J=C.getComponentView(D);p(f,J),m(J,V,t),N(f,"mousemove",C.$15k),C.addComponentPropertyChangeListener(D,C.$14k)}}},addComponentPropertyChangeListener:function(B,n){B&&B.mp&&B.mp(n)},removeComponentPropertyChangeListener:function(c,I){c&&c.ump&&c.ump(I)},getComponentHZoom:function(u){return u&&u.getZoom?u.getZoom():1},getComponentVZoom:function(i){return i&&i.getZoom?i.getZoom():1},getComponentViewRect:function(W){return W&&W.getViewRect?W.getViewRect():void 0},getComponentView:function(x){return x&&x.getView?x.getView():x},invalidateComponent:function(J){J&&J.iv&&J.iv()},validateComponent:function(x){x&&x.validate&&x.validate()},$7k:function(B,Q,d,v,V,c,g,t,k,S,W,l){if(Q.visible){var u=this._defaultRulerConfig,Z="borderStyle",K="borderColor",T="borderWidth",r="background",Y=Q[Z]||u[Z],i=Q[K]||u[K],n=Q[T]||u[T],s=Q.size!=D?Q.size:u.size,p=Q[r]||u[r],G=s+n,O=this.$6k(n,Y,i,B,d,V,G,g,t,k,S,W,l);m(B,V,"0px"),c?R.setCanvas(B,v-O,s):R.setCanvas(B,s,v-O),m(B,"background",p),m(B,$,X)}else m(B,$,E),m(this.getComponentView(this._component),V,"0px")},$6k:function(N,A,$,I,U,d,n,M,G,b,r,h,Q){var y=0;return m(I,U,N+"px "+A+" "+$),m(this.getComponentView(this._component),d,n+Z),M?(m(I,G,b+Z),y+=b):m(I,G,"0px"),r?(m(I,h,Q+Z),y+=Q):m(I,h,"0px"),y},validateImpl:function(){var j=this,a=j._component,k=j.$1k,m=j.$2k,d=j.$3k,v=j.$4k,g=j._view,G=j._defaultRulerConfig,w=j._topRulerConfig,E=j._rightRulerConfig,R=j._bottomRulerConfig,n=j._leftRulerConfig,t=G.size;if(g&&a){var c=w.size!=D?w.size:t,P=E.size!=D?E.size:t,y=R.size!=D?R.size:t,h=n.size!=D?n.size:t;j.$7k(k,w,"border-bottom",g.offsetWidth,I,!0,n.visible,i,h,E.visible,B,P),j.$7k(m,E,"border-left",g.offsetHeight,B,!1,w.visible,I,c,R.visible,x,y),j.$7k(d,R,"border-top",g.offsetWidth,x,!0,n.visible,i,h,E.visible,B,P),j.$7k(v,n,"border-right",g.offsetHeight,i,!1,w.visible,I,c,R.visible,x,y),j.$13k?delete j.$13k:j.invalidateComponent(a),j.validateComponent(a),j.$5k()}},$5k:function(){function a(m,K,q,a,Z,f){if(K.visible){var F=L(m),i=K[C]||V,B=K[O]!=D?K[O]:T,j=K[n]||k,P=K[X]||c,o=K.size!=D?K.size:_,Ed=K[S]||e,zn=K[J]||W,be=K[A]||H,_d=K[h]!=D?K[h]:x,zr=K[G]!=D?K[G]:t,Iq=K[w]!=D?K[w]:N,Vc=K[p]!=D?K[p]:g,bm=K[$]!=D?K[$]:b,il=K[E]!=D?K[E]:l,Tr=K[I]||Gb,Sd=K[y]||Wl;B&&(i=s[f]=s.$8k(s[f]||i,K[Q]||U,K[r]||z,a?v:u,zn)),q.call(s,F,M,d,R,Y,o,a?v:u,i,j,P,Z,Ed,be);var Kg=s.$16k;(_d||zr)&&Kg&&(a?s.$9k(F,Kg.x,o,Tr,Sd,_d,zr,Iq,Vc,bm,il):s.$10k(F,Kg.y,o,Tr,Sd,_d,zr,Iq,Vc,bm,il,Z))}}var s=this,K=s.$1k,i=s.$2k,o=s.$3k,P=s.$4k,q=s._topRulerConfig,f=s._rightRulerConfig,m=s._bottomRulerConfig,B=s._leftRulerConfig,Z=s._defaultRulerConfig,F=s._component,j=s.getComponentViewRect(F),v=s.getComponentHZoom(F),u=s.getComponentVZoom(F),M=j.x*v,R=M+j.width*v,d=j.y*u,Y=d+j.height*u,_=s._defaultRulerConfig.size,C="defaultMajorTickSpacing",Q="maxPhysicalMajorTickSpacing",r="minPhysicalMajorTickSpacing",O="tickSpacingAdaptable",n="majorTickTextFont",X="majorTickTextColor",S="majorTickColor",A="minorTickColor",h="guideVisible",G="guideTipVisible",w="guideTipBorderColor",p="guideTipTextColor",$="guideTipTextFont",E="guideTipBackground",I="guideColor",y="guideWidth",J="minMajorTickSpacing",V=Z[C],U=Z[Q],z=Z[r],T=Z[O],k=Z[n],c=Z[X],e=Z[S],W=Z[J],H=Z[A],x=Z[h],t=Z[G],N=Z[w],g=Z[p],b=Z[$],l=Z[E],Gb=Z[I],Wl=Z[y];s._view&&F&&(a(K,q,s.$11k,!0,!1,"_currentTopMajorTickSpacing"),a(i,f,s.$12k,!1,!0,"_currentRightMajorTickSpacing"),a(o,m,s.$11k,!0,!0,"_currentBottomMajorTickSpacing"),a(P,B,s.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(G,M,T,v,o){return T>G*v?G=j(M/v/o)*o:G*v>M&&(G=r(T/v/o)*o),G},getHTipText:function(D){var L=this,e=L._component,Q=0,G=L._view.getBoundingClientRect();return e.lp?Q=u(e.lp({x:D.x+G.left,y:D.y}).x):Q-=u(this.getComponentView(e).style.left)||0,Q},$9k:function(I,G,J,r,S,p,P,s,$,N,v){var i=this,k=i._component;I.save(),R.translateAndScale(I,0,0,1);var M=G-(u(this.getComponentView(k).style.left)||0),B=0;if(G=i.getHTipText(i.$16k),p&&(I.beginPath(),I.fillStyle=r,I.rect(M,B,S,J),I.fill()),P){I.beginPath(),I.textAlign="center",I.textBaseline="middle",I.font=N;var Z=I.measureText(G).width+6;I.fillStyle=v,I.rect(M-Z/2,B,Z,J),I.fill(),I.strokeStyle=s,I.stroke(),I.beginPath(),I.fillStyle=$,I.fillText(G,M,B+J/2)}I.restore()},getVTipText:function(b){var N=this,O=N._component,I=0,q=N._view.getBoundingClientRect();return O.lp?I=u(O.lp({x:b.x,y:b.y+q.top}).y):I-=u(this.getComponentView(O).style.top)||0,I},formatScaleText:function(g){return Math.round(g)},$10k:function(_,e,s,j,L,J,t,i,Q,k,x,m){var r=this,D=r._component;_.save(),R.translateAndScale(_,0,0,1);var H=s/2,l=e-(u(this.getComponentView(D).style.top)||0);if(e=r.getVTipText(r.$16k),J&&(_.beginPath(),_.fillStyle=j,_.rect(H-s/2,l,s,L),_.fill()),t){_.translate(H,l),_.rotate((m?90:-90)*v/180),_.translate(-H,-l),_.beginPath(),_.textAlign="center",_.textBaseline="middle",_.font=k;var T=_.measureText(e).width+6;_.fillStyle=x,_.rect(H-T/2,l-s/2,T,s),_.fill(),_.strokeStyle=i,_.stroke(),_.fillStyle=Q,_.fillText(e,H,l)}_.restore()},$11k:function(m,V,t,U,$,T,G,l,z,H,N,c,i){m.save(),t=0;var p=V,g=U,O=(p+g)/2;V=0,U=g-p,R.translateAndScale(m,0,0,1);var I=0,o=0,L=u(T/2),C=T-L,b=N?0:L,Q=l*G,h=Q/10;V-=Q,U+=Q,m.clearRect(V,0,U-V,T),m.beginPath(),m.fillStyle=i;var v=j(O/h)*h-p;for(I=v;U>I;I+=h)m.rect(I,t+b,1,C);for(I=v;I>V;I-=h)m.rect(I,t+b,1,C);for(m.fill(),b=N?0:1,m.beginPath(),m.fillStyle=c,v=j(O/Q)*Q-p,I=v;U>I;I+=Q)m.rect(I,t+b,1,T-1);for(I=v;I>V;I-=Q)m.rect(I,t+b,1,T-1);m.fill();var w=u(/\d+px/.exec(z)[0]),s=(w||10)/2;m.textBaseline="middle",b=N?T-s-2:s+2,m.beginPath(),m.fillStyle=H,m.font=z;var x=j(O/Q)*Q/G;for(I=v,o=x;U>I;I+=Q,o+=l){var E=this.getHScaleText?this.getHScaleText(I):o;m.fillText(this.formatScaleText(E),I+2,t+b)}for(I=v,o=x;I>V;I-=Q,o-=l){var E=this.getHScaleText?this.getHScaleText(I):o;m.fillText(this.formatScaleText(E),I+2,t+b)}m.restore()},$12k:function(t,w,Y,B,d,y,r,q,F,c,C,T,S){function G(u,i,e,r,w,U){w=L.getVScaleText?L.getVScaleText(e):w,w=L.formatScaleText(w),t.translate(u+i,e),t.rotate(-r),t.translate(-u-i,-e),t.fillText(w,u+i+(U?2:1),e),t.translate(u+i,e),t.rotate(r),t.translate(-u-i,-e)}t.save(),w=0;var A=Y,J=d,p=(A+J)/2;Y=0,d=J-A,R.translateAndScale(t,0,0,1);var I=0,L=this,n=0,P=u(y/2),z=y-P,V=C?0:P,Z=q*r,U=Z/10;Y-=Z,d+=Z,t.clearRect(w,0,y,d-Y),t.beginPath(),t.fillStyle=S;var M=j(p/U)*U-A;for(I=M;d>I;I+=U)t.rect(w+V,I,z,1);for(I=M;I>Y;I-=U)t.rect(w+V,I,z,1);for(t.fill(),V=C?0:1,t.beginPath(),t.fillStyle=T,M=j(p/Z)*Z-A,I=M;d>I;I+=Z)t.rect(w+V,I,y-1,1);for(I=M;I>Y;I-=Z)t.rect(w+V,I,y-1,1);t.fill();var h=u(/\d+px/.exec(F)[0]),k=(h||10)/2,N=90*v/180;t.textBaseline="middle",V=C?y-k:k+2,N=C?-N:N,t.beginPath(),t.fillStyle=c,t.font=F;var i=j(p/Z)*Z/r;for(I=M,n=i;d>I;I+=Z,n+=q)G(w,V,I,N,n,C);for(I=M,n=i;I>Y;I-=Z,n-=q)G(w,V,I,N,n,C);t.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var x=this,m=x._component,w=x._view;m&&x.removeComponentPropertyChangeListener(m,x.$14k),w&&(o(w,"mousemove",x.$15k),S(w.parentNode,w),x._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);