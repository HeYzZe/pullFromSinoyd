!function(q){"use strict";var w="ht",n=q[w],G=function(){return document},W=function(){return G().body},H=function(k,S,l){k.style.setProperty(S,l,null)},t=function(R){return G().createElement(R)},a=function(){return t("div")},m=function(){var c=t("canvas");return c},Q=function(C,e){H(C,"-webkit-transform",e),H(C,"-ms-transform",e),H(C,"transform",e)},E=function(M,O){H(M,"-webkit-transform-origin",O),H(M,"-ms-transform-origin",O),H(M,"transform-origin",O)},j=function(J,H){J.appendChild(H)},S=function(T,n){T.removeChild(n)},X=q.parseInt,B=n.Default,K=B.getInternal(),v=Math.PI,M="white-space",P="visibility",F="left",e="top",f="width",Y="height",A="position",z="display",_="z-index",l="px",c="0 0",s="absolute",O="visible",d="hidden",V="none",h="block",u="nowrap",i="rgba(0, 0, 0, 0.005)";B.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var r=n.graph.GraphView.prototype,o=r._42;r.adjustHtmlNodeIndex=!0,r._42=function(l,p){if(o.call(this,l,p),this.adjustHtmlNodeIndex)for(var T=this.getDataModel()._datas._as,n=T.length,z=1,W=0;n>W;W++){var b=T[W];if(b instanceof Z){var F=this.getDataUI(b);H(F.$2f,_,z+""),H(F.$3f,_,z+1+""),z+=2}}};var L=n.HtmlNodeUI=function(r,K){var T=this;L.superClass.constructor.call(T,r,K);var l=T.$2f=a(),b=T.$3f=m();H(l,A,s),H(l,P,d),H(l,M,u),b.draggable=!1,H(b,A,s),H(b,z,V),E(b,c),l.addEventListener("change",function(J){var I=J.target,m=I.bind||I.getAttribute("bind"),D=I.type&&"checkbox"===I.type?I.checked:I.value,z=K.getContext();m&&z&&(z[m]=D,T.$4f=JSON.stringify(z))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(C){l.addEventListener(C,this.$9f.bind(this))},T)};B.def(L,K.ui().NodeUI,{_visible:!0,$11f:function(){var d=this,c=d.$3f,N=d._data,m=N.getDraggerImageWidth(),t=N.getDraggerImageHeight(),X=N.getDraggerImage(),S=K.initContext(c);S.beginPath(),K.setCanvas(c,m,t),K.translateAndScale(S,0,0,1),S.clearRect(0,0,m,t),B.drawImage(S,B.getImage(X),0,0,m,t),S.restore()},_80o:function(U){L.superClass._80o.call(this,U);var R=this,c=R._data,x=c._padding,B=2*x,E=R.$2f,p=R.$3f,K=R.gv,D=K.getZoom(),N=K.getTranslateX(),m=K.getTranslateY(),b=K.getView(),I=R._83o,$=c._width,W=c._height,G=I.position,M=I.rotation,q=($-B)/c.$5f*D,g=(W-B)/c.$6f*D,C=R._html,u=c._html,Z=c.getHtmlType();if("html"===Z){var o=c.getContext()||{},t=R.$4f,w=c.$10f,k=JSON.stringify(o);C&&t&&C===u&&t===k||(R.$4f=k,R._html=u,E.innerHTML=w?w(o):u)}else if(null!=Z){var J=c.getHtml();"ht"===Z&&(J=J.getView()),C&&C===J&&E.contains(C)||(R._html=J,E.innerHTML="",j(E,J))}if(!E.parentNode){var y=K.$1f;if(!y){var T=a();H(T,A,s),H(T,_,"0"),y=K.$1f=T;var S=K._canvas.nextSibling;S?b.insertBefore(T,S):j(b,T)}j(y,E),j(y,p),c.onContentInitialized&&c.onContentInitialized(E)}if(c._scalable){var n=c.$5f,r=c.$6f;Q(E,"rotate("+180*(M/v)+"deg) scale("+q+","+g+")"),H(E,f,""),H(E,Y,""),H(E,F,(G.x-n/D/2)*D+N+l),H(E,e,(G.y-r/D/2)*D+m+l)}else{var Of=X(E.style.width),Vq=X(E.style.height),Mn=X(($-B)*D),qq=X((W-B)*D),Wd="100%",wg=E.children[0];H(wg,f,Wd),H(wg,Y,Wd),(Of!==Mn||Vq!==qq)&&(H(E,f,Mn+l),H(E,Y,qq+l),"ht"===Z&&u.invalidate()),Q(E,"rotate("+180*(M/v)+"deg)"),H(E,F,(G.x-Mn/D/2)*D+N+l),H(E,e,(G.y-qq/D/2)*D+m+l)}var Vo=R.dragRect;K.isMovable(c)&&K.isSelected(c)&&Vo?(U.save(),U.fillStyle=i,U.fillRect(Vo.x,Vo.y,Vo.width,Vo.height),U.restore(),H(p,F,Vo.x*D+N+l),H(p,e,Vo.y*D+m+l),Q(p,"scale("+D+","+D+")"),H(p,z,h),R.$11f()):H(p,z,V),H(E,P,this._visible?O:d)},dispose:function(){var o=this.gv.$1f;this.$2f.parentNode===o&&o.removeChild(this.$2f),this.$3f.parentNode===o&&o.removeChild(this.$3f)},_84o:function(Y){this._visible=Y,H(this.$2f,P,Y?O:d),H(this.$3f,z,Y?h:V)},_3O:function(){var g=this,$=g.gv,j=g._data;L.superClass._3O.call(g);var P=j.getRect();$.isEditable(j)&&(g.dragRect={x:P.x+P.width+j._padding,y:P.y+10,width:j.getDraggerImageWidth(),height:j.getDraggerImageHeight()},g._68o(g.dragRect))},rectIntersects:function(Q){var b=this._79o();return n.Default.intersection(b,Q)?!0:void 0},$9f:function(R){var g=this.gv,q=this._data;g.sm().contains(q)&&R.stopPropagation()}});var Z=n.HtmlNode=function(){Z.superClass.constructor.call(this)};n.Default.def(Z,n.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:n.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(l){var H=this,f=H._html;H._html=l,"html"===H.getHtmlType()&&"Handlebars"in q&&(H.$10f=Handlebars.compile(l)),H.$13f(),H.fp("html",f,l)},setContext:function(j){var R=this,P=R._context;R._context=j,R.fp("context",P,j),R.$13f()},setScalable:function(q){var R=this,Y=R._scalable;R._scalable=q,R.fp("scalable",Y,q),R.$13f()},getHtmlType:function(){var I=this._html;return I?"string"==typeof I?"html":I.getView?"ht":"dom":null},$13f:function(){var J=this,c=J._html,x=J.$10f;if(c){var Q=a(),O=!1,N=J.getHtmlType();if(H(Q,A,s),H(Q,M,u),H(Q,P,d),"html"===N?(Q.innerHTML=x?x(J.getContext()||{}):c,O=!0):"ht"===N?(j(Q,c.getView()),O=!0):"dom"===N&&(j(Q,c),O=!0),O){var z=2*J._padding;j(W(),Q),J.$5f=Q.scrollWidth,J.$6f=Q.scrollHeight,J._width=J.$5f+z,J._height=J.$6f+z,J._originWidth=J._width,J._originHeight=J._height,S(W(),Q)}}},getUIClass:function(){return n.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);